2024-04-02T04:02:15Z INFO 5592 [root]: /home/ubuntu/.local/bin/neuronx-cc compile --target=trn1 --framework=XLA /tmp/ubuntu/neuroncc_compile_workdir/f9b0b984-e4bd-475e-84b5-ae95c598f614/model.MODULE_9778643193538079854+f6442c0c.hlo_module.pb --output /tmp/ubuntu/neuroncc_compile_workdir/f9b0b984-e4bd-475e-84b5-ae95c598f614/model.MODULE_9778643193538079854+f6442c0c.neff --model-type=transformer -O2 --distribution-strategy=llm-training --verbose=35
2024-04-02T04:02:15Z INFO 5607 [root]: XLA detected
2024-04-02T04:02:15Z INFO 5607 [root]: Pipeline: Frontend HHChecker WalrusDriver BIRLinker Kelper
2024-04-02T04:02:15Z INFO 5607 [root]: Intermediate files stored in /home/ubuntu/my_kaggle_docker/scripts/neuronxcc-6oyq5_mb, output in /home/ubuntu/my_kaggle_docker/scripts
2024-04-02T04:02:15Z INFO 5607 [pipeline.Pipeline.0]: Job Pipeline len(in_states) 1
2024-04-02T04:02:15Z INFO 5607 [pipeline.Pipeline.0]: Processing input #0
2024-04-02T04:02:15Z INFO 5607 [pipeline.Pipeline.0]: Running pipeline Pipeline.0
2024-04-02T04:02:15Z INFO 5607 [pipeline.Pipeline.0]: Starting job job.Frontend.0
2024-04-02T04:02:15Z INFO 5607 [job.Frontend.0]: Job Frontend len(in_states) 1
2024-04-02T04:02:15Z INFO 5607 [job.Frontend.0]: Processing input #0
2024-04-02T04:02:15Z INFO 5607 [job.Frontend.0]: Start model loading
2024-04-02T04:02:15Z INFO 5607 [job.Frontend.0]: IR signature: da3e9551d6f067256793b6fd360fcb64456845053c7e9843b6c4ec1411d5fe81 for model.MODULE_9778643193538079854+f6442c0c.hlo_module.pb
2024-04-02T04:02:15Z INFO 5607 [job.Frontend.0]: Executing: /home/ubuntu/.local/lib/python3.10/site-packages/neuronxcc/starfish/bin/hlo2penguin --input /tmp/ubuntu/neuroncc_compile_workdir/f9b0b984-e4bd-475e-84b5-ae95c598f614/model.MODULE_9778643193538079854+f6442c0c.hlo_module.pb --out-dir ./ --output penguin.py --remat --max-costly-ops=2 --max-live-in-size=5 --max-remat-chain-size=10 --max-mem-multiple=1.8 --min-def-use-distance=500 --remat-policy=transformer --allow-same-pass-remat=true --split-abc --layers-per-module=1 --partition --coalesce-all-gathers=false --coalesce-reduce-scatters=false --coalesce-all-reduces=false --emit-tensor-level-dropout-ops --emit-tensor-level-rng-ops --native-to-custom-softmax --partitioner-opts='--transformer' --disable-early-opt-barrier-removal
2024-04-02T04:28:59Z INFO 5607 [job.Frontend.0]: DEBUG: needsModular_PreSplit? Yes. macCnt 13965125468160 threshold 4398046511104
INFO: Found compute bound graph
INFO: Early opt-barrier-removal disabled

Pre-Partition Pre-Opt Histogram:
total HLO instructions: 224244
           broadcast     39384  17.56% ################################################################
             reshape     30602  13.65% #################################################
            constant     29868  13.32% ################################################
                 add     19256   8.59% ###############################
           transpose     17024   7.59% ###########################
         custom-call     14432   6.44% #######################
            multiply     13336   5.95% #####################
                 dot     13104   5.84% #####################
             convert      7600   3.39% ############
              select      6337   2.83% ##########
              reduce      5849   2.61% #########
   get-tuple-element      4768   2.13% #######
              divide      3377   1.51% #####
            subtract      2664   1.19% ####
             compare      2465   1.10% ####
                iota      2368   1.06% ###
         concatenate      2337   1.04% ###
 shift-right-logical      1568   0.70% ##
   rng-bit-generator      1568   0.70% ##
                sqrt      1393   0.62% ##
     batch-norm-grad       800   0.36% #
 batch-norm-training       800   0.36% #
             scatter       784   0.35% #
               clamp       768   0.34% #
           parameter       463   0.21% 
              negate       416   0.19% 
         exponential       416   0.19% 
                 not       384   0.17% 
                 log        32   0.01% 
                ceil        16   0.01% 
                 abs        16   0.01% 
                sign        16   0.01% 
              gather        16   0.01% 
                 and        16   0.01% 
               tuple         1   0.00% 

INFO: IoStatistics: total inputs: 463
INFO: IoStatistics: total outputs: 991
INFO: IoStatistics: total passthrough tensors: 101
INFO: IoStatistics: total outputs read from: 692
INFO: IoStatistics: total redundant outputs: 0
INFO: IoStatistics: total ifmap size (KiB): 848008
INFO: IoStatistics: total ofmap size (KiB): 2247926
INFO: IoStatistics: total must-alias size (KiB): 847738
INFO: IoStatistics: total may-alias size (KiB): 0
INFO: HloMacCount has found 13965125468160
INFO: Traffic has found 2302252414
INFO: AIF 12131.71

Pre-Partition Post-Op Histogram:
total HLO instructions: 224244
           broadcast     39384  17.56% ################################################################
             reshape     30602  13.65% #################################################
            constant     29868  13.32% ################################################
                 add     19256   8.59% ###############################
           transpose     17024   7.59% ###########################
         custom-call     14432   6.44% #######################
            multiply     13336   5.95% #####################
                 dot     13104   5.84% #####################
             convert      7600   3.39% ############
              select      6337   2.83% ##########
              reduce      5849   2.61% #########
   get-tuple-element      4768   2.13% #######
              divide      3377   1.51% #####
            subtract      2664   1.19% ####
             compare      2465   1.10% ####
                iota      2368   1.06% ###
         concatenate      2337   1.04% ###
 shift-right-logical      1568   0.70% ##
   rng-bit-generator      1568   0.70% ##
                sqrt      1393   0.62% ##
     batch-norm-grad       800   0.36% #
 batch-norm-training       800   0.36% #
             scatter       784   0.35% #
               clamp       768   0.34% #
           parameter       463   0.21% 
              negate       416   0.19% 
         exponential       416   0.19% 
                 not       384   0.17% 
                 log        32   0.01% 
                ceil        16   0.01% 
                 abs        16   0.01% 
                sign        16   0.01% 
              gather        16   0.01% 
                 and        16   0.01% 
               tuple         1   0.00% 

DEBUG: needsModular_PreSplit? Yes. macCnt 13965125468160 threshold 4398046511104
DEBUG: transformer model
INFO: Partitioner configs:ModularFlow GT BO LBL SA MaxDisj:2 MaxSep:4 LPM:1
Potential split-points stats: #CC 0 #AR 0 #AG 0 #BN 1600 nClamp 768
DEBUG: needsModular_SplitFinder? Yes.
DEBUG: Added 101 unvisited insts to last part
Num of unique Module Definitions: 136
DefMap:  0 1 2 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 50 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 98 99 1 101 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 149 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 197 198 1 200 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 248 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 296 297 1 299 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 347 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 395 396 1 398 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 446 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 494 495 1 497 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 545 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 593 594 1 596 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 644 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 692 693 1 695 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 743 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 791 792 1 794 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 842 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 890 891 1 893 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 941 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 989 792 1 794 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 842 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 890 1089 1 1091 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1139 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1187 1188 1 1190 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1238 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1286 1287 1 1289 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1337 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1385 1386 1 1388 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1436 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1484 1485 1 1487 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1535 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1583 1584 1585 1586 1587 1588 1589 1590 1591 1592 1593 1592 1595 1596 1597 1598 1599
New disjoint wave: start 1536 len 46 NumReps: 23
New disjoint wave: start 1488 len 46 NumReps: 23
New disjoint wave: start 1437 len 46 NumReps: 23
New disjoint wave: start 1389 len 46 NumReps: 23
New disjoint wave: start 1338 len 46 NumReps: 23
New disjoint wave: start 1290 len 46 NumReps: 23
New disjoint wave: start 1239 len 46 NumReps: 23
New disjoint wave: start 1191 len 46 NumReps: 23
New disjoint wave: start 1140 len 46 NumReps: 23
New disjoint wave: start 1092 len 46 NumReps: 23
New disjoint wave: start 1041 len 46 NumReps: 23
New disjoint wave: start 993 len 46 NumReps: 23
New disjoint wave: start 942 len 46 NumReps: 23
New disjoint wave: start 894 len 46 NumReps: 23
New disjoint wave: start 843 len 46 NumReps: 23
New disjoint wave: start 795 len 46 NumReps: 23
New disjoint wave: start 744 len 46 NumReps: 23
New disjoint wave: start 696 len 46 NumReps: 23
New disjoint wave: start 645 len 46 NumReps: 23
New disjoint wave: start 597 len 46 NumReps: 23
New disjoint wave: start 546 len 46 NumReps: 23
New disjoint wave: start 498 len 46 NumReps: 23
New disjoint wave: start 447 len 46 NumReps: 23
New disjoint wave: start 399 len 46 NumReps: 23
New disjoint wave: start 348 len 46 NumReps: 23
New disjoint wave: start 300 len 46 NumReps: 23
New disjoint wave: start 249 len 46 NumReps: 23
New disjoint wave: start 201 len 46 NumReps: 23
New disjoint wave: start 150 len 46 NumReps: 23
New disjoint wave: start 102 len 46 NumReps: 23
New disjoint wave: start 51 len 46 NumReps: 23
New disjoint wave: start 3 len 46 NumReps: 23
INFO: Number of splitPoints: 49
DEBUG: Added 101 unvisited insts to last part
INFO: Total num elems for IntermediateOutput 2196379942
DefMap:  0 1 1 1 1 1 6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 24 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 42 43 43 43 43 43 48
Wrote HLO netlist to hlo_netlist.json
Processing partition 0
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 7558660096
INFO: Traffic has found 387572474
INFO: AIF 39.01
HLO Ops used in computation: abs add and batch-norm-training broadcast ceil clamp compare concatenate constant convert custom-call divide dot exponential gather get-tuple-element iota log multiply negate not parameter reduce reshape select sign subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 1
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15209070592
INFO: Traffic has found 146306252
INFO: AIF 207.91
HLO Ops used in computation: add batch-norm-training broadcast clamp compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota multiply negate not parameter reduce reshape select subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 2
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15209070592
INFO: Traffic has found 151090380
INFO: AIF 201.32
HLO Ops used in computation: add batch-norm-training broadcast clamp compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota multiply negate not parameter reduce reshape select subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 3
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15209070592
INFO: Traffic has found 164164812
INFO: AIF 185.29
HLO Ops used in computation: add batch-norm-training broadcast clamp compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota multiply negate not parameter reduce reshape select subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 4
Replaced 2 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 7674691584
INFO: Traffic has found 45830338
INFO: AIF 334.92
HLO Ops used in computation: add batch-norm-grad batch-norm-training broadcast compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota log multiply negate parameter reduce reshape select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 5
Replaced 0 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15838740480
INFO: Traffic has found 196775052
INFO: AIF 160.98
HLO Ops used in computation: add batch-norm-grad broadcast concatenate constant custom-call divide dot get-tuple-element iota multiply parameter reduce reshape scatter select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 6
Replaced 0 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15838740480
INFO: Traffic has found 194907276
INFO: AIF 162.53
HLO Ops used in computation: add batch-norm-grad broadcast concatenate constant custom-call divide dot get-tuple-element iota multiply parameter reduce reshape scatter select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 7
Replaced 0 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15838740480
INFO: Traffic has found 159419532
INFO: AIF 198.71
HLO Ops used in computation: add batch-norm-grad broadcast concatenate constant custom-call divide dot get-tuple-element iota multiply parameter reduce reshape scatter select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 8
Replaced 1470 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 13235792461824
INFO: Traffic has found 4193046594
INFO: AIF 6313.21
HLO Ops used in computation: abs add and batch-norm-grad batch-norm-training broadcast ceil clamp compare concatenate constant convert custom-call divide dot exponential gather get-tuple-element iota log multiply negate not parameter reduce reshape scatter select sign sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 360

2024-04-02T04:28:59Z ERROR 5607 [neuronxcc.driver.CommandDriver]: ERROR: Failed command  /home/ubuntu/.local/lib/python3.10/site-packages/neuronxcc/starfish/bin/hlo2penguin --input /tmp/ubuntu/neuroncc_compile_workdir/f9b0b984-e4bd-475e-84b5-ae95c598f614/model.MODULE_9778643193538079854+f6442c0c.hlo_module.pb --out-dir ./ --output penguin.py --remat --max-costly-ops=2 --max-live-in-size=5 --max-remat-chain-size=10 --max-mem-multiple=1.8 --min-def-use-distance=500 --remat-policy=transformer --allow-same-pass-remat=true --split-abc --layers-per-module=1 --partition --coalesce-all-gathers=false --coalesce-reduce-scatters=false --coalesce-all-reduces=false --emit-tensor-level-dropout-ops --emit-tensor-level-rng-ops --native-to-custom-softmax --partitioner-opts='--transformer' --disable-early-opt-barrier-removal
------------ 
Reported stdout: 
DEBUG: needsModular_PreSplit? Yes. macCnt 13965125468160 threshold 4398046511104
INFO: Found compute bound graph
INFO: Early opt-barrier-removal disabled

Pre-Partition Pre-Opt Histogram:
total HLO instructions: 224244
           broadcast     39384  17.56% ################################################################
             reshape     30602  13.65% #################################################
            constant     29868  13.32% ################################################
                 add     19256   8.59% ###############################
           transpose     17024   7.59% ###########################
         custom-call     14432   6.44% #######################
            multiply     13336   5.95% #####################
                 dot     13104   5.84% #####################
             convert      7600   3.39% ############
              select      6337   2.83% ##########
              reduce      5849   2.61% #########
   get-tuple-element      4768   2.13% #######
              divide      3377   1.51% #####
            subtract      2664   1.19% ####
             compare      2465   1.10% ####
                iota      2368   1.06% ###
         concatenate      2337   1.04% ###
 shift-right-logical      1568   0.70% ##
   rng-bit-generator      1568   0.70% ##
                sqrt      1393   0.62% ##
     batch-norm-grad       800   0.36% #
 batch-norm-training       800   0.36% #
             scatter       784   0.35% #
               clamp       768   0.34% #
           parameter       463   0.21% 
              negate       416   0.19% 
         exponential       416   0.19% 
                 not       384   0.17% 
                 log        32   0.01% 
                ceil        16   0.01% 
                 abs        16   0.01% 
                sign        16   0.01% 
              gather        16   0.01% 
                 and        16   0.01% 
               tuple         1   0.00% 

INFO: IoStatistics: total inputs: 463
INFO: IoStatistics: total outputs: 991
INFO: IoStatistics: total passthrough tensors: 101
INFO: IoStatistics: total outputs read from: 692
INFO: IoStatistics: total redundant outputs: 0
INFO: IoStatistics: total ifmap size (KiB): 848008
INFO: IoStatistics: total ofmap size (KiB): 2247926
INFO: IoStatistics: total must-alias size (KiB): 847738
INFO: IoStatistics: total may-alias size (KiB): 0
INFO: HloMacCount has found 13965125468160
INFO: Traffic has found 2302252414
INFO: AIF 12131.71

Pre-Partition Post-Op Histogram:
total HLO instructions: 224244
           broadcast     39384  17.56% ################################################################
             reshape     30602  13.65% #################################################
            constant     29868  13.32% ################################################
                 add     19256   8.59% ###############################
           transpose     17024   7.59% ###########################
         custom-call     14432   6.44% #######################
            multiply     13336   5.95% #####################
                 dot     13104   5.84% #####################
             convert      7600   3.39% ############
              select      6337   2.83% ##########
              reduce      5849   2.61% #########
   get-tuple-element      4768   2.13% #######
              divide      3377   1.51% #####
            subtract      2664   1.19% ####
             compare      2465   1.10% ####
                iota      2368   1.06% ###
         concatenate      2337   1.04% ###
 shift-right-logical      1568   0.70% ##
   rng-bit-generator      1568   0.70% ##
                sqrt      1393   0.62% ##
     batch-norm-grad       800   0.36% #
 batch-norm-training       800   0.36% #
             scatter       784   0.35% #
               clamp       768   0.34% #
           parameter       463   0.21% 
              negate       416   0.19% 
         exponential       416   0.19% 
                 not       384   0.17% 
                 log        32   0.01% 
                ceil        16   0.01% 
                 abs        16   0.01% 
                sign        16   0.01% 
              gather        16   0.01% 
                 and        16   0.01% 
               tuple         1   0.00% 

DEBUG: needsModular_PreSplit? Yes. macCnt 13965125468160 threshold 4398046511104
DEBUG: transformer model
INFO: Partitioner configs:ModularFlow GT BO LBL SA MaxDisj:2 MaxSep:4 LPM:1
Potential split-points stats: #CC 0 #AR 0 #AG 0 #BN 1600 nClamp 768
DEBUG: needsModular_SplitFinder? Yes.
DEBUG: Added 101 unvisited insts to last part
Num of unique Module Definitions: 136
DefMap:  0 1 2 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 4 3 50 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 52 51 98 99 1 101 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 103 102 149 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 151 150 197 198 1 200 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 202 201 248 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 250 249 296 297 1 299 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 301 300 347 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 349 348 395 396 1 398 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 400 399 446 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 448 447 494 495 1 497 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 499 498 545 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 547 546 593 594 1 596 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 598 597 644 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 646 645 692 693 1 695 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 697 696 743 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 745 744 791 792 1 794 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 842 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 890 891 1 893 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 895 894 941 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 943 942 989 792 1 794 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 796 795 842 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 844 843 890 1089 1 1091 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1093 1092 1139 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1141 1140 1187 1188 1 1190 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1192 1191 1238 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1240 1239 1286 1287 1 1289 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1291 1290 1337 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1339 1338 1385 1386 1 1388 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1390 1389 1436 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1438 1437 1484 1485 1 1487 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1489 1488 1535 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1537 1536 1583 1584 1585 1586 1587 1588 1589 1590 1591 1592 1593 1592 1595 1596 1597 1598 1599
New disjoint wave: start 1536 len 46 NumReps: 23
New disjoint wave: start 1488 len 46 NumReps: 23
New disjoint wave: start 1437 len 46 NumReps: 23
New disjoint wave: start 1389 len 46 NumReps: 23
New disjoint wave: start 1338 len 46 NumReps: 23
New disjoint wave: start 1290 len 46 NumReps: 23
New disjoint wave: start 1239 len 46 NumReps: 23
New disjoint wave: start 1191 len 46 NumReps: 23
New disjoint wave: start 1140 len 46 NumReps: 23
New disjoint wave: start 1092 len 46 NumReps: 23
New disjoint wave: start 1041 len 46 NumReps: 23
New disjoint wave: start 993 len 46 NumReps: 23
New disjoint wave: start 942 len 46 NumReps: 23
New disjoint wave: start 894 len 46 NumReps: 23
New disjoint wave: start 843 len 46 NumReps: 23
New disjoint wave: start 795 len 46 NumReps: 23
New disjoint wave: start 744 len 46 NumReps: 23
New disjoint wave: start 696 len 46 NumReps: 23
New disjoint wave: start 645 len 46 NumReps: 23
New disjoint wave: start 597 len 46 NumReps: 23
New disjoint wave: start 546 len 46 NumReps: 23
New disjoint wave: start 498 len 46 NumReps: 23
New disjoint wave: start 447 len 46 NumReps: 23
New disjoint wave: start 399 len 46 NumReps: 23
New disjoint wave: start 348 len 46 NumReps: 23
New disjoint wave: start 300 len 46 NumReps: 23
New disjoint wave: start 249 len 46 NumReps: 23
New disjoint wave: start 201 len 46 NumReps: 23
New disjoint wave: start 150 len 46 NumReps: 23
New disjoint wave: start 102 len 46 NumReps: 23
New disjoint wave: start 51 len 46 NumReps: 23
New disjoint wave: start 3 len 46 NumReps: 23
INFO: Number of splitPoints: 49
DEBUG: Added 101 unvisited insts to last part
INFO: Total num elems for IntermediateOutput 2196379942
DefMap:  0 1 1 1 1 1 6 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 7 24 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 25 42 43 43 43 43 43 48
Wrote HLO netlist to hlo_netlist.json
Processing partition 0
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 7558660096
INFO: Traffic has found 387572474
INFO: AIF 39.01
HLO Ops used in computation: abs add and batch-norm-training broadcast ceil clamp compare concatenate constant convert custom-call divide dot exponential gather get-tuple-element iota log multiply negate not parameter reduce reshape select sign subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 1
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15209070592
INFO: Traffic has found 146306252
INFO: AIF 207.91
HLO Ops used in computation: add batch-norm-training broadcast clamp compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota multiply negate not parameter reduce reshape select subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 2
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15209070592
INFO: Traffic has found 151090380
INFO: AIF 201.32
HLO Ops used in computation: add batch-norm-training broadcast clamp compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota multiply negate not parameter reduce reshape select subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 3
Replaced 4 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15209070592
INFO: Traffic has found 164164812
INFO: AIF 185.29
HLO Ops used in computation: add batch-norm-training broadcast clamp compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota multiply negate not parameter reduce reshape select subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 1
Processing partition 4
Replaced 2 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 7674691584
INFO: Traffic has found 45830338
INFO: AIF 334.92
HLO Ops used in computation: add batch-norm-grad batch-norm-training broadcast compare concatenate constant convert custom-call divide dot exponential get-tuple-element iota log multiply negate parameter reduce reshape select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 5
Replaced 0 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15838740480
INFO: Traffic has found 196775052
INFO: AIF 160.98
HLO Ops used in computation: add batch-norm-grad broadcast concatenate constant custom-call divide dot get-tuple-element iota multiply parameter reduce reshape scatter select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 6
Replaced 0 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15838740480
INFO: Traffic has found 194907276
INFO: AIF 162.53
HLO Ops used in computation: add batch-norm-grad broadcast concatenate constant custom-call divide dot get-tuple-element iota multiply parameter reduce reshape scatter select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 7
Replaced 0 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 15838740480
INFO: Traffic has found 159419532
INFO: AIF 198.71
HLO Ops used in computation: add batch-norm-grad broadcast concatenate constant custom-call divide dot get-tuple-element iota multiply parameter reduce reshape scatter select sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
Processing partition 8
Replaced 1470 dropout sequences with OffloadedDropout
INFO: HloMacCount has found 13235792461824
INFO: Traffic has found 4193046594
INFO: AIF 6313.21
HLO Ops used in computation: abs add and batch-norm-grad batch-norm-training broadcast ceil clamp compare concatenate constant convert custom-call divide dot exponential gather get-tuple-element iota log multiply negate not parameter reduce reshape scatter select sign sqrt subtract transpose tuple 
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 0
INFO: Number of Native SoftmaxDx's detected and replaced: 0
INFO: Number of Native Softmax's detected and replaced: 360

------------ 
Reported stderr: 
None
------------                       
Import of the HLO graph into the Neuron Compiler has failed.                       
This may be caused by unsupported operators or an internal compiler error.                       
More details can be found in the error message(s) above.
2024-04-02T04:28:59Z INFO 5592 [root]: Subcommand returned with exitcode=1
