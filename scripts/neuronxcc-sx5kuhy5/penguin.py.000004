import neuroncc.starfish.penguin.ir.ir as m0
import neuroncc.starfish.penguin.ir.DebugInfo as m1
import neuroncc.starfish.penguin.targets.tonga.APIndex as m2
import neuroncc.starfish.penguin.targets.tonga.TongaInst as m3
import neuroncc.starfish.penguin.targets.tonga.TongaISAInst as m4
import neuroncc.starfish.penguin.targets.tonga.TongaTensor as m5
import numpy as np
v0 = m0.Function(id_=0, batch_ids=[], attrs=("model-type=compute-bound","mac-count=7558660096",))
def weight_load(p):
  t = np.load(p)
  return t
import neuroncc.starfish.support as m7
v1 = m0.Tensor(name="intermediate1441", shape=(), parent=v0, id=1, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v1)
v2 = m0.Tensor(name="input44", shape=(), parent=v0, id=2, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v2)
v3 = m0.Tensor(name="input45", shape=(1,912), parent=v0, id=3, dtype="int64", view=m0.TensorView(shape=(1,912), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v3)
v4 = m0.Tensor(name="input49", shape=(1024,), parent=v0, id=4, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v4, is_parameter_tensor=True)
v5 = m0.Tensor(name="input48", shape=(128100,1024), parent=v0, id=5, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(128100,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v5, is_parameter_tensor=True)
v6 = m0.Tensor(name="input47", shape=(1,912), parent=v0, id=6, dtype="int64", view=m0.TensorView(shape=(1,912), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v6)
v7 = m0.Tensor(name="input46", shape=(1024,), parent=v0, id=7, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v7, is_parameter_tensor=True)
v8 = m0.Tensor(name="input42", shape=(), parent=v0, id=8, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v8)
v9 = m0.Tensor(name="input64", shape=(1024,1024), parent=v0, id=9, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v9, is_parameter_tensor=True)
v10 = m0.Tensor(name="input63", shape=(1024,), parent=v0, id=10, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v10, is_parameter_tensor=True)
v11 = m0.Tensor(name="input69", shape=(1024,1024), parent=v0, id=11, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v11, is_parameter_tensor=True)
v12 = m0.Tensor(name="input68", shape=(1024,), parent=v0, id=12, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v12, is_parameter_tensor=True)
v13 = m0.Tensor(name="input54", shape=(), parent=v0, id=13, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v13)
v14 = m0.Tensor(name="input60", shape=(), parent=v0, id=14, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v14)
v15 = m0.Tensor(name="input62", shape=(), parent=v0, id=15, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v15)
v16 = m0.Tensor(name="input61", shape=(), parent=v0, id=16, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v16)
v17 = m0.Tensor(name="input59", shape=(), parent=v0, id=17, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v17)
v18 = m0.Tensor(name="input58", shape=(), parent=v0, id=18, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v18)
v19 = m0.Tensor(name="input57", shape=(), parent=v0, id=19, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v19)
v20 = m0.Tensor(name="input56", shape=(), parent=v0, id=20, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v20)
v21 = m0.Tensor(name="input55", shape=(), parent=v0, id=21, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v21)
v22 = m0.Tensor(name="input67", shape=(1024,), parent=v0, id=22, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v22, is_parameter_tensor=True)
v23 = m0.Tensor(name="input66", shape=(512,1024), parent=v0, id=23, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v23)
v24 = m0.Tensor(name="input65", shape=(1024,), parent=v0, id=24, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v24, is_parameter_tensor=True)
v25 = m0.Tensor(name="input53", shape=(1024,1024), parent=v0, id=25, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v25, is_parameter_tensor=True)
v26 = m0.Tensor(name="input52", shape=(1024,), parent=v0, id=26, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v26, is_parameter_tensor=True)
v27 = m0.Tensor(name="input51", shape=(1024,1024), parent=v0, id=27, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v27, is_parameter_tensor=True)
v28 = m0.Tensor(name="input50", shape=(1024,), parent=v0, id=28, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v28, is_parameter_tensor=True)
v29 = m0.Tensor(name="intermediate1466", shape=(912,912,), parent=v0, id=29, dtype="int64", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), attrs={'IntermediateTensor':  "" })
v30 = m0.Tensor(name="intermediate1465", shape=(1,1,912,912,), parent=v0, id=30, dtype="int64", view=m0.TensorView(shape=(1,1,912,912,), layout="NHWC", transpose=(0,1,2,3,)), attrs={'IntermediateTensor':  "" })
v31 = m0.Tensor(name="intermediate1464", shape=(), parent=v0, id=31, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" })
v32 = m0.Tensor(name="intermediate1463", shape=(), parent=v0, id=32, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" })
v33 = m0.Tensor(name="intermediate1462", shape=(), parent=v0, id=33, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" })
v34 = m0.Tensor(name="_tuple_hlo_id_407__mhlo.convert_1935", shape=(912,912,), parent=v0, id=34, dtype="int64", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v35 = m0.Tensor(name="_tuple_hlo_id_407__mhlo.convert_1934", shape=(1,1,912,912,), parent=v0, id=35, dtype="int64", view=m0.TensorView(shape=(1,1,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v36 = m0.Tensor(name="_tuple_hlo_id_407__mhlo.convert_1933", shape=(), parent=v0, id=36, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), )
v37 = m0.Tensor(name="_tuple_hlo_id_407__mhlo.convert_1932", shape=(), parent=v0, id=37, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), )
v38 = m0.Tensor(name="_tuple_hlo_id_407__mhlo.convert_1931", shape=(), parent=v0, id=38, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), )
v39 = m0.Tensor(name="eps__batch_norm_training_2_hlo_id_406__mhlo.batch_norm_training_1930", shape=(), parent=v0, id=39, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_eps__batch_norm_training_2_hlo_id_406__mhlo.batch_norm_training_1930.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v40 = m0.Tensor(name="var__batch_norm_training_2_hlo_id_406__mhlo.batch_norm_training_1929", shape=(912,), parent=v0, id=40, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v41 = m0.Tensor(name="mean__batch_norm_training_2_hlo_id_406__mhlo.batch_norm_training_1928", shape=(912,), parent=v0, id=41, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v42 = m0.Tensor(name="mean_var__batch_norm_training_2_hlo_id_406__mhlo.batch_norm_training_1927", shape=(912,2,), parent=v0, id=42, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,2,), layout="NC", transpose=(0,1,)), )
v43 = m0.Tensor(name="intermediate1468", shape=(1,912,1024,), parent=v0, id=43, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), attrs={'IntermediateTensor':  "" })
v44 = m0.Tensor(name="_reshape_664_hlo_id_392__mhlo.reshape_1925", shape=(1,912,1024,), parent=v0, id=44, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v45 = m0.Tensor(name="_dot_9_hlo_id_391__65", shape=(912,1024,), parent=v0, id=45, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v46 = m0.Tensor(name="_reshape_663_hlo_id_387__mhlo.reshape_1924", shape=(912,1024,), parent=v0, id=46, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v47 = m0.Tensor(name="_reshape_661_hlo_id_385__mhlo.reshape_1923", shape=(1,16,912,64,), parent=v0, id=47, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v48 = m0.Tensor(name="_dot_8_hlo_id_384__64", shape=(16,912,64,), parent=v0, id=48, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v49 = m0.Tensor(name="_reshape_567_hlo_id_383__mhlo.reshape_1922", shape=(16,912,64,), parent=v0, id=49, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v50 = m0.Tensor(name="_reshape_566_hlo_id_381__mhlo.reshape_1921", shape=(1,912,16,64,), parent=v0, id=50, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v51 = m0.Tensor(name="_reshape_563_hlo_id_376__mhlo.reshape_1920", shape=(1,912,1024,), parent=v0, id=51, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v52 = m0.Tensor(name="_dot_hlo_id_375__63", shape=(912,1024,), parent=v0, id=52, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v53 = m0.Tensor(name="_reshape_660_hlo_id_370__mhlo.reshape_1919", shape=(16,912,912,), parent=v0, id=53, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912,), layout="NHC", transpose=(0,1,2,)), )
v54 = m0.Tensor(name="_reshape_87869_hlo_id_353__mhlo.reshape_1918", shape=(1,16,912,912,), parent=v0, id=54, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v55 = m0.Tensor(name="_dot_3_hlo_id_341__62", shape=(16,912,512,), parent=v0, id=55, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,), layout="NHC", transpose=(0,1,2,)), )
v56 = m0.Tensor(name="_reshape_628_hlo_id_339__mhlo.reshape_1917", shape=(16,512,64,), parent=v0, id=56, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), )
v57 = m0.Tensor(name="_reshape_627_hlo_id_337__mhlo.reshape_1916", shape=(1,512,16,64,), parent=v0, id=57, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v58 = m0.Tensor(name="_reshape_624_hlo_id_333__mhlo.reshape_1915", shape=(1,512,1024,), parent=v0, id=58, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v59 = m0.Tensor(name="_dot_1_hlo_id_332__61", shape=(512,1024,), parent=v0, id=59, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v60 = m0.Tensor(name="_reshape_636_hlo_id_329__mhlo.reshape_1914", shape=(16,912,64,), parent=v0, id=60, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v61 = m0.Tensor(name="_reshape_635_hlo_id_327__mhlo.reshape_1913", shape=(1,912,16,64,), parent=v0, id=61, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v62 = m0.Tensor(name="_convert_14810_hlo_id_323__mhlo.convert_1912", shape=(912,912,), parent=v0, id=62, dtype="uint32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v63 = m0.Tensor(name="mhlo_clamp_60", shape=(912,912,), parent=v0, id=63, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v64 = m0.Tensor(name="in__broadcast_841_hlo_id_310__mhlo.constant_1911", shape=(), parent=v0, id=64, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_841_hlo_id_310__mhlo.constant_1911.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v65 = m0.Tensor(name="_broadcast_841_hlo_id_310__mhlo.constant_1910", shape=(16,912,512,912,), parent=v0, id=65, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v66 = m0.Tensor(name="_dot_6_hlo_id_307__59", shape=(16,912,512,), parent=v0, id=66, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,), layout="NHC", transpose=(0,1,2,)), )
v67 = m0.Tensor(name="_reshape_647_hlo_id_305__mhlo.reshape_1909", shape=(16,512,64,), parent=v0, id=67, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), )
v68 = m0.Tensor(name="_reshape_646_hlo_id_303__mhlo.reshape_1908", shape=(1,512,16,64,), parent=v0, id=68, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v69 = m0.Tensor(name="_reshape_643_hlo_id_299__mhlo.reshape_1907", shape=(1,512,1024,), parent=v0, id=69, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v70 = m0.Tensor(name="_dot_4_hlo_id_298__58", shape=(512,1024,), parent=v0, id=70, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v71 = m0.Tensor(name="in__convert_53_hlo_id_273__mhlo.constant_1906", shape=(), parent=v0, id=71, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_53_hlo_id_273__mhlo.constant_1906.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v72 = m0.Tensor(name="_convert_53_hlo_id_273__mhlo.constant_1905", shape=(512,1024,), parent=v0, id=72, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v73 = m0.Tensor(name="in__broadcast_64370_hlo_id_270__mhlo.constant_1904", shape=(), parent=v0, id=73, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_64370_hlo_id_270__mhlo.constant_1904.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v74 = m0.Tensor(name="_broadcast_64370_hlo_id_270__mhlo.constant_1903", shape=(512,1024,), parent=v0, id=74, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v75 = m0.Tensor(name="_concatenate_3_hlo_id_254__mhlo.concatenate_1902", shape=(2,), parent=v0, id=75, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v76 = m0.Tensor(name="_reshape_606_hlo_id_252__mhlo.reshape_1901", shape=(1,), parent=v0, id=76, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v77 = m0.Tensor(name="_convert_47_hlo_id_251__mhlo.convert_1900", shape=(), parent=v0, id=77, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v78 = m0.Tensor(name="in__broadcast_805_hlo_id_250__mhlo.constant_1899", shape=(), parent=v0, id=78, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_805_hlo_id_250__mhlo.constant_1899.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v79 = m0.Tensor(name="_broadcast_805_hlo_id_250__mhlo.constant_1898", shape=(512,1024,), parent=v0, id=79, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v80 = m0.Tensor(name="_convert_14458_hlo_id_245__mhlo.convert_1897", shape=(912,912,), parent=v0, id=80, dtype="uint32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v81 = m0.Tensor(name="mhlo_clamp_57", shape=(912,912,), parent=v0, id=81, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v82 = m0.Tensor(name="in__broadcast_69167_hlo_id_198__mhlo.constant_1896", shape=(), parent=v0, id=82, dtype="int32", value=weight_load("./constant_in__broadcast_69167_hlo_id_198__mhlo.constant_1896.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v83 = m0.Tensor(name="_broadcast_69167_hlo_id_198__mhlo.constant_1895", shape=(912,912,), parent=v0, id=83, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v84 = m0.Tensor(name="_dot_7_hlo_id_196__56", shape=(16,912,912,), parent=v0, id=84, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912,), layout="NHC", transpose=(0,1,2,)), )
v85 = m0.Tensor(name="_reshape_96540_hlo_id_194__mhlo.reshape_1894", shape=(16,912,64,), parent=v0, id=85, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v86 = m0.Tensor(name="_reshape_100604_hlo_id_192__mhlo.reshape_1893", shape=(1,912,16,64,), parent=v0, id=86, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v87 = m0.Tensor(name="_reshape_632_hlo_id_184__mhlo.reshape_1892", shape=(1,912,1024,), parent=v0, id=87, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v88 = m0.Tensor(name="_dot_2_hlo_id_183__55", shape=(912,1024,), parent=v0, id=88, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v89 = m0.Tensor(name="_reshape_655_hlo_id_178__mhlo.reshape_1891", shape=(16,912,64,), parent=v0, id=89, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v90 = m0.Tensor(name="_reshape_654_hlo_id_176__mhlo.reshape_1890", shape=(1,912,16,64,), parent=v0, id=90, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v91 = m0.Tensor(name="_reshape_651_hlo_id_171__mhlo.reshape_1889", shape=(1,912,1024,), parent=v0, id=91, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v92 = m0.Tensor(name="_dot_5_hlo_id_170__54", shape=(912,1024,), parent=v0, id=92, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v93 = m0.Tensor(name="_reshape_650_hlo_id_166__mhlo.reshape_1888", shape=(912,1024,), parent=v0, id=93, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v94 = m0.Tensor(name="_reshape_87818_hlo_id_159__mhlo.reshape_1887", shape=(912,), parent=v0, id=94, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v95 = m0.Tensor(name="_convert_12672_hlo_id_158__mhlo.convert_1886", shape=(1,912,), parent=v0, id=95, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,), layout="NC", transpose=(0,1,)), )
v96 = m0.Tensor(name="eps__batch_norm_training_hlo_id_151__mhlo.batch_norm_training_1885", shape=(), parent=v0, id=96, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_eps__batch_norm_training_hlo_id_151__mhlo.batch_norm_training_1885.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v97 = m0.Tensor(name="var__batch_norm_training_hlo_id_151__mhlo.batch_norm_training_1884", shape=(912,), parent=v0, id=97, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v98 = m0.Tensor(name="mean__batch_norm_training_hlo_id_151__mhlo.batch_norm_training_1883", shape=(912,), parent=v0, id=98, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v99 = m0.Tensor(name="mean_var__batch_norm_training_hlo_id_151__mhlo.batch_norm_training_1882", shape=(912,2,), parent=v0, id=99, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,2,), layout="NC", transpose=(0,1,)), )
v100 = m0.Tensor(name="_batch_norm_training_hlo_id_151__mhlo.batch_norm_training_1881", shape=(1,912,1024,), parent=v0, id=100, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v101 = m0.Tensor(name="in__broadcast_721_hlo_id_150__mhlo.constant_1880", shape=(), parent=v0, id=101, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_721_hlo_id_150__mhlo.constant_1880.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v102 = m0.Tensor(name="_broadcast_721_hlo_id_150__mhlo.constant_1879", shape=(912,), parent=v0, id=102, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v103 = m0.Tensor(name="in__broadcast_723_hlo_id_148__mhlo.constant_1878", shape=(), parent=v0, id=103, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_723_hlo_id_148__mhlo.constant_1878.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v104 = m0.Tensor(name="_broadcast_723_hlo_id_148__mhlo.constant_1877", shape=(912,), parent=v0, id=104, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v105 = m0.Tensor(name="_reshape_548_hlo_id_146__mhlo.reshape_1876", shape=(1,912,1024,), parent=v0, id=105, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v106 = m0.Tensor(name="_gather_hlo_id_145__mhlo.reshape_1875", shape=(912,1,), parent=v0, id=106, dtype="uint32", view=m0.TensorView(shape=(912,1,), layout="NC", transpose=(0,1,)), )
v107 = m0.Tensor(name="_gather_hlo_id_145__mhlo.gather_1874", shape=(912,1024,), parent=v0, id=107, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v108 = m0.Tensor(name="_reshape_89581_hlo_id_144__mhlo.reshape_1873", shape=(912,), parent=v0, id=108, dtype="uint32", view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v109 = m0.Tensor(name="_convert_12673_hlo_id_143__mhlo.convert_1872", shape=(1,912,), parent=v0, id=109, dtype="uint32", view=m0.TensorView(shape=(1,912,), layout="NC", transpose=(0,1,)), )
v110 = m0.Tensor(name="in__convert_22_hlo_id_134__mhlo.constant_1871", shape=(), parent=v0, id=110, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_22_hlo_id_134__mhlo.constant_1871.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v111 = m0.Tensor(name="_convert_22_hlo_id_134__mhlo.constant_1870", shape=(1,912,1024,), parent=v0, id=111, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v112 = m0.Tensor(name="_concatenate_hlo_id_115__mhlo.concatenate_1869", shape=(2,), parent=v0, id=112, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v113 = m0.Tensor(name="_reshape_532_hlo_id_113__mhlo.reshape_1868", shape=(1,), parent=v0, id=113, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v114 = m0.Tensor(name="_convert_16_hlo_id_112__mhlo.convert_1867", shape=(), parent=v0, id=114, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v115 = m0.Tensor(name="in__broadcast_848_hlo_id_109__mhlo.constant_1866", shape=(), parent=v0, id=115, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_848_hlo_id_109__mhlo.constant_1866.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v116 = m0.Tensor(name="_broadcast_848_hlo_id_109__mhlo.constant_1865", shape=(1,16,912,912,), parent=v0, id=116, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v117 = m0.Tensor(name="_constant_3388_hlo_id_108__mhlo.constant_1864", shape=(), parent=v0, id=117, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_3388_hlo_id_108__mhlo.constant_1864.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v118 = m0.Tensor(name="_reshape_95686_hlo_id_102__mhlo.reshape_1863", shape=(912,912,), parent=v0, id=118, dtype="uint8", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v119 = m0.Tensor(name="in__broadcast_762_hlo_id_99__mhlo.constant_1860", shape=(), parent=v0, id=119, dtype="int32", value=weight_load("./constant_in__broadcast_762_hlo_id_99__mhlo.constant_1860.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v120 = m0.Tensor(name="_broadcast_762_hlo_id_99__mhlo.constant_1859", shape=(1,1,912,912,), parent=v0, id=120, dtype="int32", view=m0.TensorView(shape=(1,1,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v121 = m0.Tensor(name="_constant_3350_hlo_id_98__mhlo.constant_1858", shape=(), parent=v0, id=121, dtype="int32", value=weight_load("./constant__constant_3350_hlo_id_98__mhlo.constant_1858.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v122 = m0.Tensor(name="in__convert_38_hlo_id_89__mhlo.constant_1857", shape=(), parent=v0, id=122, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_38_hlo_id_89__mhlo.constant_1857.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v123 = m0.Tensor(name="_convert_38_hlo_id_89__mhlo.constant_1856", shape=(1,16,912,912,), parent=v0, id=123, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v124 = m0.Tensor(name="in__broadcast_64354_hlo_id_86__mhlo.constant_1855", shape=(), parent=v0, id=124, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_64354_hlo_id_86__mhlo.constant_1855.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v125 = m0.Tensor(name="_broadcast_64354_hlo_id_86__mhlo.constant_1854", shape=(1,16,912,912,), parent=v0, id=125, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v126 = m0.Tensor(name="_concatenate_2_hlo_id_70__mhlo.concatenate_1853", shape=(2,), parent=v0, id=126, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v127 = m0.Tensor(name="_reshape_570_hlo_id_68__mhlo.reshape_1852", shape=(1,), parent=v0, id=127, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v128 = m0.Tensor(name="_convert_32_hlo_id_67__mhlo.convert_1851", shape=(), parent=v0, id=128, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v129 = m0.Tensor(name="in__broadcast_757_hlo_id_66__mhlo.constant_1850", shape=(), parent=v0, id=129, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_757_hlo_id_66__mhlo.constant_1850.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v130 = m0.Tensor(name="_broadcast_757_hlo_id_66__mhlo.constant_1849", shape=(1,16,912,912,), parent=v0, id=130, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v131 = m0.Tensor(name="in__convert_31_hlo_id_62__mhlo.constant_1848", shape=(), parent=v0, id=131, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_31_hlo_id_62__mhlo.constant_1848.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v132 = m0.Tensor(name="_convert_31_hlo_id_62__mhlo.constant_1847", shape=(1,912,1024,), parent=v0, id=132, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v133 = m0.Tensor(name="in__broadcast_64349_hlo_id_59__mhlo.constant_1846", shape=(), parent=v0, id=133, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_64349_hlo_id_59__mhlo.constant_1846.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v134 = m0.Tensor(name="_broadcast_64349_hlo_id_59__mhlo.constant_1845", shape=(1,912,1024,), parent=v0, id=134, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v135 = m0.Tensor(name="_concatenate_1_hlo_id_42__mhlo.concatenate_1844", shape=(2,), parent=v0, id=135, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v136 = m0.Tensor(name="in__constant_63611_hlo_id_41__mhlo.constant_1843", shape=(), parent=v0, id=136, dtype="uint32", value=weight_load("./constant_in__constant_63611_hlo_id_41__mhlo.constant_1843.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v137 = m0.Tensor(name="_constant_63611_hlo_id_41__mhlo.constant_1842", shape=(1,), parent=v0, id=137, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v138 = m0.Tensor(name="_reshape_552_hlo_id_40__mhlo.reshape_1841", shape=(1,), parent=v0, id=138, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v139 = m0.Tensor(name="_convert_25_hlo_id_39__mhlo.convert_1840", shape=(), parent=v0, id=139, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v140 = m0.Tensor(name="in__broadcast_742_hlo_id_13__mhlo.constant_1839", shape=(), parent=v0, id=140, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_742_hlo_id_13__mhlo.constant_1839.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v141 = m0.Tensor(name="_broadcast_742_hlo_id_13__mhlo.constant_1838", shape=(1,912,1024,), parent=v0, id=141, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v142 = m0.Tensor(name="_reshape_621_hlo_id_287__mhlo.reshape_1837", shape=(512,1024,), parent=v0, id=142, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v143 = m0.Tensor(name="eps__batch_norm_training_1_hlo_id_285__mhlo.batch_norm_training_1836", shape=(), parent=v0, id=143, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_eps__batch_norm_training_1_hlo_id_285__mhlo.batch_norm_training_1836.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v144 = m0.Tensor(name="var__batch_norm_training_1_hlo_id_285__mhlo.batch_norm_training_1835", shape=(512,), parent=v0, id=144, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,), layout="N", transpose=(0,)), )
v145 = m0.Tensor(name="mean__batch_norm_training_1_hlo_id_285__mhlo.batch_norm_training_1834", shape=(512,), parent=v0, id=145, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,), layout="N", transpose=(0,)), )
v146 = m0.Tensor(name="mean_var__batch_norm_training_1_hlo_id_285__mhlo.batch_norm_training_1833", shape=(512,2,), parent=v0, id=146, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,2,), layout="NC", transpose=(0,1,)), )
v147 = m0.Tensor(name="_batch_norm_training_1_hlo_id_285__mhlo.batch_norm_training_1832", shape=(1,512,1024,), parent=v0, id=147, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v148 = m0.Tensor(name="in__broadcast_811_hlo_id_284__mhlo.constant_1831", shape=(), parent=v0, id=148, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_811_hlo_id_284__mhlo.constant_1831.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v149 = m0.Tensor(name="_broadcast_811_hlo_id_284__mhlo.constant_1830", shape=(512,), parent=v0, id=149, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,), layout="N", transpose=(0,)), )
v150 = m0.Tensor(name="_constant_22537_hlo_id_58__mhlo.constant_1829", shape=(), parent=v0, id=150, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_22537_hlo_id_58__mhlo.constant_1829.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v151 = m0.Tensor(name="in__broadcast_813_hlo_id_282__mhlo.constant_1828", shape=(), parent=v0, id=151, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_813_hlo_id_282__mhlo.constant_1828.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v152 = m0.Tensor(name="_broadcast_813_hlo_id_282__mhlo.constant_1827", shape=(512,), parent=v0, id=152, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,), layout="N", transpose=(0,)), )
v153 = m0.Tensor(name="_constant_63610_hlo_id_12__mhlo.constant_1826", shape=(), parent=v0, id=153, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_63610_hlo_id_12__mhlo.constant_1826.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v154 = m0.Tensor(name="_reshape_620_hlo_id_280__mhlo.reshape_1825", shape=(1,512,1024,), parent=v0, id=154, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v155 = m0.Tensor(name="_convert_46_hlo_id_238__mhlo.convert_1824", shape=(912,912,), parent=v0, id=155, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v156 = m0.Tensor(name="_convert_44_hlo_id_235__mhlo.convert_1823", shape=(912,912,), parent=v0, id=156, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v157 = m0.Tensor(name="_convert_39_hlo_id_220__mhlo.convert_1822", shape=(), parent=v0, id=157, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), )
v158 = m0.Tensor(name="_convert_43_hlo_id_219__mhlo.convert_1821", shape=(912,912,), parent=v0, id=158, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v159 = m0.Tensor(name="_convert_45_hlo_id_218__mhlo.convert_1820", shape=(912,912,), parent=v0, id=159, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v160 = m0.Tensor(name="in__convert_42_hlo_id_211__mhlo.constant_1819", shape=(), parent=v0, id=160, dtype="uint8", value=weight_load("./constant_in__convert_42_hlo_id_211__mhlo.constant_1819.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v161 = m0.Tensor(name="_convert_42_hlo_id_211__mhlo.constant_1818", shape=(912,912,), parent=v0, id=161, dtype="uint8", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v162 = m0.Tensor(name="_convert_41_hlo_id_209__mhlo.convert_1817", shape=(912,912,), parent=v0, id=162, dtype="uint8", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v163 = m0.Tensor(name="_convert_40_hlo_id_205__mhlo.convert_1816", shape=(912,912,), parent=v0, id=163, dtype="uint8", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v164 = m0.Tensor(name="_reshape_87141_hlo_id_93__mhlo.reshape_1815", shape=(912,), parent=v0, id=164, dtype="int32", view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v165 = m0.Tensor(name="_constant_3308_hlo_id_22__mhlo.constant_1814", shape=(), parent=v0, id=165, dtype="int32", value=weight_load("./constant__constant_3308_hlo_id_22__mhlo.constant_1814.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v166 = m0.Tensor(name="_constant_3332_hlo_id_14__mhlo.constant_1813", shape=(), parent=v0, id=166, dtype="int32", value=weight_load("./constant__constant_3332_hlo_id_14__mhlo.constant_1813.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v167 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1812", shape=(), parent=v0, id=167, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v168 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1811", shape=(1,912,), parent=v0, id=168, dtype="int32", view=m0.TensorView(shape=(1,912,), layout="NC", transpose=(0,1,)), )
v169 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1810", shape=(1,912,), parent=v0, id=169, dtype="int32", view=m0.TensorView(shape=(1,912,), layout="NC", transpose=(0,1,)), )
v170 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1809", shape=(), parent=v0, id=170, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v171 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1808", shape=(), parent=v0, id=171, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v172 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1807", shape=(), parent=v0, id=172, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v173 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1806", shape=(), parent=v0, id=173, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v174 = m0.Tensor(name="mlir_function_hlo_id_407__mhlo.convert_1805", shape=(), parent=v0, id=174, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v175 = m0.OffloadedMemCast(srcs=[v21], dsts=[v174], dtype="int32", id=175, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v176 = m0.OffloadedMemCast(srcs=[v20], dsts=[v173], dtype="int32", id=176, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v177 = m0.OffloadedMemCast(srcs=[v16], dsts=[v172], dtype="int32", id=177, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v178 = m0.OffloadedMemCast(srcs=[v15], dsts=[v171], dtype="int32", id=178, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v179 = m0.OffloadedMemCast(srcs=[v14], dsts=[v170], dtype="int32", id=179, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v180 = m0.OffloadedMemCast(srcs=[v6], dsts=[v169], dtype="int32", id=180, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v181 = m0.OffloadedMemCast(srcs=[v3], dsts=[v168], dtype="int32", id=181, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v182 = m0.OffloadedMemCast(srcs=[v1], dsts=[v167], dtype="int32", id=182, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=407))
v184 = m0.Tensor(name="multiply.1417", shape=(), parent=v0, id=183, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
import neuroncc.starfish.penguin.frontends.XlaFE as m8
v183 = m8.NeuronTensorOp(srcs=[v166, v167], dsts=[v184], op=np.multiply, xla_op='mhlo.binary', id=184, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1580", line=0, column=0, hlo_id=21))
v186 = m0.Tensor(name="add.1451", shape=(), parent=v0, id=185, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v185 = m8.NeuronTensorOp(srcs=[v184, v165], dsts=[v186], op=np.add, xla_op='mhlo.binary', id=186, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2829", line=0, column=0, hlo_id=23))
v188 = m0.Tensor(name="multiply.1418", shape=(), parent=v0, id=187, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v187 = m8.NeuronTensorOp(srcs=[v166, v186], dsts=[v188], op=np.multiply, xla_op='mhlo.binary', id=188, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1581", line=0, column=0, hlo_id=24))
v190 = m0.Tensor(name="add.1452", shape=(), parent=v0, id=189, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v189 = m8.NeuronTensorOp(srcs=[v188, v165], dsts=[v190], op=np.add, xla_op='mhlo.binary', id=190, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2830", line=0, column=0, hlo_id=26))
v192 = m0.Tensor(name="multiply.1419", shape=(), parent=v0, id=191, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v191 = m8.NeuronTensorOp(srcs=[v166, v190], dsts=[v192], op=np.multiply, xla_op='mhlo.binary', id=192, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1582", line=0, column=0, hlo_id=27))
v194 = m0.Tensor(name="add.1453", shape=(), parent=v0, id=193, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v193 = m8.NeuronTensorOp(srcs=[v192, v165], dsts=[v194], op=np.add, xla_op='mhlo.binary', id=194, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2831", line=0, column=0, hlo_id=29))
v196 = m0.Tensor(name="multiply.1420", shape=(), parent=v0, id=195, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v195 = m8.NeuronTensorOp(srcs=[v166, v194], dsts=[v196], op=np.multiply, xla_op='mhlo.binary', id=196, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1591", line=0, column=0, hlo_id=30))
v198 = m0.Tensor(name="add.1454", shape=(), parent=v0, id=197, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v197 = m8.NeuronTensorOp(srcs=[v196, v165], dsts=[v198], op=np.add, xla_op='mhlo.binary', id=198, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2835", line=0, column=0, hlo_id=32))
v200 = m0.Tensor(name="multiply.1421", shape=(), parent=v0, id=199, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v199 = m8.NeuronTensorOp(srcs=[v166, v198], dsts=[v200], op=np.multiply, xla_op='mhlo.binary', id=200, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1592", line=0, column=0, hlo_id=33))
v202 = m0.Tensor(name="add.1455", shape=(), parent=v0, id=201, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v201 = m8.NeuronTensorOp(srcs=[v200, v165], dsts=[v202], op=np.add, xla_op='mhlo.binary', id=202, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2836", line=0, column=0, hlo_id=35))
v204 = m0.Tensor(name="multiply.1422", shape=(), parent=v0, id=203, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v203 = m8.NeuronTensorOp(srcs=[v166, v202], dsts=[v204], op=np.multiply, xla_op='mhlo.binary', id=204, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1593", line=0, column=0, hlo_id=36))
v206 = m0.Tensor(name="add.1456", shape=(), parent=v0, id=205, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v205 = m8.NeuronTensorOp(srcs=[v204, v165], dsts=[v206], op=np.add, xla_op='mhlo.binary', id=206, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2837", line=0, column=0, hlo_id=38))
v207 = m0.OffloadedMemCpy(srcs=[v168], dsts=[v164], dtype="int32", id=207, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.87141", line=0, column=0, hlo_id=93))
v209 = m0.Tensor(name="broadcast_in_dim.105", shape=(1,1,912,912), parent=v0, id=208, dtype="int32", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v208 = m8.NeuronTensorOp(srcs=[v164], dsts=[v209], xla_op='mhlo.broadcast_in_dim', bcdims=[3], id=209, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.761", line=0, column=0, hlo_id=94))
v211 = m0.Tensor(name="broadcast_in_dim.106", shape=(1,1,912,912), parent=v0, id=210, dtype="int32", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v210 = m8.NeuronTensorOp(srcs=[v164], dsts=[v211], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=211, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.759", line=0, column=0, hlo_id=96))
v213 = m0.Tensor(name="multiply.1423", shape=(1,1,912,912), parent=v0, id=212, dtype="int32", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v212 = m8.NeuronTensorOp(srcs=[v209, v211], dsts=[v213], op=np.multiply, xla_op='mhlo.binary', id=213, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1602", line=0, column=0, hlo_id=97))
v215 = m0.Tensor(name="iota.11", shape=(912,912), parent=v0, id=214, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v214 = m0.IotaTensorOp(srcs=[], dsts=[v215], op=m0.iota, shape=(912,912), iota_dim=0, dtype="int32", id=215, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.1003", line=0, column=0, hlo_id=199))
v217 = m0.Tensor(name="iota.12", shape=(912,912), parent=v0, id=216, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v216 = m0.IotaTensorOp(srcs=[], dsts=[v217], op=m0.iota, shape=(912,912), iota_dim=1, dtype="int32", id=217, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.1005", line=0, column=0, hlo_id=200))
v219 = m0.Tensor(name="subtract.18", shape=(912,912), parent=v0, id=218, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v218 = m8.NeuronTensorOp(srcs=[v215, v217], dsts=[v219], op=np.subtract, xla_op='mhlo.binary', id=219, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.38", line=0, column=0, hlo_id=201))
v221 = m0.Tensor(name="broadcast_in_dim.107", shape=(912,912), parent=v0, id=220, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v220 = m8.NeuronTensorOp(srcs=[v170], dsts=[v221], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=221, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.782", line=0, column=0, hlo_id=203))
v223 = m0.Tensor(name="compare.33", shape=(912,912), parent=v0, id=222, dtype="uint8", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v222 = m8.NeuronTensorOp(srcs=[v219, v221], dsts=[v223], op=np.less, xla_op='mhlo.binary', id=223, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.55", line=0, column=0, hlo_id=204))
v224 = m0.OffloadedMemCast(srcs=[v223], dsts=[v163], dtype="uint8", id=224, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.40", line=0, column=0, hlo_id=205))
v226 = m0.Tensor(name="broadcast_in_dim.108", shape=(912,912), parent=v0, id=225, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v225 = m8.NeuronTensorOp(srcs=[v171], dsts=[v226], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=226, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.781", line=0, column=0, hlo_id=207))
v228 = m0.Tensor(name="compare.34", shape=(912,912), parent=v0, id=227, dtype="uint8", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v227 = m8.NeuronTensorOp(srcs=[v219, v226], dsts=[v228], op=np.greater, xla_op='mhlo.binary', id=228, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.54", line=0, column=0, hlo_id=208))
v229 = m0.OffloadedMemCast(srcs=[v228], dsts=[v162], dtype="uint8", id=229, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.41", line=0, column=0, hlo_id=209))
v231 = m0.Tensor(name="and.2", shape=(912,912), parent=v0, id=230, dtype="uint8", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v230 = m8.NeuronTensorOp(srcs=[v163, v162], dsts=[v231], op=np.bitwise_and, xla_op='mhlo.binary', id=231, parent=v0, dl=m1.DebugLocation(tensor_op_name="_and", line=0, column=0, hlo_id=210))
v232 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v233 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v232)
v234a = m0.AffineAccess(tensor=v160, addrs=[])
v234 = m0.AffineLoad(src=v234a, predicates=[], id=232, parent=v233, dl=m1.DebugLocation(tensor_op_name="_convert.42", line=0, column=0, hlo_id=211))
v235a = m0.AffineAccess(tensor=v161, addrs=[v232, v233])
v235 = m0.AffineStore(dst=v235a, src=v234, predicates=[], id=233, parent=v233, dl=m1.DebugLocation(tensor_op_name="_convert.42", line=0, column=0, hlo_id=211))
v237 = m0.Tensor(name="compare.35", shape=(912,912), parent=v0, id=234, dtype="uint8", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v236 = m8.NeuronTensorOp(srcs=[v231, v161], dsts=[v237], op=np.not_equal, xla_op='mhlo.binary', id=235, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.42", line=0, column=0, hlo_id=211))
v239 = m0.Tensor(name="broadcast_in_dim.109", shape=(912,912), parent=v0, id=236, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v238 = m8.NeuronTensorOp(srcs=[v172], dsts=[v239], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=237, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.64670", line=0, column=0, hlo_id=213))
import scipy.special as m9
v241 = m0.Tensor(name="abs.2", shape=(912,912), parent=v0, id=238, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v240 = m8.NeuronTensorOp(srcs=[v219], dsts=[v241], op=np.abs, xla_op='mhlo.unary', id=239, parent=v0, dl=m1.DebugLocation(tensor_op_name="_abs", line=0, column=0, hlo_id=214))
v243 = m0.Tensor(name="select.51", shape=(912,912), parent=v0, id=240, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v242 = m0.TernaryTensorOp(srcs=[v237, v239, v241], dsts=[v243], op=np.select, id=241, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4960", line=0, column=0, hlo_id=215))
v245 = m0.Tensor(name="compare.36", shape=(912,912), parent=v0, id=242, dtype="uint8", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v244 = m8.NeuronTensorOp(srcs=[v243, v221], dsts=[v245], op=np.less_equal, xla_op='mhlo.binary', id=243, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.56", line=0, column=0, hlo_id=217))
v246 = m0.OffloadedMemCast(srcs=[v219], dsts=[v159], dtype=m7.dtype.bfloat16, id=244, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.45", line=0, column=0, hlo_id=218))
v247 = m0.OffloadedMemCast(srcs=[v243], dsts=[v158], dtype=m7.dtype.bfloat16, id=245, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.43", line=0, column=0, hlo_id=219))
v248 = m0.OffloadedMemCast(srcs=[v170], dsts=[v157], dtype=m7.dtype.bfloat16, id=246, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.39", line=0, column=0, hlo_id=220))
v250 = m0.Tensor(name="broadcast_in_dim.110", shape=(912,912), parent=v0, id=247, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v249 = m8.NeuronTensorOp(srcs=[v157], dsts=[v250], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=248, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.784", line=0, column=0, hlo_id=221))
v252 = m0.Tensor(name="divide.15", shape=(912,912), parent=v0, id=249, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v251 = m8.NeuronTensorOp(srcs=[v158, v250], dsts=[v252], op=np.divide, xla_op='mhlo.binary', id=250, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.32", line=0, column=0, hlo_id=222))
v254 = m0.Tensor(name="log.2", shape=(912,912), parent=v0, id=251, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v253 = m8.NeuronTensorOp(srcs=[v252], dsts=[v254], op=np.log, xla_op='mhlo.unary', id=252, parent=v0, dl=m1.DebugLocation(tensor_op_name="_log.16", line=0, column=0, hlo_id=223))
v256 = m0.Tensor(name="broadcast_in_dim.111", shape=(912,912), parent=v0, id=253, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v255 = m8.NeuronTensorOp(srcs=[v17], dsts=[v256], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=254, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.785", line=0, column=0, hlo_id=225))
v258 = m0.Tensor(name="divide.16", shape=(912,912), parent=v0, id=255, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v257 = m8.NeuronTensorOp(srcs=[v254, v256], dsts=[v258], op=np.divide, xla_op='mhlo.binary', id=256, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.33", line=0, column=0, hlo_id=226))
v260 = m0.Tensor(name="broadcast_in_dim.112", shape=(912,912), parent=v0, id=257, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v259 = m8.NeuronTensorOp(srcs=[v18], dsts=[v260], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=258, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.786", line=0, column=0, hlo_id=228))
v262 = m0.Tensor(name="multiply.1424", shape=(912,912), parent=v0, id=259, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v261 = m8.NeuronTensorOp(srcs=[v258, v260], dsts=[v262], op=np.multiply, xla_op='mhlo.binary', id=260, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1606", line=0, column=0, hlo_id=229))
v264 = m0.Tensor(name="ceil.2", shape=(912,912), parent=v0, id=261, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v263 = m8.NeuronTensorOp(srcs=[v262], dsts=[v264], op=np.ceil, xla_op='mhlo.unary', id=262, parent=v0, dl=m1.DebugLocation(tensor_op_name="_ceil", line=0, column=0, hlo_id=230))
v266 = m0.Tensor(name="broadcast_in_dim.113", shape=(912,912), parent=v0, id=263, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v265 = m8.NeuronTensorOp(srcs=[v19], dsts=[v266], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=264, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.787", line=0, column=0, hlo_id=232))
v268 = m0.Tensor(name="add.1457", shape=(912,912), parent=v0, id=265, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v267 = m8.NeuronTensorOp(srcs=[v264, v266], dsts=[v268], op=np.add, xla_op='mhlo.binary', id=266, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2841", line=0, column=0, hlo_id=233))
v270 = m0.Tensor(name="sign.2", shape=(912,912), parent=v0, id=267, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v269 = m8.NeuronTensorOp(srcs=[v219], dsts=[v270], op=np.sign, xla_op='mhlo.unary', id=268, parent=v0, dl=m1.DebugLocation(tensor_op_name="_sign", line=0, column=0, hlo_id=234))
v271 = m0.OffloadedMemCast(srcs=[v270], dsts=[v156], dtype=m7.dtype.bfloat16, id=269, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.44", line=0, column=0, hlo_id=235))
v273 = m0.Tensor(name="multiply.1425", shape=(912,912), parent=v0, id=270, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v272 = m8.NeuronTensorOp(srcs=[v268, v156], dsts=[v273], op=np.multiply, xla_op='mhlo.binary', id=271, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1607", line=0, column=0, hlo_id=236))
v275 = m0.Tensor(name="select.52", shape=(912,912), parent=v0, id=272, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v274 = m0.TernaryTensorOp(srcs=[v245, v159, v273], dsts=[v275], op=np.select, id=273, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.35", line=0, column=0, hlo_id=237))
v276 = m0.OffloadedMemCast(srcs=[v275], dsts=[v155], dtype="int32", id=274, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.46", line=0, column=0, hlo_id=238))
v278 = m0.Tensor(name="broadcast_in_dim.114", shape=(512,1024), parent=v0, id=275, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v277 = m8.NeuronTensorOp(srcs=[v22], dsts=[v278], xla_op='mhlo.broadcast_in_dim', bcdims=[1], id=276, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.817", line=0, column=0, hlo_id=278))
v279 = m0.OffloadedMemCpy(srcs=[v23], dsts=[v154], dtype=m7.dtype.bfloat16, id=277, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.620", line=0, column=0, hlo_id=280))
v280 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v281a = m0.AffineAccess(tensor=v151, addrs=[])
v281 = m0.AffineLoad(src=v281a, predicates=[], id=278, parent=v280, dl=m1.DebugLocation(tensor_op_name="_broadcast.813", line=0, column=0, hlo_id=282))
v282a = m0.AffineAccess(tensor=v152, addrs=[v280])
v282 = m0.AffineStore(dst=v282a, src=v281, predicates=[], id=279, parent=v280, dl=m1.DebugLocation(tensor_op_name="_broadcast.813", line=0, column=0, hlo_id=282))
v283 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v284a = m0.AffineAccess(tensor=v148, addrs=[])
v284 = m0.AffineLoad(src=v284a, predicates=[], id=280, parent=v283, dl=m1.DebugLocation(tensor_op_name="_broadcast.811", line=0, column=0, hlo_id=284))
v285a = m0.AffineAccess(tensor=v149, addrs=[v283])
v285 = m0.AffineStore(dst=v285a, src=v284, predicates=[], id=281, parent=v283, dl=m1.DebugLocation(tensor_op_name="_broadcast.811", line=0, column=0, hlo_id=284))
v286 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v287 = m0.Axis(lb=0, ub=512, stride=1, it="j", parent=v286)
v288 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v287)
v289a = m0.AffineAccess(tensor=v23, addrs=[v287, v288])
v289 = m0.AffineLoad(src=v289a, predicates=[], id=282, parent=v288, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v290_v291 = m0.BatchNormMeanVarOp(data=v289, reduce_axes=[v286, v288], id=283, parent=v288, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v290 = m0.ExtractValue(src=v290_v291, idxes=[0], id=284, parent=v288, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v291 = m0.ExtractValue(src=v290_v291, idxes=[1], id=285, parent=v288, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v292a = m0.AffineAccess(tensor=v146, addrs=[v287, 0])
v292 = m0.AffineStore(dst=v292a, src=v290, predicates=[], id=286, parent=v288, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v293a = m0.AffineAccess(tensor=v146, addrs=[v287, 1])
v293 = m0.AffineStore(dst=v293a, src=v291, predicates=[], id=287, parent=v288, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v294 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v295 = m0.Axis(lb=0, ub=512, stride=1, it="j", parent=v294)
v296 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v295)
v297a = m0.AffineAccess(tensor=v23, addrs=[v295, v296])
v297 = m0.AffineLoad(src=v297a, predicates=[], id=288, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v298a = m0.AffineAccess(tensor=v152, addrs=[v295])
v298 = m0.AffineLoad(src=v298a, predicates=[], id=289, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v299a = m0.AffineAccess(tensor=v149, addrs=[v295])
v299 = m0.AffineLoad(src=v299a, predicates=[], id=290, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v300a = m0.AffineAccess(tensor=v143, addrs=[])
v300 = m0.AffineLoad(src=v300a, predicates=[], id=291, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v301a = m0.AffineAccess(tensor=v146, addrs=[v295, 0])
v301 = m0.AffineLoad(src=v301a, predicates=[], id=292, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v302a = m0.AffineAccess(tensor=v146, addrs=[v295, 1])
v302 = m0.AffineLoad(src=v302a, predicates=[], id=293, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v303 = m0.BinaryOp(lhs=v302, rhs=v300, op=np.add, id=294, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v304 = m0.UnaryOp(data=v303, op=m0.rsqrt, id=295, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v305 = m0.BinaryOp(lhs=v297, rhs=v301, op=np.subtract, id=296, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v306 = m0.BinaryOp(lhs=v298, rhs=v305, op=np.multiply, id=297, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v307 = m0.BinaryOp(lhs=v306, rhs=v304, op=np.multiply, id=298, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v308 = m0.BinaryOp(lhs=v307, rhs=v299, op=np.add, id=299, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v309a = m0.AffineAccess(tensor=v147, addrs=[v294, v295, v296])
v309 = m0.AffineStore(dst=v309a, src=v308, predicates=[], id=300, parent=v296, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v310 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v311a = m0.AffineAccess(tensor=v146, addrs=[v310, 0])
v311 = m0.AffineLoad(src=v311a, predicates=[], id=301, parent=v310, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v312a = m0.AffineAccess(tensor=v145, addrs=[v310])
v312 = m0.AffineStore(dst=v312a, src=v311, predicates=[], id=302, parent=v310, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v313 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v314a = m0.AffineAccess(tensor=v146, addrs=[v313, 1])
v314 = m0.AffineLoad(src=v314a, predicates=[], id=303, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v315a = m0.AffineAccess(tensor=v144, addrs=[v313])
v315 = m0.AffineStore(dst=v315a, src=v314, predicates=[], id=304, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.1", line=0, column=0, hlo_id=285))
v316 = m0.OffloadedMemCpy(srcs=[v147], dsts=[v142], dtype=m7.dtype.bfloat16, id=305, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.621", line=0, column=0, hlo_id=287))
v318 = m0.Tensor(name="broadcast_in_dim.115", shape=(512,1024), parent=v0, id=306, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v317 = m8.NeuronTensorOp(srcs=[v24], dsts=[v318], xla_op='mhlo.broadcast_in_dim', bcdims=[1], id=307, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.815", line=0, column=0, hlo_id=290))
v320 = m0.Tensor(name="multiply.1426", shape=(512,1024), parent=v0, id=308, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v319 = m8.NeuronTensorOp(srcs=[v142, v318], dsts=[v320], op=np.multiply, xla_op='mhlo.binary', id=309, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1613", line=0, column=0, hlo_id=291))
v322 = m0.Tensor(name="add.1458", shape=(512,1024), parent=v0, id=310, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v321 = m8.NeuronTensorOp(srcs=[v278, v320], dsts=[v322], op=np.add, xla_op='mhlo.binary', id=311, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2845", line=0, column=0, hlo_id=292))
v323 = m0.Tensor(name="intermediate1467", shape=(512,1024), parent=v0, id=312, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), attrs={'IntermediateTensor':  "" })
v324 = m0.OffloadedMemCpy(srcs=[v322], dsts=[v323], dtype=m7.dtype.bfloat16, id=313, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=25))
v325 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v326 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v325)
v327 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v326)
v328a = m0.AffineAccess(tensor=v140, addrs=[])
v328 = m0.AffineLoad(src=v328a, predicates=[], id=314, parent=v327, dl=m1.DebugLocation(tensor_op_name="_broadcast.742", line=0, column=0, hlo_id=13))
v329a = m0.AffineAccess(tensor=v141, addrs=[v325, v326, v327])
v329 = m0.AffineStore(dst=v329a, src=v328, predicates=[], id=315, parent=v327, dl=m1.DebugLocation(tensor_op_name="_broadcast.742", line=0, column=0, hlo_id=13))
v330 = m0.OffloadedMemCast(srcs=[v206], dsts=[v139], dtype="uint32", id=316, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.25", line=0, column=0, hlo_id=39))
v331 = m0.OffloadedMemCpy(srcs=[v139], dsts=[v138], dtype="uint32", id=317, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.552", line=0, column=0, hlo_id=40))
v332 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v333a = m0.AffineAccess(tensor=v136, addrs=[])
v333 = m0.AffineLoad(src=v333a, predicates=[], id=318, parent=v332, dl=m1.DebugLocation(tensor_op_name="_constant.63611", line=0, column=0, hlo_id=41))
v334a = m0.AffineAccess(tensor=v137, addrs=[v332])
v334 = m0.AffineStore(dst=v334a, src=v333, predicates=[], id=319, parent=v332, dl=m1.DebugLocation(tensor_op_name="_constant.63611", line=0, column=0, hlo_id=41))
v335 = m0.OffloadedConcat(srcs=[v138, v137, ], dsts=[v135], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=320, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.1", line=0, column=0, hlo_id=42))
v337 = m0.Tensor(name="get_tuple_element.17", shape=(1,912,1024), parent=v0, id=321, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v338 = m0.Tensor(name="custom_call.24", shape=(2,), parent=v0, id=322, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v336 = m8.NeuronTensorOp(srcs=[v2, v135], dsts=[v337, v338], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=323, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call", line=0, column=0, hlo_id=408))
v339 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v340 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v339)
v341 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v340)
v342a = m0.AffineAccess(tensor=v133, addrs=[])
v342 = m0.AffineLoad(src=v342a, predicates=[], id=324, parent=v341, dl=m1.DebugLocation(tensor_op_name="_broadcast.64349", line=0, column=0, hlo_id=59))
v343a = m0.AffineAccess(tensor=v134, addrs=[v339, v340, v341])
v343 = m0.AffineStore(dst=v343a, src=v342, predicates=[], id=325, parent=v341, dl=m1.DebugLocation(tensor_op_name="_broadcast.64349", line=0, column=0, hlo_id=59))
v345 = m0.Tensor(name="select.53", shape=(1,912,1024), parent=v0, id=326, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v344 = m0.TernaryTensorOp(srcs=[v337, v141, v134], dsts=[v345], op=np.select, id=327, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4926", line=0, column=0, hlo_id=60))
v347 = m0.Tensor(name="subtract.19", shape=(1,912,1024), parent=v0, id=328, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v346 = m8.NeuronTensorOp(srcs=[v141, v345], dsts=[v347], op=np.subtract, xla_op='mhlo.binary', id=329, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.35", line=0, column=0, hlo_id=61))
v348 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v349 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v348)
v350 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v349)
v351a = m0.AffineAccess(tensor=v131, addrs=[])
v351 = m0.AffineLoad(src=v351a, predicates=[], id=330, parent=v350, dl=m1.DebugLocation(tensor_op_name="_convert.31", line=0, column=0, hlo_id=62))
v352a = m0.AffineAccess(tensor=v132, addrs=[v348, v349, v350])
v352 = m0.AffineStore(dst=v352a, src=v351, predicates=[], id=331, parent=v350, dl=m1.DebugLocation(tensor_op_name="_convert.31", line=0, column=0, hlo_id=62))
v354 = m0.Tensor(name="compare.37", shape=(1,912,1024), parent=v0, id=332, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v353 = m8.NeuronTensorOp(srcs=[v347, v132], dsts=[v354], op=np.not_equal, xla_op='mhlo.binary', id=333, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.31", line=0, column=0, hlo_id=62))
v355 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v356 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v355)
v357 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v356)
v358 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v357)
v359a = m0.AffineAccess(tensor=v129, addrs=[])
v359 = m0.AffineLoad(src=v359a, predicates=[], id=334, parent=v358, dl=m1.DebugLocation(tensor_op_name="_broadcast.757", line=0, column=0, hlo_id=66))
v360a = m0.AffineAccess(tensor=v130, addrs=[v355, v356, v357, v358])
v360 = m0.AffineStore(dst=v360a, src=v359, predicates=[], id=335, parent=v358, dl=m1.DebugLocation(tensor_op_name="_broadcast.757", line=0, column=0, hlo_id=66))
v361 = m0.OffloadedMemCast(srcs=[v202], dsts=[v128], dtype="uint32", id=336, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.32", line=0, column=0, hlo_id=67))
v362 = m0.OffloadedMemCpy(srcs=[v128], dsts=[v127], dtype="uint32", id=337, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.570", line=0, column=0, hlo_id=68))
v363 = m0.OffloadedConcat(srcs=[v127, v137, ], dsts=[v126], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=338, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.2", line=0, column=0, hlo_id=70))
v365 = m0.Tensor(name="get_tuple_element.18", shape=(1,16,912,912), parent=v0, id=339, dtype="uint8", view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v366 = m0.Tensor(name="custom_call.25", shape=(2,), parent=v0, id=340, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v364 = m8.NeuronTensorOp(srcs=[v2, v126], dsts=[v365, v366], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=341, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.1", line=0, column=0, hlo_id=411))
v367 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v368 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v367)
v369 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v368)
v370 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v369)
v371a = m0.AffineAccess(tensor=v124, addrs=[])
v371 = m0.AffineLoad(src=v371a, predicates=[], id=342, parent=v370, dl=m1.DebugLocation(tensor_op_name="_broadcast.64354", line=0, column=0, hlo_id=86))
v372a = m0.AffineAccess(tensor=v125, addrs=[v367, v368, v369, v370])
v372 = m0.AffineStore(dst=v372a, src=v371, predicates=[], id=343, parent=v370, dl=m1.DebugLocation(tensor_op_name="_broadcast.64354", line=0, column=0, hlo_id=86))
v374 = m0.Tensor(name="select.54", shape=(1,16,912,912), parent=v0, id=344, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v373 = m0.TernaryTensorOp(srcs=[v365, v130, v125], dsts=[v374], op=np.select, id=345, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4927", line=0, column=0, hlo_id=87))
v376 = m0.Tensor(name="subtract.20", shape=(1,16,912,912), parent=v0, id=346, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v375 = m8.NeuronTensorOp(srcs=[v130, v374], dsts=[v376], op=np.subtract, xla_op='mhlo.binary', id=347, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.37", line=0, column=0, hlo_id=88))
v377 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v378 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v377)
v379 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v378)
v380 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v379)
v381a = m0.AffineAccess(tensor=v122, addrs=[])
v381 = m0.AffineLoad(src=v381a, predicates=[], id=348, parent=v380, dl=m1.DebugLocation(tensor_op_name="_convert.38", line=0, column=0, hlo_id=89))
v382a = m0.AffineAccess(tensor=v123, addrs=[v377, v378, v379, v380])
v382 = m0.AffineStore(dst=v382a, src=v381, predicates=[], id=349, parent=v380, dl=m1.DebugLocation(tensor_op_name="_convert.38", line=0, column=0, hlo_id=89))
v384 = m0.Tensor(name="compare.38", shape=(1,16,912,912), parent=v0, id=350, dtype="uint8", view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v383 = m8.NeuronTensorOp(srcs=[v376, v123], dsts=[v384], op=np.not_equal, xla_op='mhlo.binary', id=351, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.38", line=0, column=0, hlo_id=89))
v385 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v386 = m0.Axis(lb=0, ub=1, stride=1, it="j", parent=v385)
v387 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v386)
v388 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v387)
v389a = m0.AffineAccess(tensor=v119, addrs=[])
v389 = m0.AffineLoad(src=v389a, predicates=[], id=352, parent=v388, dl=m1.DebugLocation(tensor_op_name="_broadcast.762", line=0, column=0, hlo_id=99))
v390a = m0.AffineAccess(tensor=v120, addrs=[v385, v386, v387, v388])
v390 = m0.AffineStore(dst=v390a, src=v389, predicates=[], id=353, parent=v388, dl=m1.DebugLocation(tensor_op_name="_broadcast.762", line=0, column=0, hlo_id=99))
v392 = m0.Tensor(name="compare.39", shape=(1,1,912,912), parent=v0, id=354, dtype="uint8", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v391 = m8.NeuronTensorOp(srcs=[v213, v120], dsts=[v392], op=np.not_equal, xla_op='mhlo.binary', id=355, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.52", line=0, column=0, hlo_id=100))
v394 = m0.Tensor(name="not.5", shape=(1,1,912,912), parent=v0, id=356, dtype="uint8", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v393 = m8.NeuronTensorOp(srcs=[v392], dsts=[v394], op=np.logical_not, xla_op='mhlo.unary', id=357, parent=v0, dl=m1.DebugLocation(tensor_op_name="_not", line=0, column=0, hlo_id=101))
v395 = m0.OffloadedMemCpy(srcs=[v394], dsts=[v118], dtype="uint8", id=358, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.95686", line=0, column=0, hlo_id=102))
v397 = m0.Tensor(name="broadcast_in_dim.116", shape=(1,16,912,912), parent=v0, id=359, dtype="uint8", view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v396 = m8.NeuronTensorOp(srcs=[v118], dsts=[v397], xla_op='mhlo.broadcast_in_dim', bcdims=[2, 3], id=360, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.64356", line=0, column=0, hlo_id=103))
v398 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v399 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v398)
v400 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v399)
v401 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v400)
v402a = m0.AffineAccess(tensor=v115, addrs=[])
v402 = m0.AffineLoad(src=v402a, predicates=[], id=361, parent=v401, dl=m1.DebugLocation(tensor_op_name="_broadcast.848", line=0, column=0, hlo_id=109))
v403a = m0.AffineAccess(tensor=v116, addrs=[v398, v399, v400, v401])
v403 = m0.AffineStore(dst=v403a, src=v402, predicates=[], id=362, parent=v401, dl=m1.DebugLocation(tensor_op_name="_broadcast.848", line=0, column=0, hlo_id=109))
v404 = m0.OffloadedMemCast(srcs=[v194], dsts=[v114], dtype="uint32", id=363, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.16", line=0, column=0, hlo_id=112))
v405 = m0.OffloadedMemCpy(srcs=[v114], dsts=[v113], dtype="uint32", id=364, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.532", line=0, column=0, hlo_id=113))
v406 = m0.OffloadedConcat(srcs=[v113, v137, ], dsts=[v112], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=365, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate", line=0, column=0, hlo_id=115))
v408 = m0.Tensor(name="get_tuple_element.19", shape=(1,912,1024), parent=v0, id=366, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v409 = m0.Tensor(name="custom_call.26", shape=(2,), parent=v0, id=367, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v407 = m8.NeuronTensorOp(srcs=[v2, v112], dsts=[v408, v409], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=368, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.2", line=0, column=0, hlo_id=414))
v411 = m0.Tensor(name="select.55", shape=(1,912,1024), parent=v0, id=369, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v410 = m0.TernaryTensorOp(srcs=[v408, v141, v134], dsts=[v411], op=np.select, id=370, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4928", line=0, column=0, hlo_id=132))
v413 = m0.Tensor(name="subtract.21", shape=(1,912,1024), parent=v0, id=371, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v412 = m8.NeuronTensorOp(srcs=[v141, v411], dsts=[v413], op=np.subtract, xla_op='mhlo.binary', id=372, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.33", line=0, column=0, hlo_id=133))
v414 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v415 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v414)
v416 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v415)
v417a = m0.AffineAccess(tensor=v110, addrs=[])
v417 = m0.AffineLoad(src=v417a, predicates=[], id=373, parent=v416, dl=m1.DebugLocation(tensor_op_name="_convert.22", line=0, column=0, hlo_id=134))
v418a = m0.AffineAccess(tensor=v111, addrs=[v414, v415, v416])
v418 = m0.AffineStore(dst=v418a, src=v417, predicates=[], id=374, parent=v416, dl=m1.DebugLocation(tensor_op_name="_convert.22", line=0, column=0, hlo_id=134))
v420 = m0.Tensor(name="compare.40", shape=(1,912,1024), parent=v0, id=375, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v419 = m8.NeuronTensorOp(srcs=[v413, v111], dsts=[v420], op=np.not_equal, xla_op='mhlo.binary', id=376, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.22", line=0, column=0, hlo_id=134))
v422 = m0.Tensor(name="broadcast_in_dim.117", shape=(1,912,1024), parent=v0, id=377, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v421 = m8.NeuronTensorOp(srcs=[v4], dsts=[v422], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=378, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.727", line=0, column=0, hlo_id=139))
v423 = m0.OffloadedMemCast(srcs=[v169], dsts=[v109], dtype="uint32", id=379, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.12673", line=0, column=0, hlo_id=143))
v424 = m0.OffloadedMemCpy(srcs=[v109], dsts=[v108], dtype="uint32", id=380, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.89581", line=0, column=0, hlo_id=144))
v425 = m0.OffloadedMemCpy(srcs=[v108], dsts=[v106], dtype="uint32", id=381, parent=v0, dl=m1.DebugLocation(tensor_op_name="_gather", line=0, column=0, hlo_id=145))
v426 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v427 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v426)
v428a = m0.AffineAccess(tensor=v108, addrs=[v426])
v428 = m0.AffineLoad(src=v428a, predicates=[], id=382, parent=v427, dl=m1.DebugLocation(tensor_op_name="_gather", line=0, column=0, hlo_id=145))
v429a = m0.GenericAccess(tensor=v5, addrs=[v428, v427])
v429 = m0.GenericLoad(src=v429a, predicates=[], id=383, parent=v427, dl=m1.DebugLocation(tensor_op_name="_gather", line=0, column=0, hlo_id=145))
v430a = m0.AffineAccess(tensor=v107, addrs=[v426, v427])
v430 = m0.AffineStore(dst=v430a, src=v429, predicates=[], id=384, parent=v427, dl=m1.DebugLocation(tensor_op_name="_gather", line=0, column=0, hlo_id=145))
v431 = m0.OffloadedMemCpy(srcs=[v107], dsts=[v105], dtype=m7.dtype.bfloat16, id=385, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.548", line=0, column=0, hlo_id=146))
v432 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v433a = m0.AffineAccess(tensor=v103, addrs=[])
v433 = m0.AffineLoad(src=v433a, predicates=[], id=386, parent=v432, dl=m1.DebugLocation(tensor_op_name="_broadcast.723", line=0, column=0, hlo_id=148))
v434a = m0.AffineAccess(tensor=v104, addrs=[v432])
v434 = m0.AffineStore(dst=v434a, src=v433, predicates=[], id=387, parent=v432, dl=m1.DebugLocation(tensor_op_name="_broadcast.723", line=0, column=0, hlo_id=148))
v435 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v436a = m0.AffineAccess(tensor=v101, addrs=[])
v436 = m0.AffineLoad(src=v436a, predicates=[], id=388, parent=v435, dl=m1.DebugLocation(tensor_op_name="_broadcast.721", line=0, column=0, hlo_id=150))
v437a = m0.AffineAccess(tensor=v102, addrs=[v435])
v437 = m0.AffineStore(dst=v437a, src=v436, predicates=[], id=389, parent=v435, dl=m1.DebugLocation(tensor_op_name="_broadcast.721", line=0, column=0, hlo_id=150))
v438 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v439 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v438)
v440 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v439)
v441a = m0.AffineAccess(tensor=v107, addrs=[v439, v440])
v441 = m0.AffineLoad(src=v441a, predicates=[], id=390, parent=v440, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v442_v443 = m0.BatchNormMeanVarOp(data=v441, reduce_axes=[v438, v440], id=391, parent=v440, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v442 = m0.ExtractValue(src=v442_v443, idxes=[0], id=392, parent=v440, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v443 = m0.ExtractValue(src=v442_v443, idxes=[1], id=393, parent=v440, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v444a = m0.AffineAccess(tensor=v99, addrs=[v439, 0])
v444 = m0.AffineStore(dst=v444a, src=v442, predicates=[], id=394, parent=v440, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v445a = m0.AffineAccess(tensor=v99, addrs=[v439, 1])
v445 = m0.AffineStore(dst=v445a, src=v443, predicates=[], id=395, parent=v440, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v446 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v447 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v446)
v448 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v447)
v449a = m0.AffineAccess(tensor=v107, addrs=[v447, v448])
v449 = m0.AffineLoad(src=v449a, predicates=[], id=396, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v450a = m0.AffineAccess(tensor=v104, addrs=[v447])
v450 = m0.AffineLoad(src=v450a, predicates=[], id=397, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v451a = m0.AffineAccess(tensor=v102, addrs=[v447])
v451 = m0.AffineLoad(src=v451a, predicates=[], id=398, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v452a = m0.AffineAccess(tensor=v96, addrs=[])
v452 = m0.AffineLoad(src=v452a, predicates=[], id=399, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v453a = m0.AffineAccess(tensor=v99, addrs=[v447, 0])
v453 = m0.AffineLoad(src=v453a, predicates=[], id=400, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v454a = m0.AffineAccess(tensor=v99, addrs=[v447, 1])
v454 = m0.AffineLoad(src=v454a, predicates=[], id=401, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v455 = m0.BinaryOp(lhs=v454, rhs=v452, op=np.add, id=402, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v456 = m0.UnaryOp(data=v455, op=m0.rsqrt, id=403, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v457 = m0.BinaryOp(lhs=v449, rhs=v453, op=np.subtract, id=404, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v458 = m0.BinaryOp(lhs=v450, rhs=v457, op=np.multiply, id=405, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v459 = m0.BinaryOp(lhs=v458, rhs=v456, op=np.multiply, id=406, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v460 = m0.BinaryOp(lhs=v459, rhs=v451, op=np.add, id=407, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v461a = m0.AffineAccess(tensor=v100, addrs=[v446, v447, v448])
v461 = m0.AffineStore(dst=v461a, src=v460, predicates=[], id=408, parent=v448, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v462 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v463a = m0.AffineAccess(tensor=v99, addrs=[v462, 0])
v463 = m0.AffineLoad(src=v463a, predicates=[], id=409, parent=v462, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v464a = m0.AffineAccess(tensor=v98, addrs=[v462])
v464 = m0.AffineStore(dst=v464a, src=v463, predicates=[], id=410, parent=v462, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v465 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v466a = m0.AffineAccess(tensor=v99, addrs=[v465, 1])
v466 = m0.AffineLoad(src=v466a, predicates=[], id=411, parent=v465, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v467a = m0.AffineAccess(tensor=v97, addrs=[v465])
v467 = m0.AffineStore(dst=v467a, src=v466, predicates=[], id=412, parent=v465, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training", line=0, column=0, hlo_id=151))
v469 = m0.Tensor(name="broadcast_in_dim.118", shape=(1,912,1024), parent=v0, id=413, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v468 = m8.NeuronTensorOp(srcs=[v7], dsts=[v469], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=414, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.725", line=0, column=0, hlo_id=155))
v471 = m0.Tensor(name="multiply.1427", shape=(1,912,1024), parent=v0, id=415, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v470 = m8.NeuronTensorOp(srcs=[v100, v469], dsts=[v471], op=np.multiply, xla_op='mhlo.binary', id=416, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1587", line=0, column=0, hlo_id=156))
v473 = m0.Tensor(name="add.1459", shape=(1,912,1024), parent=v0, id=417, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v472 = m8.NeuronTensorOp(srcs=[v422, v471], dsts=[v473], op=np.add, xla_op='mhlo.binary', id=418, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2834", line=0, column=0, hlo_id=157))
v474 = m0.OffloadedMemCast(srcs=[v168], dsts=[v95], dtype=m7.dtype.bfloat16, id=419, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.12672", line=0, column=0, hlo_id=158))
v475 = m0.OffloadedMemCpy(srcs=[v95], dsts=[v94], dtype=m7.dtype.bfloat16, id=420, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.87818", line=0, column=0, hlo_id=159))
v477 = m0.Tensor(name="broadcast_in_dim.119", shape=(1,912,1024), parent=v0, id=421, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v476 = m8.NeuronTensorOp(srcs=[v94], dsts=[v477], xla_op='mhlo.broadcast_in_dim', bcdims=[1], id=422, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.729", line=0, column=0, hlo_id=160))
v479 = m0.Tensor(name="multiply.1428", shape=(1,912,1024), parent=v0, id=423, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v478 = m8.NeuronTensorOp(srcs=[v473, v477], dsts=[v479], op=np.multiply, xla_op='mhlo.binary', id=424, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1588", line=0, column=0, hlo_id=161))
v481 = m0.Tensor(name="select.56", shape=(1,912,1024), parent=v0, id=425, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v480 = m0.TernaryTensorOp(srcs=[v420, v134, v479], dsts=[v481], op=np.select, id=426, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.32", line=0, column=0, hlo_id=162))
v483 = m0.Tensor(name="broadcast_in_dim.120", shape=(1,912,1024), parent=v0, id=427, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v482 = m8.NeuronTensorOp(srcs=[v8], dsts=[v483], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=428, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.732", line=0, column=0, hlo_id=164))
v485 = m0.Tensor(name="multiply.1429", shape=(1,912,1024), parent=v0, id=429, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v484 = m8.NeuronTensorOp(srcs=[v481, v483], dsts=[v485], op=np.multiply, xla_op='mhlo.binary', id=430, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1590", line=0, column=0, hlo_id=165))
v486 = m0.OffloadedMemCpy(srcs=[v485], dsts=[v93], dtype=m7.dtype.bfloat16, id=431, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.650", line=0, column=0, hlo_id=166))
v488 = m0.Tensor(name="transpose.67", shape=(1024,1024), parent=v0, id=432, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v487 = m8.NeuronTensorOp(srcs=[v9], dsts=[v488], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=433, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.12", line=0, column=0, hlo_id=169))
v489 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v490 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v489)
v491 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v490)
v492a = m0.AffineAccess(tensor=v93, addrs=[v489, v491])
v492 = m0.AffineLoad(src=v492a, predicates=[], id=434, parent=v491, dl=m1.DebugLocation(tensor_op_name="_dot.5", line=0, column=0, hlo_id=170))
v493a = m0.AffineAccess(tensor=v488, addrs=[v491, v490])
v493 = m0.AffineLoad(src=v493a, predicates=[], id=435, parent=v491, dl=m1.DebugLocation(tensor_op_name="_dot.5", line=0, column=0, hlo_id=170))
v494 = m0.BinaryOp(lhs=v492, rhs=v493, op=np.multiply, id=436, parent=v491, dl=m1.DebugLocation(tensor_op_name="_dot.5", line=0, column=0, hlo_id=170))
v495 = m0.ReduceOp(data=v494, op=np.add, initial=0.0, reduce_axes=[v491], id=437, parent=v491, dl=m1.DebugLocation(tensor_op_name="_dot.5", line=0, column=0, hlo_id=170))
v496a = m0.AffineAccess(tensor=v92, addrs=[v489, v490])
v496 = m0.AffineStore(dst=v496a, src=v495, predicates=[], id=438, parent=v491, dl=m1.DebugLocation(tensor_op_name="_dot.5", line=0, column=0, hlo_id=170))
v497 = m0.OffloadedMemCpy(srcs=[v92], dsts=[v91], dtype=m7.dtype.bfloat16, id=439, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.651", line=0, column=0, hlo_id=171))
v499 = m0.Tensor(name="broadcast_in_dim.121", shape=(1,912,1024), parent=v0, id=440, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v498 = m8.NeuronTensorOp(srcs=[v10], dsts=[v499], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=441, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.839", line=0, column=0, hlo_id=174))
v501 = m0.Tensor(name="add.1460", shape=(1,912,1024), parent=v0, id=442, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v500 = m8.NeuronTensorOp(srcs=[v91, v499], dsts=[v501], op=np.add, xla_op='mhlo.binary', id=443, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2850", line=0, column=0, hlo_id=175))
v502 = m0.OffloadedMemCpy(srcs=[v501], dsts=[v90], dtype=m7.dtype.bfloat16, id=444, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.654", line=0, column=0, hlo_id=176))
v504 = m0.Tensor(name="transpose.68", shape=(1,16,912,64), parent=v0, id=445, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v503 = m8.NeuronTensorOp(srcs=[v90], dsts=[v504], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=446, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.13", line=0, column=0, hlo_id=177))
v505 = m0.OffloadedMemCpy(srcs=[v504], dsts=[v89], dtype=m7.dtype.bfloat16, id=447, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.655", line=0, column=0, hlo_id=178))
v507 = m0.Tensor(name="transpose.69", shape=(1024,1024), parent=v0, id=448, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v506 = m8.NeuronTensorOp(srcs=[v11], dsts=[v507], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=449, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.6", line=0, column=0, hlo_id=182))
v508 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v509 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v508)
v510 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v509)
v511a = m0.AffineAccess(tensor=v93, addrs=[v508, v510])
v511 = m0.AffineLoad(src=v511a, predicates=[], id=450, parent=v510, dl=m1.DebugLocation(tensor_op_name="_dot.2", line=0, column=0, hlo_id=183))
v512a = m0.AffineAccess(tensor=v507, addrs=[v510, v509])
v512 = m0.AffineLoad(src=v512a, predicates=[], id=451, parent=v510, dl=m1.DebugLocation(tensor_op_name="_dot.2", line=0, column=0, hlo_id=183))
v513 = m0.BinaryOp(lhs=v511, rhs=v512, op=np.multiply, id=452, parent=v510, dl=m1.DebugLocation(tensor_op_name="_dot.2", line=0, column=0, hlo_id=183))
v514 = m0.ReduceOp(data=v513, op=np.add, initial=0.0, reduce_axes=[v510], id=453, parent=v510, dl=m1.DebugLocation(tensor_op_name="_dot.2", line=0, column=0, hlo_id=183))
v515a = m0.AffineAccess(tensor=v88, addrs=[v508, v509])
v515 = m0.AffineStore(dst=v515a, src=v514, predicates=[], id=454, parent=v510, dl=m1.DebugLocation(tensor_op_name="_dot.2", line=0, column=0, hlo_id=183))
v516 = m0.OffloadedMemCpy(srcs=[v88], dsts=[v87], dtype=m7.dtype.bfloat16, id=455, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.632", line=0, column=0, hlo_id=184))
v518 = m0.Tensor(name="broadcast_in_dim.122", shape=(1,912,1024), parent=v0, id=456, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v517 = m8.NeuronTensorOp(srcs=[v12], dsts=[v518], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=457, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.824", line=0, column=0, hlo_id=187))
v520 = m0.Tensor(name="add.1461", shape=(1,912,1024), parent=v0, id=458, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v519 = m8.NeuronTensorOp(srcs=[v87, v518], dsts=[v520], op=np.add, xla_op='mhlo.binary', id=459, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2847", line=0, column=0, hlo_id=188))
v522 = m0.Tensor(name="broadcast_in_dim.123", shape=(1,912,1024), parent=v0, id=460, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v521 = m8.NeuronTensorOp(srcs=[v13], dsts=[v522], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=461, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.72238", line=0, column=0, hlo_id=190))
v524 = m0.Tensor(name="divide.17", shape=(1,912,1024), parent=v0, id=462, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v523 = m8.NeuronTensorOp(srcs=[v520, v522], dsts=[v524], op=np.divide, xla_op='mhlo.binary', id=463, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.3360", line=0, column=0, hlo_id=191))
v525 = m0.OffloadedMemCpy(srcs=[v524], dsts=[v86], dtype=m7.dtype.bfloat16, id=464, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.100604", line=0, column=0, hlo_id=192))
v527 = m0.Tensor(name="transpose.70", shape=(1,16,912,64), parent=v0, id=465, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v526 = m8.NeuronTensorOp(srcs=[v86], dsts=[v527], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=466, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.9440", line=0, column=0, hlo_id=193))
v528 = m0.OffloadedMemCpy(srcs=[v527], dsts=[v85], dtype=m7.dtype.bfloat16, id=467, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.96540", line=0, column=0, hlo_id=194))
v530 = m0.Tensor(name="transpose.71", shape=(16,64,912), parent=v0, id=468, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,912), layout="NHC", transpose=(0,1,2)), )
v529 = m8.NeuronTensorOp(srcs=[v85], dsts=[v530], xla_op='mhlo.transpose', src_shape=(16,912,64), permutation=(0,2,1), id=469, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.8609", line=0, column=0, hlo_id=195))
v531 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v532 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v531)
v533 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v532)
v534 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v533)
v535a = m0.AffineAccess(tensor=v89, addrs=[v531, v532, v534])
v535 = m0.AffineLoad(src=v535a, predicates=[], id=470, parent=v534, dl=m1.DebugLocation(tensor_op_name="_dot.7", line=0, column=0, hlo_id=196))
v536a = m0.AffineAccess(tensor=v530, addrs=[v531, v534, v533])
v536 = m0.AffineLoad(src=v536a, predicates=[], id=471, parent=v534, dl=m1.DebugLocation(tensor_op_name="_dot.7", line=0, column=0, hlo_id=196))
v537 = m0.BinaryOp(lhs=v535, rhs=v536, op=np.multiply, id=472, parent=v534, dl=m1.DebugLocation(tensor_op_name="_dot.7", line=0, column=0, hlo_id=196))
v538 = m0.ReduceOp(data=v537, op=np.add, initial=0.0, reduce_axes=[v534], id=473, parent=v534, dl=m1.DebugLocation(tensor_op_name="_dot.7", line=0, column=0, hlo_id=196))
v539a = m0.AffineAccess(tensor=v84, addrs=[v531, v532, v533])
v539 = m0.AffineStore(dst=v539a, src=v538, predicates=[], id=474, parent=v534, dl=m1.DebugLocation(tensor_op_name="_dot.7", line=0, column=0, hlo_id=196))
v540 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v541 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v540)
v542a = m0.AffineAccess(tensor=v82, addrs=[])
v542 = m0.AffineLoad(src=v542a, predicates=[], id=475, parent=v541, dl=m1.DebugLocation(tensor_op_name="_broadcast.69167", line=0, column=0, hlo_id=198))
v543a = m0.AffineAccess(tensor=v83, addrs=[v540, v541])
v543 = m0.AffineStore(dst=v543a, src=v542, predicates=[], id=476, parent=v541, dl=m1.DebugLocation(tensor_op_name="_broadcast.69167", line=0, column=0, hlo_id=198))
v545 = m0.Tensor(name="broadcast_in_dim.124", shape=(912,912), parent=v0, id=477, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v544 = m8.NeuronTensorOp(srcs=[v173], dsts=[v545], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=478, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.64672", line=0, column=0, hlo_id=240))
v547 = m0.Tensor(name="add.1462", shape=(912,912), parent=v0, id=479, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v546 = m8.NeuronTensorOp(srcs=[v155, v545], dsts=[v547], op=np.add, xla_op='mhlo.binary', id=480, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.13056", line=0, column=0, hlo_id=241))
v549 = m0.Tensor(name="broadcast_in_dim.125", shape=(912,912), parent=v0, id=481, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v548 = m8.NeuronTensorOp(srcs=[v174], dsts=[v549], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=482, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.69168", line=0, column=0, hlo_id=243))
v550 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v551 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v550)
v552a = m0.AffineAccess(tensor=v83, addrs=[v550, v551])
v552 = m0.AffineLoad(src=v552a, predicates=[], id=483, parent=v551, dl=m1.DebugLocation(tensor_op_name="_clamp.768", line=0, column=0, hlo_id=244))
v553a = m0.AffineAccess(tensor=v549, addrs=[v550, v551])
v553 = m0.AffineLoad(src=v553a, predicates=[], id=484, parent=v551, dl=m1.DebugLocation(tensor_op_name="_clamp.768", line=0, column=0, hlo_id=244))
v554a = m0.AffineAccess(tensor=v547, addrs=[v550, v551])
v554 = m0.AffineLoad(src=v554a, predicates=[], id=485, parent=v551, dl=m1.DebugLocation(tensor_op_name="_clamp.768", line=0, column=0, hlo_id=244))
v555 = m0.BinaryOp(lhs=v552, rhs=v554, op=np.maximum, id=486, parent=v551, dl=m1.DebugLocation(tensor_op_name="_clamp.768", line=0, column=0, hlo_id=244))
v556 = m0.BinaryOp(lhs=v553, rhs=v555, op=np.minimum, id=487, parent=v551, dl=m1.DebugLocation(tensor_op_name="_clamp.768", line=0, column=0, hlo_id=244))
v557a = m0.AffineAccess(tensor=v81, addrs=[v550, v551])
v557 = m0.AffineStore(dst=v557a, src=v556, predicates=[], id=488, parent=v551, dl=m1.DebugLocation(tensor_op_name="_clamp.768", line=0, column=0, hlo_id=244))
v558 = m0.OffloadedMemCast(srcs=[v81], dsts=[v80], dtype="uint32", id=489, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.14458", line=0, column=0, hlo_id=245))
v560 = m0.Tensor(name="broadcast_in_dim.126", shape=(16,912,512,912), parent=v0, id=490, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v559 = m8.NeuronTensorOp(srcs=[v80], dsts=[v560], xla_op='mhlo.broadcast_in_dim', bcdims=[1, 3], id=491, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.840", line=0, column=0, hlo_id=246))
v562 = m0.Tensor(name="iota.13", shape=(16,912,512,912), parent=v0, id=492, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v561 = m0.IotaTensorOp(srcs=[], dsts=[v562], op=m0.iota, shape=(16,912,512,912), iota_dim=2, dtype="uint32", id=493, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.33", line=0, column=0, hlo_id=247))
v564 = m0.Tensor(name="compare.41", shape=(16,912,512,912), parent=v0, id=494, dtype="uint8", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v563 = m8.NeuronTensorOp(srcs=[v560, v562], dsts=[v564], op=np.equal, xla_op='mhlo.binary', id=495, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.60", line=0, column=0, hlo_id=248))
v565 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v566 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v565)
v567a = m0.AffineAccess(tensor=v78, addrs=[])
v567 = m0.AffineLoad(src=v567a, predicates=[], id=496, parent=v566, dl=m1.DebugLocation(tensor_op_name="_broadcast.805", line=0, column=0, hlo_id=250))
v568a = m0.AffineAccess(tensor=v79, addrs=[v565, v566])
v568 = m0.AffineStore(dst=v568a, src=v567, predicates=[], id=497, parent=v566, dl=m1.DebugLocation(tensor_op_name="_broadcast.805", line=0, column=0, hlo_id=250))
v569 = m0.OffloadedMemCast(srcs=[v198], dsts=[v77], dtype="uint32", id=498, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.47", line=0, column=0, hlo_id=251))
v570 = m0.OffloadedMemCpy(srcs=[v77], dsts=[v76], dtype="uint32", id=499, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.606", line=0, column=0, hlo_id=252))
v571 = m0.OffloadedConcat(srcs=[v76, v137, ], dsts=[v75], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=500, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.3", line=0, column=0, hlo_id=254))
v573 = m0.Tensor(name="get_tuple_element.20", shape=(512,1024), parent=v0, id=501, dtype="uint8", view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v574 = m0.Tensor(name="custom_call.27", shape=(2,), parent=v0, id=502, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v572 = m8.NeuronTensorOp(srcs=[v2, v75], dsts=[v573, v574], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=503, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.3", line=0, column=0, hlo_id=417))
v575 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v576 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v575)
v577a = m0.AffineAccess(tensor=v73, addrs=[])
v577 = m0.AffineLoad(src=v577a, predicates=[], id=504, parent=v576, dl=m1.DebugLocation(tensor_op_name="_broadcast.64370", line=0, column=0, hlo_id=270))
v578a = m0.AffineAccess(tensor=v74, addrs=[v575, v576])
v578 = m0.AffineStore(dst=v578a, src=v577, predicates=[], id=505, parent=v576, dl=m1.DebugLocation(tensor_op_name="_broadcast.64370", line=0, column=0, hlo_id=270))
v580 = m0.Tensor(name="select.57", shape=(512,1024), parent=v0, id=506, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v579 = m0.TernaryTensorOp(srcs=[v573, v79, v74], dsts=[v580], op=np.select, id=507, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4929", line=0, column=0, hlo_id=271))
v582 = m0.Tensor(name="subtract.22", shape=(512,1024), parent=v0, id=508, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v581 = m8.NeuronTensorOp(srcs=[v79, v580], dsts=[v582], op=np.subtract, xla_op='mhlo.binary', id=509, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.40", line=0, column=0, hlo_id=272))
v583 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v584 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v583)
v585a = m0.AffineAccess(tensor=v71, addrs=[])
v585 = m0.AffineLoad(src=v585a, predicates=[], id=510, parent=v584, dl=m1.DebugLocation(tensor_op_name="_convert.53", line=0, column=0, hlo_id=273))
v586a = m0.AffineAccess(tensor=v72, addrs=[v583, v584])
v586 = m0.AffineStore(dst=v586a, src=v585, predicates=[], id=511, parent=v584, dl=m1.DebugLocation(tensor_op_name="_convert.53", line=0, column=0, hlo_id=273))
v588 = m0.Tensor(name="compare.42", shape=(512,1024), parent=v0, id=512, dtype="uint8", view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v587 = m8.NeuronTensorOp(srcs=[v582, v72], dsts=[v588], op=np.not_equal, xla_op='mhlo.binary', id=513, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.53", line=0, column=0, hlo_id=273))
v590 = m0.Tensor(name="select.58", shape=(512,1024), parent=v0, id=514, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v589 = m0.TernaryTensorOp(srcs=[v588, v74, v322], dsts=[v590], op=np.select, id=515, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.36", line=0, column=0, hlo_id=293))
v592 = m0.Tensor(name="broadcast_in_dim.127", shape=(512,1024), parent=v0, id=516, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v591 = m8.NeuronTensorOp(srcs=[v8], dsts=[v592], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=517, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.820", line=0, column=0, hlo_id=294))
v594 = m0.Tensor(name="multiply.1430", shape=(512,1024), parent=v0, id=518, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v593 = m8.NeuronTensorOp(srcs=[v590, v592], dsts=[v594], op=np.multiply, xla_op='mhlo.binary', id=519, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1614", line=0, column=0, hlo_id=295))
v595 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v596 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v595)
v597 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v596)
v598a = m0.AffineAccess(tensor=v594, addrs=[v595, v597])
v598 = m0.AffineLoad(src=v598a, predicates=[], id=520, parent=v597, dl=m1.DebugLocation(tensor_op_name="_dot.4", line=0, column=0, hlo_id=298))
v599a = m0.AffineAccess(tensor=v507, addrs=[v597, v596])
v599 = m0.AffineLoad(src=v599a, predicates=[], id=521, parent=v597, dl=m1.DebugLocation(tensor_op_name="_dot.4", line=0, column=0, hlo_id=298))
v600 = m0.BinaryOp(lhs=v598, rhs=v599, op=np.multiply, id=522, parent=v597, dl=m1.DebugLocation(tensor_op_name="_dot.4", line=0, column=0, hlo_id=298))
v601 = m0.ReduceOp(data=v600, op=np.add, initial=0.0, reduce_axes=[v597], id=523, parent=v597, dl=m1.DebugLocation(tensor_op_name="_dot.4", line=0, column=0, hlo_id=298))
v602a = m0.AffineAccess(tensor=v70, addrs=[v595, v596])
v602 = m0.AffineStore(dst=v602a, src=v601, predicates=[], id=524, parent=v597, dl=m1.DebugLocation(tensor_op_name="_dot.4", line=0, column=0, hlo_id=298))
v603 = m0.OffloadedMemCpy(srcs=[v70], dsts=[v69], dtype=m7.dtype.bfloat16, id=525, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.643", line=0, column=0, hlo_id=299))
v605 = m0.Tensor(name="broadcast_in_dim.128", shape=(1,512,1024), parent=v0, id=526, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v604 = m8.NeuronTensorOp(srcs=[v12], dsts=[v605], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=527, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.836", line=0, column=0, hlo_id=301))
v607 = m0.Tensor(name="add.1463", shape=(1,512,1024), parent=v0, id=528, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v606 = m8.NeuronTensorOp(srcs=[v69, v605], dsts=[v607], op=np.add, xla_op='mhlo.binary', id=529, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2849", line=0, column=0, hlo_id=302))
v608 = m0.OffloadedMemCpy(srcs=[v607], dsts=[v68], dtype=m7.dtype.bfloat16, id=530, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.646", line=0, column=0, hlo_id=303))
v610 = m0.Tensor(name="transpose.72", shape=(1,16,512,64), parent=v0, id=531, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,512,64), layout="NHWC", transpose=(0,1,2,3)), )
v609 = m8.NeuronTensorOp(srcs=[v68], dsts=[v610], xla_op='mhlo.transpose', src_shape=(1,512,16,64), permutation=(0,2,1,3), id=532, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.10", line=0, column=0, hlo_id=304))
v611 = m0.OffloadedMemCpy(srcs=[v610], dsts=[v67], dtype=m7.dtype.bfloat16, id=533, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.647", line=0, column=0, hlo_id=305))
v613 = m0.Tensor(name="transpose.73", shape=(16,64,512), parent=v0, id=534, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,512), layout="NHC", transpose=(0,1,2)), )
v612 = m8.NeuronTensorOp(srcs=[v67], dsts=[v613], xla_op='mhlo.transpose', src_shape=(16,512,64), permutation=(0,2,1), id=535, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.11", line=0, column=0, hlo_id=306))
v614 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v615 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v614)
v616 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v615)
v617 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v616)
v618a = m0.AffineAccess(tensor=v89, addrs=[v614, v615, v617])
v618 = m0.AffineLoad(src=v618a, predicates=[], id=536, parent=v617, dl=m1.DebugLocation(tensor_op_name="_dot.6", line=0, column=0, hlo_id=307))
v619a = m0.AffineAccess(tensor=v613, addrs=[v614, v617, v616])
v619 = m0.AffineLoad(src=v619a, predicates=[], id=537, parent=v617, dl=m1.DebugLocation(tensor_op_name="_dot.6", line=0, column=0, hlo_id=307))
v620 = m0.BinaryOp(lhs=v618, rhs=v619, op=np.multiply, id=538, parent=v617, dl=m1.DebugLocation(tensor_op_name="_dot.6", line=0, column=0, hlo_id=307))
v621 = m0.ReduceOp(data=v620, op=np.add, initial=0.0, reduce_axes=[v617], id=539, parent=v617, dl=m1.DebugLocation(tensor_op_name="_dot.6", line=0, column=0, hlo_id=307))
v622a = m0.AffineAccess(tensor=v66, addrs=[v614, v615, v616])
v622 = m0.AffineStore(dst=v622a, src=v621, predicates=[], id=540, parent=v617, dl=m1.DebugLocation(tensor_op_name="_dot.6", line=0, column=0, hlo_id=307))
v624 = m0.Tensor(name="broadcast_in_dim.129", shape=(16,912,512,912), parent=v0, id=541, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v623 = m8.NeuronTensorOp(srcs=[v66], dsts=[v624], xla_op='mhlo.broadcast_in_dim', bcdims=[0, 1, 2], id=542, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.842", line=0, column=0, hlo_id=308))
v625 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v626 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v625)
v627 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v626)
v628 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v627)
v629a = m0.AffineAccess(tensor=v64, addrs=[])
v629 = m0.AffineLoad(src=v629a, predicates=[], id=543, parent=v628, dl=m1.DebugLocation(tensor_op_name="_broadcast.841", line=0, column=0, hlo_id=310))
v630a = m0.AffineAccess(tensor=v65, addrs=[v625, v626, v627, v628])
v630 = m0.AffineStore(dst=v630a, src=v629, predicates=[], id=544, parent=v628, dl=m1.DebugLocation(tensor_op_name="_broadcast.841", line=0, column=0, hlo_id=310))
v632 = m0.Tensor(name="select.59", shape=(16,912,512,912), parent=v0, id=545, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v631 = m0.TernaryTensorOp(srcs=[v564, v624, v65], dsts=[v632], op=np.select, id=546, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.38", line=0, column=0, hlo_id=311))
v634 = m0.Tensor(name="reduce.9", shape=(16,912,912), parent=v0, id=547, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v633 = m0.ReduceTensorOp(srcs=[v632], dsts=[v634], op=np.add, init_value=0.0, reduce_dims=[2,], id=548, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reduce.97", line=0, column=0, hlo_id=313))
v636 = m0.Tensor(name="broadcast_in_dim.130", shape=(16,912,912), parent=v0, id=549, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v635 = m8.NeuronTensorOp(srcs=[v13], dsts=[v636], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=550, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.843", line=0, column=0, hlo_id=314))
v638 = m0.Tensor(name="divide.18", shape=(16,912,912), parent=v0, id=551, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v637 = m8.NeuronTensorOp(srcs=[v634, v636], dsts=[v638], op=np.divide, xla_op='mhlo.binary', id=552, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.35", line=0, column=0, hlo_id=315))
v640 = m0.Tensor(name="negate.5", shape=(912,912), parent=v0, id=553, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v639 = m8.NeuronTensorOp(srcs=[v155], dsts=[v640], op=np.negative, xla_op='mhlo.unary', id=554, parent=v0, dl=m1.DebugLocation(tensor_op_name="_negate.480", line=0, column=0, hlo_id=318))
v642 = m0.Tensor(name="add.1464", shape=(912,912), parent=v0, id=555, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v641 = m8.NeuronTensorOp(srcs=[v640, v545], dsts=[v642], op=np.add, xla_op='mhlo.binary', id=556, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.13440", line=0, column=0, hlo_id=320))
v643 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v644 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v643)
v645a = m0.AffineAccess(tensor=v83, addrs=[v643, v644])
v645 = m0.AffineLoad(src=v645a, predicates=[], id=557, parent=v644, dl=m1.DebugLocation(tensor_op_name="_clamp.1152", line=0, column=0, hlo_id=322))
v646a = m0.AffineAccess(tensor=v549, addrs=[v643, v644])
v646 = m0.AffineLoad(src=v646a, predicates=[], id=558, parent=v644, dl=m1.DebugLocation(tensor_op_name="_clamp.1152", line=0, column=0, hlo_id=322))
v647a = m0.AffineAccess(tensor=v642, addrs=[v643, v644])
v647 = m0.AffineLoad(src=v647a, predicates=[], id=559, parent=v644, dl=m1.DebugLocation(tensor_op_name="_clamp.1152", line=0, column=0, hlo_id=322))
v648 = m0.BinaryOp(lhs=v645, rhs=v647, op=np.maximum, id=560, parent=v644, dl=m1.DebugLocation(tensor_op_name="_clamp.1152", line=0, column=0, hlo_id=322))
v649 = m0.BinaryOp(lhs=v646, rhs=v648, op=np.minimum, id=561, parent=v644, dl=m1.DebugLocation(tensor_op_name="_clamp.1152", line=0, column=0, hlo_id=322))
v650a = m0.AffineAccess(tensor=v63, addrs=[v643, v644])
v650 = m0.AffineStore(dst=v650a, src=v649, predicates=[], id=562, parent=v644, dl=m1.DebugLocation(tensor_op_name="_clamp.1152", line=0, column=0, hlo_id=322))
v651 = m0.OffloadedMemCast(srcs=[v63], dsts=[v62], dtype="uint32", id=563, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.14810", line=0, column=0, hlo_id=323))
v653 = m0.Tensor(name="broadcast_in_dim.131", shape=(16,912,512,912), parent=v0, id=564, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v652 = m8.NeuronTensorOp(srcs=[v62], dsts=[v653], xla_op='mhlo.broadcast_in_dim', bcdims=[1, 3], id=565, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.825", line=0, column=0, hlo_id=324))
v655 = m0.Tensor(name="iota.14", shape=(16,912,512,912), parent=v0, id=566, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v654 = m0.IotaTensorOp(srcs=[], dsts=[v655], op=m0.iota, shape=(16,912,512,912), iota_dim=2, dtype="uint32", id=567, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.32", line=0, column=0, hlo_id=325))
v657 = m0.Tensor(name="compare.43", shape=(16,912,512,912), parent=v0, id=568, dtype="uint8", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v656 = m8.NeuronTensorOp(srcs=[v653, v655], dsts=[v657], op=np.equal, xla_op='mhlo.binary', id=569, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.59", line=0, column=0, hlo_id=326))
v658 = m0.OffloadedMemCpy(srcs=[v520], dsts=[v61], dtype=m7.dtype.bfloat16, id=570, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.635", line=0, column=0, hlo_id=327))
v660 = m0.Tensor(name="transpose.74", shape=(1,16,912,64), parent=v0, id=571, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v659 = m8.NeuronTensorOp(srcs=[v61], dsts=[v660], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=572, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.7", line=0, column=0, hlo_id=328))
v661 = m0.OffloadedMemCpy(srcs=[v660], dsts=[v60], dtype=m7.dtype.bfloat16, id=573, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.636", line=0, column=0, hlo_id=329))
v662 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v663 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v662)
v664 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v663)
v665a = m0.AffineAccess(tensor=v594, addrs=[v662, v664])
v665 = m0.AffineLoad(src=v665a, predicates=[], id=574, parent=v664, dl=m1.DebugLocation(tensor_op_name="_dot.1", line=0, column=0, hlo_id=332))
v666a = m0.AffineAccess(tensor=v488, addrs=[v664, v663])
v666 = m0.AffineLoad(src=v666a, predicates=[], id=575, parent=v664, dl=m1.DebugLocation(tensor_op_name="_dot.1", line=0, column=0, hlo_id=332))
v667 = m0.BinaryOp(lhs=v665, rhs=v666, op=np.multiply, id=576, parent=v664, dl=m1.DebugLocation(tensor_op_name="_dot.1", line=0, column=0, hlo_id=332))
v668 = m0.ReduceOp(data=v667, op=np.add, initial=0.0, reduce_axes=[v664], id=577, parent=v664, dl=m1.DebugLocation(tensor_op_name="_dot.1", line=0, column=0, hlo_id=332))
v669a = m0.AffineAccess(tensor=v59, addrs=[v662, v663])
v669 = m0.AffineStore(dst=v669a, src=v668, predicates=[], id=578, parent=v664, dl=m1.DebugLocation(tensor_op_name="_dot.1", line=0, column=0, hlo_id=332))
v670 = m0.OffloadedMemCpy(srcs=[v59], dsts=[v58], dtype=m7.dtype.bfloat16, id=579, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.624", line=0, column=0, hlo_id=333))
v672 = m0.Tensor(name="broadcast_in_dim.132", shape=(1,512,1024), parent=v0, id=580, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v671 = m8.NeuronTensorOp(srcs=[v10], dsts=[v672], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=581, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.821", line=0, column=0, hlo_id=335))
v674 = m0.Tensor(name="add.1465", shape=(1,512,1024), parent=v0, id=582, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v673 = m8.NeuronTensorOp(srcs=[v58, v672], dsts=[v674], op=np.add, xla_op='mhlo.binary', id=583, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2846", line=0, column=0, hlo_id=336))
v675 = m0.OffloadedMemCpy(srcs=[v674], dsts=[v57], dtype=m7.dtype.bfloat16, id=584, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.627", line=0, column=0, hlo_id=337))
v677 = m0.Tensor(name="transpose.75", shape=(1,16,512,64), parent=v0, id=585, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,512,64), layout="NHWC", transpose=(0,1,2,3)), )
v676 = m8.NeuronTensorOp(srcs=[v57], dsts=[v677], xla_op='mhlo.transpose', src_shape=(1,512,16,64), permutation=(0,2,1,3), id=586, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.4", line=0, column=0, hlo_id=338))
v678 = m0.OffloadedMemCpy(srcs=[v677], dsts=[v56], dtype=m7.dtype.bfloat16, id=587, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.628", line=0, column=0, hlo_id=339))
v680 = m0.Tensor(name="transpose.76", shape=(16,64,512), parent=v0, id=588, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,512), layout="NHC", transpose=(0,1,2)), )
v679 = m8.NeuronTensorOp(srcs=[v56], dsts=[v680], xla_op='mhlo.transpose', src_shape=(16,512,64), permutation=(0,2,1), id=589, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.5", line=0, column=0, hlo_id=340))
v681 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v682 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v681)
v683 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v682)
v684 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v683)
v685a = m0.AffineAccess(tensor=v60, addrs=[v681, v682, v684])
v685 = m0.AffineLoad(src=v685a, predicates=[], id=590, parent=v684, dl=m1.DebugLocation(tensor_op_name="_dot.3", line=0, column=0, hlo_id=341))
v686a = m0.AffineAccess(tensor=v680, addrs=[v681, v684, v683])
v686 = m0.AffineLoad(src=v686a, predicates=[], id=591, parent=v684, dl=m1.DebugLocation(tensor_op_name="_dot.3", line=0, column=0, hlo_id=341))
v687 = m0.BinaryOp(lhs=v685, rhs=v686, op=np.multiply, id=592, parent=v684, dl=m1.DebugLocation(tensor_op_name="_dot.3", line=0, column=0, hlo_id=341))
v688 = m0.ReduceOp(data=v687, op=np.add, initial=0.0, reduce_axes=[v684], id=593, parent=v684, dl=m1.DebugLocation(tensor_op_name="_dot.3", line=0, column=0, hlo_id=341))
v689a = m0.AffineAccess(tensor=v55, addrs=[v681, v682, v683])
v689 = m0.AffineStore(dst=v689a, src=v688, predicates=[], id=594, parent=v684, dl=m1.DebugLocation(tensor_op_name="_dot.3", line=0, column=0, hlo_id=341))
v691 = m0.Tensor(name="broadcast_in_dim.133", shape=(16,912,512,912), parent=v0, id=595, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v690 = m8.NeuronTensorOp(srcs=[v55], dsts=[v691], xla_op='mhlo.broadcast_in_dim', bcdims=[0, 1, 2], id=596, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.827", line=0, column=0, hlo_id=342))
v693 = m0.Tensor(name="select.60", shape=(16,912,512,912), parent=v0, id=597, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v692 = m0.TernaryTensorOp(srcs=[v657, v691, v65], dsts=[v693], op=np.select, id=598, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.37", line=0, column=0, hlo_id=345))
v695 = m0.Tensor(name="reduce.10", shape=(16,912,912), parent=v0, id=599, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v694 = m0.ReduceTensorOp(srcs=[v693], dsts=[v695], op=np.add, init_value=0.0, reduce_dims=[2,], id=600, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reduce.96", line=0, column=0, hlo_id=347))
v697 = m0.Tensor(name="divide.19", shape=(16,912,912), parent=v0, id=601, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v696 = m8.NeuronTensorOp(srcs=[v695, v636], dsts=[v697], op=np.divide, xla_op='mhlo.binary', id=602, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.1808", line=0, column=0, hlo_id=349))
v699 = m0.Tensor(name="transpose.77", shape=(16,912,912), parent=v0, id=603, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v698 = m8.NeuronTensorOp(srcs=[v697], dsts=[v699], xla_op='mhlo.transpose', src_shape=(16,912,912), permutation=(0,2,1), id=604, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.8608", line=0, column=0, hlo_id=350))
v701 = m0.Tensor(name="add.1466", shape=(16,912,912), parent=v0, id=605, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v700 = m8.NeuronTensorOp(srcs=[v638, v699], dsts=[v701], op=np.add, xla_op='mhlo.binary', id=606, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2852", line=0, column=0, hlo_id=351))
v703 = m0.Tensor(name="add.1467", shape=(16,912,912), parent=v0, id=607, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v702 = m8.NeuronTensorOp(srcs=[v84, v701], dsts=[v703], op=np.add, xla_op='mhlo.binary', id=608, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2853", line=0, column=0, hlo_id=352))
v704 = m0.OffloadedMemCpy(srcs=[v703], dsts=[v54], dtype=m7.dtype.bfloat16, id=609, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.87869", line=0, column=0, hlo_id=353))
v706 = m0.Tensor(name="select.61", shape=(1,16,912,912), parent=v0, id=610, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v705 = m0.TernaryTensorOp(srcs=[v397, v116, v54], dsts=[v706], op=np.select, id=611, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.39", line=0, column=0, hlo_id=354))
v708 = m0.Tensor(name="custom_call.28", shape=(1,16,912,912), parent=v0, id=612, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v707 = m8.NeuronTensorOp(srcs=[v706], dsts=[v708], xla_op="mhlo.custom_call", target_name="AwsNeuronSoftmax", backend_config=3, id=613, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.37", line=0, column=0, hlo_id=365))
v710 = m0.Tensor(name="select.62", shape=(1,16,912,912), parent=v0, id=614, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v709 = m0.TernaryTensorOp(srcs=[v397, v125, v708], dsts=[v710], op=np.select, id=615, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.40", line=0, column=0, hlo_id=366))
v712 = m0.Tensor(name="select.63", shape=(1,16,912,912), parent=v0, id=616, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v711 = m0.TernaryTensorOp(srcs=[v384, v125, v710], dsts=[v712], op=np.select, id=617, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.41", line=0, column=0, hlo_id=367))
v714 = m0.Tensor(name="broadcast_in_dim.134", shape=(1,16,912,912), parent=v0, id=618, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v713 = m8.NeuronTensorOp(srcs=[v8], dsts=[v714], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=619, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.855", line=0, column=0, hlo_id=368))
v716 = m0.Tensor(name="multiply.1431", shape=(1,16,912,912), parent=v0, id=620, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v715 = m8.NeuronTensorOp(srcs=[v712, v714], dsts=[v716], op=np.multiply, xla_op='mhlo.binary', id=621, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1622", line=0, column=0, hlo_id=369))
v717 = m0.OffloadedMemCpy(srcs=[v716], dsts=[v53], dtype=m7.dtype.bfloat16, id=622, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.660", line=0, column=0, hlo_id=370))
v719 = m0.Tensor(name="transpose.78", shape=(1024,1024), parent=v0, id=623, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v718 = m8.NeuronTensorOp(srcs=[v25], dsts=[v719], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=624, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.1", line=0, column=0, hlo_id=374))
v720 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v721 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v720)
v722 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v721)
v723a = m0.AffineAccess(tensor=v93, addrs=[v720, v722])
v723 = m0.AffineLoad(src=v723a, predicates=[], id=625, parent=v722, dl=m1.DebugLocation(tensor_op_name="_dot", line=0, column=0, hlo_id=375))
v724a = m0.AffineAccess(tensor=v719, addrs=[v722, v721])
v724 = m0.AffineLoad(src=v724a, predicates=[], id=626, parent=v722, dl=m1.DebugLocation(tensor_op_name="_dot", line=0, column=0, hlo_id=375))
v725 = m0.BinaryOp(lhs=v723, rhs=v724, op=np.multiply, id=627, parent=v722, dl=m1.DebugLocation(tensor_op_name="_dot", line=0, column=0, hlo_id=375))
v726 = m0.ReduceOp(data=v725, op=np.add, initial=0.0, reduce_axes=[v722], id=628, parent=v722, dl=m1.DebugLocation(tensor_op_name="_dot", line=0, column=0, hlo_id=375))
v727a = m0.AffineAccess(tensor=v52, addrs=[v720, v721])
v727 = m0.AffineStore(dst=v727a, src=v726, predicates=[], id=629, parent=v722, dl=m1.DebugLocation(tensor_op_name="_dot", line=0, column=0, hlo_id=375))
v728 = m0.OffloadedMemCpy(srcs=[v52], dsts=[v51], dtype=m7.dtype.bfloat16, id=630, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.563", line=0, column=0, hlo_id=376))
v730 = m0.Tensor(name="broadcast_in_dim.135", shape=(1,912,1024), parent=v0, id=631, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v729 = m8.NeuronTensorOp(srcs=[v26], dsts=[v730], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=632, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.747", line=0, column=0, hlo_id=379))
v732 = m0.Tensor(name="add.1468", shape=(1,912,1024), parent=v0, id=633, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v731 = m8.NeuronTensorOp(srcs=[v51, v730], dsts=[v732], op=np.add, xla_op='mhlo.binary', id=634, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2839", line=0, column=0, hlo_id=380))
v733 = m0.OffloadedMemCpy(srcs=[v732], dsts=[v50], dtype=m7.dtype.bfloat16, id=635, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.566", line=0, column=0, hlo_id=381))
v735 = m0.Tensor(name="transpose.79", shape=(1,16,912,64), parent=v0, id=636, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v734 = m8.NeuronTensorOp(srcs=[v50], dsts=[v735], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=637, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.2", line=0, column=0, hlo_id=382))
v736 = m0.OffloadedMemCpy(srcs=[v735], dsts=[v49], dtype=m7.dtype.bfloat16, id=638, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.567", line=0, column=0, hlo_id=383))
v737 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v738 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v737)
v739 = m0.Axis(lb=0, ub=64, stride=1, it="k", parent=v738)
v740 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v739)
v741a = m0.AffineAccess(tensor=v53, addrs=[v737, v738, v740])
v741 = m0.AffineLoad(src=v741a, predicates=[], id=639, parent=v740, dl=m1.DebugLocation(tensor_op_name="_dot.8", line=0, column=0, hlo_id=384))
v742a = m0.AffineAccess(tensor=v49, addrs=[v737, v740, v739])
v742 = m0.AffineLoad(src=v742a, predicates=[], id=640, parent=v740, dl=m1.DebugLocation(tensor_op_name="_dot.8", line=0, column=0, hlo_id=384))
v743 = m0.BinaryOp(lhs=v741, rhs=v742, op=np.multiply, id=641, parent=v740, dl=m1.DebugLocation(tensor_op_name="_dot.8", line=0, column=0, hlo_id=384))
v744 = m0.ReduceOp(data=v743, op=np.add, initial=0.0, reduce_axes=[v740], id=642, parent=v740, dl=m1.DebugLocation(tensor_op_name="_dot.8", line=0, column=0, hlo_id=384))
v745a = m0.AffineAccess(tensor=v48, addrs=[v737, v738, v739])
v745 = m0.AffineStore(dst=v745a, src=v744, predicates=[], id=643, parent=v740, dl=m1.DebugLocation(tensor_op_name="_dot.8", line=0, column=0, hlo_id=384))
v746 = m0.OffloadedMemCpy(srcs=[v48], dsts=[v47], dtype=m7.dtype.bfloat16, id=644, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.661", line=0, column=0, hlo_id=385))
v748 = m0.Tensor(name="transpose.80", shape=(1,912,16,64), parent=v0, id=645, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64), layout="NHWC", transpose=(0,1,2,3)), )
v747 = m8.NeuronTensorOp(srcs=[v47], dsts=[v748], xla_op='mhlo.transpose', src_shape=(1,16,912,64), permutation=(0,2,1,3), id=646, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.16", line=0, column=0, hlo_id=386))
v749 = m0.OffloadedMemCpy(srcs=[v748], dsts=[v46], dtype=m7.dtype.bfloat16, id=647, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.663", line=0, column=0, hlo_id=387))
v751 = m0.Tensor(name="transpose.81", shape=(1024,1024), parent=v0, id=648, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v750 = m8.NeuronTensorOp(srcs=[v27], dsts=[v751], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=649, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose", line=0, column=0, hlo_id=390))
v752 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v753 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v752)
v754 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v753)
v755a = m0.AffineAccess(tensor=v46, addrs=[v752, v754])
v755 = m0.AffineLoad(src=v755a, predicates=[], id=650, parent=v754, dl=m1.DebugLocation(tensor_op_name="_dot.9", line=0, column=0, hlo_id=391))
v756a = m0.AffineAccess(tensor=v751, addrs=[v754, v753])
v756 = m0.AffineLoad(src=v756a, predicates=[], id=651, parent=v754, dl=m1.DebugLocation(tensor_op_name="_dot.9", line=0, column=0, hlo_id=391))
v757 = m0.BinaryOp(lhs=v755, rhs=v756, op=np.multiply, id=652, parent=v754, dl=m1.DebugLocation(tensor_op_name="_dot.9", line=0, column=0, hlo_id=391))
v758 = m0.ReduceOp(data=v757, op=np.add, initial=0.0, reduce_axes=[v754], id=653, parent=v754, dl=m1.DebugLocation(tensor_op_name="_dot.9", line=0, column=0, hlo_id=391))
v759a = m0.AffineAccess(tensor=v45, addrs=[v752, v753])
v759 = m0.AffineStore(dst=v759a, src=v758, predicates=[], id=654, parent=v754, dl=m1.DebugLocation(tensor_op_name="_dot.9", line=0, column=0, hlo_id=391))
v760 = m0.OffloadedMemCpy(srcs=[v45], dsts=[v44], dtype=m7.dtype.bfloat16, id=655, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.664", line=0, column=0, hlo_id=392))
v762 = m0.Tensor(name="broadcast_in_dim.136", shape=(1,912,1024), parent=v0, id=656, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v761 = m8.NeuronTensorOp(srcs=[v28], dsts=[v762], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=657, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.856", line=0, column=0, hlo_id=395))
v764 = m0.Tensor(name="add.1469", shape=(1,912,1024), parent=v0, id=658, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v763 = m8.NeuronTensorOp(srcs=[v44, v762], dsts=[v764], op=np.add, xla_op='mhlo.binary', id=659, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2854", line=0, column=0, hlo_id=396))
v766 = m0.Tensor(name="select.64", shape=(1,912,1024), parent=v0, id=660, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v765 = m0.TernaryTensorOp(srcs=[v354, v134, v764], dsts=[v766], op=np.select, id=661, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.42", line=0, column=0, hlo_id=397))
v768 = m0.Tensor(name="multiply.1432", shape=(1,912,1024), parent=v0, id=662, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v767 = m8.NeuronTensorOp(srcs=[v766, v483], dsts=[v768], op=np.multiply, xla_op='mhlo.binary', id=663, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1623", line=0, column=0, hlo_id=399))
v770 = m0.Tensor(name="add.1470", shape=(1,912,1024), parent=v0, id=664, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v769 = m8.NeuronTensorOp(srcs=[v768, v485], dsts=[v770], op=np.add, xla_op='mhlo.binary', id=665, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2855", line=0, column=0, hlo_id=400))
v771 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v772 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v771)
v773 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v772)
v774a = m0.AffineAccess(tensor=v770, addrs=[v771, v772, v773])
v774 = m0.AffineLoad(src=v774a, predicates=[], id=666, parent=v773, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v775_v776 = m0.BatchNormMeanVarOp(data=v774, reduce_axes=[v771, v773], id=667, parent=v773, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v775 = m0.ExtractValue(src=v775_v776, idxes=[0], id=668, parent=v773, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v776 = m0.ExtractValue(src=v775_v776, idxes=[1], id=669, parent=v773, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v777a = m0.AffineAccess(tensor=v42, addrs=[v772, 0])
v777 = m0.AffineStore(dst=v777a, src=v775, predicates=[], id=670, parent=v773, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v778a = m0.AffineAccess(tensor=v42, addrs=[v772, 1])
v778 = m0.AffineStore(dst=v778a, src=v776, predicates=[], id=671, parent=v773, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v779 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v780 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v779)
v781 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v780)
v782a = m0.AffineAccess(tensor=v770, addrs=[v779, v780, v781])
v782 = m0.AffineLoad(src=v782a, predicates=[], id=672, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v783a = m0.AffineAccess(tensor=v104, addrs=[v780])
v783 = m0.AffineLoad(src=v783a, predicates=[], id=673, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v784a = m0.AffineAccess(tensor=v102, addrs=[v780])
v784 = m0.AffineLoad(src=v784a, predicates=[], id=674, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v785a = m0.AffineAccess(tensor=v39, addrs=[])
v785 = m0.AffineLoad(src=v785a, predicates=[], id=675, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v786a = m0.AffineAccess(tensor=v42, addrs=[v780, 0])
v786 = m0.AffineLoad(src=v786a, predicates=[], id=676, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v787a = m0.AffineAccess(tensor=v42, addrs=[v780, 1])
v787 = m0.AffineLoad(src=v787a, predicates=[], id=677, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v788 = m0.BinaryOp(lhs=v787, rhs=v785, op=np.add, id=678, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v789 = m0.UnaryOp(data=v788, op=m0.rsqrt, id=679, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v790 = m0.BinaryOp(lhs=v782, rhs=v786, op=np.subtract, id=680, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v791 = m0.BinaryOp(lhs=v783, rhs=v790, op=np.multiply, id=681, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v792 = m0.BinaryOp(lhs=v791, rhs=v789, op=np.multiply, id=682, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v793 = m0.BinaryOp(lhs=v792, rhs=v784, op=np.add, id=683, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v794a = m0.AffineAccess(tensor=v43, addrs=[v779, v780, v781])
v794 = m0.AffineStore(dst=v794a, src=v793, predicates=[], id=684, parent=v781, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v795 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v796a = m0.AffineAccess(tensor=v42, addrs=[v795, 0])
v796 = m0.AffineLoad(src=v796a, predicates=[], id=685, parent=v795, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v797a = m0.AffineAccess(tensor=v41, addrs=[v795])
v797 = m0.AffineStore(dst=v797a, src=v796, predicates=[], id=686, parent=v795, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v798 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v799a = m0.AffineAccess(tensor=v42, addrs=[v798, 1])
v799 = m0.AffineLoad(src=v799a, predicates=[], id=687, parent=v798, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v800a = m0.AffineAccess(tensor=v40, addrs=[v798])
v800 = m0.AffineStore(dst=v800a, src=v799, predicates=[], id=688, parent=v798, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.2", line=0, column=0, hlo_id=406))
v801 = m0.OffloadedMemCast(srcs=[v186], dsts=[v38], dtype="int64", id=689, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple", line=0, column=0, hlo_id=407))
v802 = m0.OffloadedMemCpy(srcs=[v38], dsts=[v33], dtype="int64", id=690, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=25))
v803 = m0.OffloadedMemCast(srcs=[v190], dsts=[v37], dtype="int64", id=691, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple", line=0, column=0, hlo_id=407))
v804 = m0.OffloadedMemCpy(srcs=[v37], dsts=[v32], dtype="int64", id=692, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=25))
v805 = m0.OffloadedMemCast(srcs=[v206], dsts=[v36], dtype="int64", id=693, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple", line=0, column=0, hlo_id=407))
v806 = m0.OffloadedMemCpy(srcs=[v36], dsts=[v31], dtype="int64", id=694, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=25))
v807 = m0.OffloadedMemCast(srcs=[v213], dsts=[v35], dtype="int64", id=695, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple", line=0, column=0, hlo_id=407))
v808 = m0.OffloadedMemCpy(srcs=[v35], dsts=[v30], dtype="int64", id=696, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=25))
v809 = m0.OffloadedMemCast(srcs=[v155], dsts=[v34], dtype="int64", id=697, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple", line=0, column=0, hlo_id=407))
v810 = m0.OffloadedMemCpy(srcs=[v34], dsts=[v29], dtype="int64", id=698, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=25))
v0.markOutput(v33)
v0.markOutput(v32)
v0.markOutput(v31)
v0.markOutput(v30)
v0.markOutput(v29)
v0.markOutput(v323)
v0.markOutput(v43)
v0.id=699
ir=v0
