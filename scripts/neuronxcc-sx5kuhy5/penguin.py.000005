import neuroncc.starfish.penguin.ir.ir as m0
import neuroncc.starfish.penguin.ir.DebugInfo as m1
import neuroncc.starfish.penguin.targets.tonga.APIndex as m2
import neuroncc.starfish.penguin.targets.tonga.TongaInst as m3
import neuroncc.starfish.penguin.targets.tonga.TongaISAInst as m4
import neuroncc.starfish.penguin.targets.tonga.TongaTensor as m5
import numpy as np
v0 = m0.Function(id_=0, batch_ids=[], attrs=("model-type=compute-bound","mac-count=15209070592",))
def weight_load(p):
  t = np.load(p)
  return t
import neuroncc.starfish.support as m7
v1 = m0.Tensor(name="intermediate1464", shape=(), parent=v0, id=1, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v1)
v2 = m0.Tensor(name="input44", shape=(), parent=v0, id=2, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v2)
v3 = m0.Tensor(name="intermediate1465", shape=(1,1,912,912), parent=v0, id=3, dtype="int64", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v3)
v4 = m0.Tensor(name="input75", shape=(1024,), parent=v0, id=4, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v4, is_parameter_tensor=True)
v5 = m0.Tensor(name="input70", shape=(1024,), parent=v0, id=5, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v5, is_parameter_tensor=True)
v6 = m0.Tensor(name="intermediate1468", shape=(1,912,1024), parent=v0, id=6, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v6)
v7 = m0.Tensor(name="input41", shape=(1024,), parent=v0, id=7, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v7, is_parameter_tensor=True)
v8 = m0.Tensor(name="input74", shape=(4096,1024), parent=v0, id=8, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(4096,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v8, is_parameter_tensor=True)
v9 = m0.Tensor(name="input73", shape=(4096,), parent=v0, id=9, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(4096,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v9, is_parameter_tensor=True)
v10 = m0.Tensor(name="input72", shape=(1024,4096), parent=v0, id=10, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,4096), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v10, is_parameter_tensor=True)
v11 = m0.Tensor(name="input71", shape=(1024,), parent=v0, id=11, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v11, is_parameter_tensor=True)
v12 = m0.Tensor(name="input42", shape=(), parent=v0, id=12, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v12)
v13 = m0.Tensor(name="input40", shape=(1024,), parent=v0, id=13, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v13, is_parameter_tensor=True)
v14 = m0.Tensor(name="input81", shape=(1024,1024), parent=v0, id=14, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v14, is_parameter_tensor=True)
v15 = m0.Tensor(name="input80", shape=(1024,), parent=v0, id=15, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v15, is_parameter_tensor=True)
v16 = m0.Tensor(name="input83", shape=(1024,1024), parent=v0, id=16, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v16, is_parameter_tensor=True)
v17 = m0.Tensor(name="input82", shape=(1024,), parent=v0, id=17, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v17, is_parameter_tensor=True)
v18 = m0.Tensor(name="input54", shape=(), parent=v0, id=18, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v18)
v19 = m0.Tensor(name="intermediate1466", shape=(912,912), parent=v0, id=19, dtype="int64", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v19)
v20 = m0.Tensor(name="input56", shape=(), parent=v0, id=20, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v20)
v21 = m0.Tensor(name="input55", shape=(), parent=v0, id=21, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v21)
v22 = m0.Tensor(name="intermediate1467", shape=(512,1024), parent=v0, id=22, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v22)
v23 = m0.Tensor(name="input79", shape=(1024,1024), parent=v0, id=23, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v23, is_parameter_tensor=True)
v24 = m0.Tensor(name="input78", shape=(1024,), parent=v0, id=24, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v24, is_parameter_tensor=True)
v25 = m0.Tensor(name="input77", shape=(1024,1024), parent=v0, id=25, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v25, is_parameter_tensor=True)
v26 = m0.Tensor(name="input76", shape=(1024,), parent=v0, id=26, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v26, is_parameter_tensor=True)
v27 = m0.Tensor(name="intermediate1469", shape=(), parent=v0, id=27, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" })
v28 = m0.Tensor(name="_tuple_1_hlo_id_361__mhlo.convert_2035", shape=(), parent=v0, id=28, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), )
v29 = m0.Tensor(name="eps__batch_norm_training_4_hlo_id_360__mhlo.batch_norm_training_2034", shape=(), parent=v0, id=29, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_eps__batch_norm_training_4_hlo_id_360__mhlo.batch_norm_training_2034.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v30 = m0.Tensor(name="var__batch_norm_training_4_hlo_id_360__mhlo.batch_norm_training_2033", shape=(912,), parent=v0, id=30, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v31 = m0.Tensor(name="mean__batch_norm_training_4_hlo_id_360__mhlo.batch_norm_training_2032", shape=(912,), parent=v0, id=31, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v32 = m0.Tensor(name="mean_var__batch_norm_training_4_hlo_id_360__mhlo.batch_norm_training_2031", shape=(912,2,), parent=v0, id=32, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,2,), layout="NC", transpose=(0,1,)), )
v33 = m0.Tensor(name="intermediate1470", shape=(1,912,1024,), parent=v0, id=33, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), attrs={'IntermediateTensor':  "" })
v34 = m0.Tensor(name="_reshape_775_hlo_id_346__mhlo.reshape_2029", shape=(1,912,1024,), parent=v0, id=34, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v35 = m0.Tensor(name="_dot_21_hlo_id_345__79", shape=(912,1024,), parent=v0, id=35, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v36 = m0.Tensor(name="_reshape_774_hlo_id_341__mhlo.reshape_2028", shape=(912,1024,), parent=v0, id=36, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v37 = m0.Tensor(name="_reshape_772_hlo_id_339__mhlo.reshape_2027", shape=(1,16,912,64,), parent=v0, id=37, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v38 = m0.Tensor(name="_dot_20_hlo_id_338__78", shape=(16,912,64,), parent=v0, id=38, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v39 = m0.Tensor(name="_reshape_704_hlo_id_337__mhlo.reshape_2026", shape=(16,912,64,), parent=v0, id=39, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v40 = m0.Tensor(name="_reshape_703_hlo_id_335__mhlo.reshape_2025", shape=(1,912,16,64,), parent=v0, id=40, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v41 = m0.Tensor(name="_reshape_700_hlo_id_330__mhlo.reshape_2024", shape=(1,912,1024,), parent=v0, id=41, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v42 = m0.Tensor(name="_dot_12_hlo_id_329__77", shape=(912,1024,), parent=v0, id=42, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v43 = m0.Tensor(name="_reshape_771_hlo_id_324__mhlo.reshape_2023", shape=(16,912,912,), parent=v0, id=43, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912,), layout="NHC", transpose=(0,1,2,)), )
v44 = m0.Tensor(name="_reshape_87935_hlo_id_307__mhlo.reshape_2022", shape=(1,16,912,912,), parent=v0, id=44, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v45 = m0.Tensor(name="_dot_15_hlo_id_295__76", shape=(16,912,512,), parent=v0, id=45, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,), layout="NHC", transpose=(0,1,2,)), )
v46 = m0.Tensor(name="_reshape_739_hlo_id_293__mhlo.reshape_2021", shape=(16,512,64,), parent=v0, id=46, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), )
v47 = m0.Tensor(name="_reshape_738_hlo_id_291__mhlo.reshape_2020", shape=(1,512,16,64,), parent=v0, id=47, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v48 = m0.Tensor(name="_reshape_735_hlo_id_287__mhlo.reshape_2019", shape=(1,512,1024,), parent=v0, id=48, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v49 = m0.Tensor(name="_dot_13_hlo_id_286__75", shape=(512,1024,), parent=v0, id=49, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v50 = m0.Tensor(name="_reshape_747_hlo_id_283__mhlo.reshape_2018", shape=(16,912,64,), parent=v0, id=50, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v51 = m0.Tensor(name="_reshape_746_hlo_id_281__mhlo.reshape_2017", shape=(1,912,16,64,), parent=v0, id=51, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v52 = m0.Tensor(name="_convert_14811_hlo_id_277__mhlo.convert_2016", shape=(912,912,), parent=v0, id=52, dtype="uint32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v53 = m0.Tensor(name="mhlo_clamp_74", shape=(912,912,), parent=v0, id=53, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v54 = m0.Tensor(name="in__broadcast_961_hlo_id_264__mhlo.constant_2015", shape=(), parent=v0, id=54, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_961_hlo_id_264__mhlo.constant_2015.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v55 = m0.Tensor(name="_broadcast_961_hlo_id_264__mhlo.constant_2014", shape=(16,912,512,912,), parent=v0, id=55, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v56 = m0.Tensor(name="_dot_18_hlo_id_261__73", shape=(16,912,512,), parent=v0, id=56, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,), layout="NHC", transpose=(0,1,2,)), )
v57 = m0.Tensor(name="_reshape_758_hlo_id_259__mhlo.reshape_2013", shape=(16,512,64,), parent=v0, id=57, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), )
v58 = m0.Tensor(name="_reshape_757_hlo_id_257__mhlo.reshape_2012", shape=(1,512,16,64,), parent=v0, id=58, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v59 = m0.Tensor(name="_reshape_754_hlo_id_253__mhlo.reshape_2011", shape=(1,512,1024,), parent=v0, id=59, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v60 = m0.Tensor(name="_dot_16_hlo_id_252__72", shape=(512,1024,), parent=v0, id=60, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v61 = m0.Tensor(name="in__convert_83_hlo_id_243__mhlo.constant_2010", shape=(), parent=v0, id=61, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_83_hlo_id_243__mhlo.constant_2010.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v62 = m0.Tensor(name="_convert_83_hlo_id_243__mhlo.constant_2009", shape=(512,1024,), parent=v0, id=62, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v63 = m0.Tensor(name="in__broadcast_64380_hlo_id_240__mhlo.constant_2008", shape=(), parent=v0, id=63, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_64380_hlo_id_240__mhlo.constant_2008.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v64 = m0.Tensor(name="_broadcast_64380_hlo_id_240__mhlo.constant_2007", shape=(512,1024,), parent=v0, id=64, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v65 = m0.Tensor(name="_concatenate_13_hlo_id_224__mhlo.concatenate_2006", shape=(2,), parent=v0, id=65, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v66 = m0.Tensor(name="_reshape_727_hlo_id_222__mhlo.reshape_2005", shape=(1,), parent=v0, id=66, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v67 = m0.Tensor(name="_convert_77_hlo_id_221__mhlo.convert_2004", shape=(), parent=v0, id=67, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v68 = m0.Tensor(name="in__broadcast_937_hlo_id_220__mhlo.constant_2003", shape=(), parent=v0, id=68, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_937_hlo_id_220__mhlo.constant_2003.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v69 = m0.Tensor(name="_broadcast_937_hlo_id_220__mhlo.constant_2002", shape=(512,1024,), parent=v0, id=69, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v70 = m0.Tensor(name="_convert_14459_hlo_id_215__mhlo.convert_2001", shape=(912,912,), parent=v0, id=70, dtype="uint32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v71 = m0.Tensor(name="mhlo_clamp_71", shape=(912,912,), parent=v0, id=71, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v72 = m0.Tensor(name="in__broadcast_69170_hlo_id_207__mhlo.constant_2000", shape=(), parent=v0, id=72, dtype="int32", value=weight_load("./constant_in__broadcast_69170_hlo_id_207__mhlo.constant_2000.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v73 = m0.Tensor(name="_broadcast_69170_hlo_id_207__mhlo.constant_1999", shape=(912,912,), parent=v0, id=73, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v74 = m0.Tensor(name="_dot_19_hlo_id_205__70", shape=(16,912,912,), parent=v0, id=74, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912,), layout="NHC", transpose=(0,1,2,)), )
v75 = m0.Tensor(name="_reshape_96541_hlo_id_203__mhlo.reshape_1998", shape=(16,912,64,), parent=v0, id=75, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v76 = m0.Tensor(name="_reshape_100605_hlo_id_201__mhlo.reshape_1997", shape=(1,912,16,64,), parent=v0, id=76, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v77 = m0.Tensor(name="_reshape_743_hlo_id_193__mhlo.reshape_1996", shape=(1,912,1024,), parent=v0, id=77, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v78 = m0.Tensor(name="_dot_14_hlo_id_192__69", shape=(912,1024,), parent=v0, id=78, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v79 = m0.Tensor(name="_reshape_766_hlo_id_187__mhlo.reshape_1995", shape=(16,912,64,), parent=v0, id=79, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,64,), layout="NHC", transpose=(0,1,2,)), )
v80 = m0.Tensor(name="_reshape_765_hlo_id_185__mhlo.reshape_1994", shape=(1,912,16,64,), parent=v0, id=80, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v81 = m0.Tensor(name="_reshape_762_hlo_id_180__mhlo.reshape_1993", shape=(1,912,1024,), parent=v0, id=81, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v82 = m0.Tensor(name="_dot_17_hlo_id_179__68", shape=(912,1024,), parent=v0, id=82, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v83 = m0.Tensor(name="_reshape_761_hlo_id_175__mhlo.reshape_1992", shape=(912,1024,), parent=v0, id=83, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v84 = m0.Tensor(name="eps__batch_norm_training_3_hlo_id_168__mhlo.batch_norm_training_1991", shape=(), parent=v0, id=84, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_eps__batch_norm_training_3_hlo_id_168__mhlo.batch_norm_training_1991.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v85 = m0.Tensor(name="var__batch_norm_training_3_hlo_id_168__mhlo.batch_norm_training_1990", shape=(912,), parent=v0, id=85, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v86 = m0.Tensor(name="mean__batch_norm_training_3_hlo_id_168__mhlo.batch_norm_training_1989", shape=(912,), parent=v0, id=86, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v87 = m0.Tensor(name="mean_var__batch_norm_training_3_hlo_id_168__mhlo.batch_norm_training_1988", shape=(912,2,), parent=v0, id=87, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,2,), layout="NC", transpose=(0,1,)), )
v88 = m0.Tensor(name="_batch_norm_training_3_hlo_id_168__mhlo.batch_norm_training_1987", shape=(1,912,1024,), parent=v0, id=88, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v89 = m0.Tensor(name="in__broadcast_691_hlo_id_167__mhlo.constant_1986", shape=(), parent=v0, id=89, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_691_hlo_id_167__mhlo.constant_1986.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v90 = m0.Tensor(name="_broadcast_691_hlo_id_167__mhlo.constant_1985", shape=(912,), parent=v0, id=90, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v91 = m0.Tensor(name="in__broadcast_693_hlo_id_165__mhlo.constant_1984", shape=(), parent=v0, id=91, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_693_hlo_id_165__mhlo.constant_1984.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v92 = m0.Tensor(name="_broadcast_693_hlo_id_165__mhlo.constant_1983", shape=(912,), parent=v0, id=92, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,), layout="N", transpose=(0,)), )
v93 = m0.Tensor(name="_reshape_684_hlo_id_154__mhlo.reshape_1982", shape=(1,912,1024,), parent=v0, id=93, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v94 = m0.Tensor(name="_dot_11_hlo_id_153__67", shape=(912,1024,), parent=v0, id=94, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v95 = m0.Tensor(name="_reshape_683_hlo_id_149__mhlo.reshape_1981", shape=(912,4096,), parent=v0, id=95, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,4096,), layout="NC", transpose=(0,1,)), )
v96 = m0.Tensor(name="_reshape_680_hlo_id_143__mhlo.reshape_1980", shape=(1,912,4096,), parent=v0, id=96, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,4096,), layout="NHC", transpose=(0,1,2,)), )
v97 = m0.Tensor(name="_dot_10_hlo_id_142__66", shape=(912,4096,), parent=v0, id=97, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,4096,), layout="NC", transpose=(0,1,)), )
v98 = m0.Tensor(name="_reshape_679_hlo_id_138__mhlo.reshape_1979", shape=(912,1024,), parent=v0, id=98, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(912,1024,), layout="NC", transpose=(0,1,)), )
v99 = m0.Tensor(name="in__convert_62_hlo_id_124__mhlo.constant_1978", shape=(), parent=v0, id=99, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_62_hlo_id_124__mhlo.constant_1978.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v100 = m0.Tensor(name="_convert_62_hlo_id_124__mhlo.constant_1977", shape=(1,912,1024,), parent=v0, id=100, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v101 = m0.Tensor(name="_concatenate_10_hlo_id_105__mhlo.concatenate_1976", shape=(2,), parent=v0, id=101, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v102 = m0.Tensor(name="_reshape_669_hlo_id_103__mhlo.reshape_1975", shape=(1,), parent=v0, id=102, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v103 = m0.Tensor(name="_convert_56_hlo_id_102__mhlo.convert_1974", shape=(), parent=v0, id=103, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v104 = m0.Tensor(name="in__broadcast_968_hlo_id_96__mhlo.constant_1973", shape=(), parent=v0, id=104, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_968_hlo_id_96__mhlo.constant_1973.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v105 = m0.Tensor(name="_broadcast_968_hlo_id_96__mhlo.constant_1972", shape=(1,16,912,912,), parent=v0, id=105, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v106 = m0.Tensor(name="_constant_3461_hlo_id_95__mhlo.constant_1971", shape=(), parent=v0, id=106, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_3461_hlo_id_95__mhlo.constant_1971.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v107 = m0.Tensor(name="_reshape_95678_hlo_id_89__mhlo.reshape_1970", shape=(912,912,), parent=v0, id=107, dtype="uint8", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v108 = m0.Tensor(name="in__broadcast_912_hlo_id_86__mhlo.constant_1967", shape=(), parent=v0, id=108, dtype="int32", value=weight_load("./constant_in__broadcast_912_hlo_id_86__mhlo.constant_1967.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v109 = m0.Tensor(name="_broadcast_912_hlo_id_86__mhlo.constant_1966", shape=(1,1,912,912,), parent=v0, id=109, dtype="int32", view=m0.TensorView(shape=(1,1,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v110 = m0.Tensor(name="_constant_3434_hlo_id_85__mhlo.constant_1965", shape=(), parent=v0, id=110, dtype="int32", value=weight_load("./constant__constant_3434_hlo_id_85__mhlo.constant_1965.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v111 = m0.Tensor(name="in__convert_76_hlo_id_81__mhlo.constant_1964", shape=(), parent=v0, id=111, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_76_hlo_id_81__mhlo.constant_1964.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v112 = m0.Tensor(name="_convert_76_hlo_id_81__mhlo.constant_1963", shape=(1,16,912,912,), parent=v0, id=112, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v113 = m0.Tensor(name="in__broadcast_64335_hlo_id_78__mhlo.constant_1962", shape=(), parent=v0, id=113, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_64335_hlo_id_78__mhlo.constant_1962.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v114 = m0.Tensor(name="_broadcast_64335_hlo_id_78__mhlo.constant_1961", shape=(1,16,912,912,), parent=v0, id=114, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v115 = m0.Tensor(name="_concatenate_12_hlo_id_62__mhlo.concatenate_1960", shape=(2,), parent=v0, id=115, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v116 = m0.Tensor(name="_reshape_707_hlo_id_60__mhlo.reshape_1959", shape=(1,), parent=v0, id=116, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v117 = m0.Tensor(name="_convert_70_hlo_id_59__mhlo.convert_1958", shape=(), parent=v0, id=117, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v118 = m0.Tensor(name="in__broadcast_911_hlo_id_58__mhlo.constant_1957", shape=(), parent=v0, id=118, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_911_hlo_id_58__mhlo.constant_1957.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v119 = m0.Tensor(name="_broadcast_911_hlo_id_58__mhlo.constant_1956", shape=(1,16,912,912,), parent=v0, id=119, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v120 = m0.Tensor(name="in__convert_69_hlo_id_54__mhlo.constant_1955", shape=(), parent=v0, id=120, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_69_hlo_id_54__mhlo.constant_1955.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v121 = m0.Tensor(name="_convert_69_hlo_id_54__mhlo.constant_1954", shape=(1,912,1024,), parent=v0, id=121, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v122 = m0.Tensor(name="in__broadcast_64330_hlo_id_51__mhlo.constant_1953", shape=(), parent=v0, id=122, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_64330_hlo_id_51__mhlo.constant_1953.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v123 = m0.Tensor(name="_broadcast_64330_hlo_id_51__mhlo.constant_1952", shape=(1,912,1024,), parent=v0, id=123, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v124 = m0.Tensor(name="_constant_22475_hlo_id_50__mhlo.constant_1951", shape=(), parent=v0, id=124, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_22475_hlo_id_50__mhlo.constant_1951.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v125 = m0.Tensor(name="_concatenate_11_hlo_id_34__mhlo.concatenate_1950", shape=(2,), parent=v0, id=125, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v126 = m0.Tensor(name="in__constant_63578_hlo_id_33__mhlo.constant_1949", shape=(), parent=v0, id=126, dtype="uint32", value=weight_load("./constant_in__constant_63578_hlo_id_33__mhlo.constant_1949.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v127 = m0.Tensor(name="_constant_63578_hlo_id_33__mhlo.constant_1948", shape=(1,), parent=v0, id=127, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v128 = m0.Tensor(name="_reshape_689_hlo_id_32__mhlo.reshape_1947", shape=(1,), parent=v0, id=128, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v129 = m0.Tensor(name="_convert_63_hlo_id_31__mhlo.convert_1946", shape=(), parent=v0, id=129, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v130 = m0.Tensor(name="in__broadcast_896_hlo_id_13__mhlo.constant_1945", shape=(), parent=v0, id=130, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_896_hlo_id_13__mhlo.constant_1945.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v131 = m0.Tensor(name="_broadcast_896_hlo_id_13__mhlo.constant_1944", shape=(1,912,1024,), parent=v0, id=131, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024,), layout="NHC", transpose=(0,1,2,)), )
v132 = m0.Tensor(name="_constant_63577_hlo_id_12__mhlo.constant_1943", shape=(), parent=v0, id=132, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_63577_hlo_id_12__mhlo.constant_1943.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v133 = m0.Tensor(name="_constant_3399_hlo_id_20__mhlo.constant_1942", shape=(), parent=v0, id=133, dtype="int32", value=weight_load("./constant__constant_3399_hlo_id_20__mhlo.constant_1942.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v134 = m0.Tensor(name="_constant_3416_hlo_id_14__mhlo.constant_1941", shape=(), parent=v0, id=134, dtype="int32", value=weight_load("./constant__constant_3416_hlo_id_14__mhlo.constant_1941.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v135 = m0.Tensor(name="mlir_function_hlo_id_361__mhlo.convert_1940", shape=(), parent=v0, id=135, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v136 = m0.Tensor(name="mlir_function_hlo_id_361__mhlo.convert_1939", shape=(1,1,912,912,), parent=v0, id=136, dtype="int32", view=m0.TensorView(shape=(1,1,912,912,), layout="NHWC", transpose=(0,1,2,3,)), )
v137 = m0.Tensor(name="mlir_function_hlo_id_361__mhlo.convert_1938", shape=(912,912,), parent=v0, id=137, dtype="int32", view=m0.TensorView(shape=(912,912,), layout="NC", transpose=(0,1,)), )
v138 = m0.Tensor(name="mlir_function_hlo_id_361__mhlo.convert_1937", shape=(), parent=v0, id=138, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v139 = m0.Tensor(name="mlir_function_hlo_id_361__mhlo.convert_1936", shape=(), parent=v0, id=139, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v140 = m0.OffloadedMemCast(srcs=[v21], dsts=[v139], dtype="int32", id=140, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=361))
v141 = m0.OffloadedMemCast(srcs=[v20], dsts=[v138], dtype="int32", id=141, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=361))
v142 = m0.OffloadedMemCast(srcs=[v19], dsts=[v137], dtype="int32", id=142, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=361))
v143 = m0.OffloadedMemCast(srcs=[v3], dsts=[v136], dtype="int32", id=143, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=361))
v144 = m0.OffloadedMemCast(srcs=[v1], dsts=[v135], dtype="int32", id=144, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=361))
v146 = m0.Tensor(name="multiply.1433", shape=(), parent=v0, id=145, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
import neuroncc.starfish.penguin.frontends.XlaFE as m8
v145 = m8.NeuronTensorOp(srcs=[v134, v135], dsts=[v146], op=np.multiply, xla_op='mhlo.binary', id=146, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1627", line=0, column=0, hlo_id=19))
v148 = m0.Tensor(name="add.1471", shape=(), parent=v0, id=147, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v147 = m8.NeuronTensorOp(srcs=[v146, v133], dsts=[v148], op=np.add, xla_op='mhlo.binary', id=148, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2858", line=0, column=0, hlo_id=21))
v150 = m0.Tensor(name="multiply.1434", shape=(), parent=v0, id=149, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v149 = m8.NeuronTensorOp(srcs=[v134, v148], dsts=[v150], op=np.multiply, xla_op='mhlo.binary', id=150, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1637", line=0, column=0, hlo_id=22))
v152 = m0.Tensor(name="add.1472", shape=(), parent=v0, id=151, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v151 = m8.NeuronTensorOp(srcs=[v150, v133], dsts=[v152], op=np.add, xla_op='mhlo.binary', id=152, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2865", line=0, column=0, hlo_id=24))
v154 = m0.Tensor(name="multiply.1435", shape=(), parent=v0, id=153, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v153 = m8.NeuronTensorOp(srcs=[v134, v152], dsts=[v154], op=np.multiply, xla_op='mhlo.binary', id=154, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1638", line=0, column=0, hlo_id=25))
v156 = m0.Tensor(name="add.1473", shape=(), parent=v0, id=155, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v155 = m8.NeuronTensorOp(srcs=[v154, v133], dsts=[v156], op=np.add, xla_op='mhlo.binary', id=156, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2866", line=0, column=0, hlo_id=27))
v158 = m0.Tensor(name="multiply.1436", shape=(), parent=v0, id=157, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v157 = m8.NeuronTensorOp(srcs=[v134, v156], dsts=[v158], op=np.multiply, xla_op='mhlo.binary', id=158, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1639", line=0, column=0, hlo_id=28))
v160 = m0.Tensor(name="add.1474", shape=(), parent=v0, id=159, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v159 = m8.NeuronTensorOp(srcs=[v158, v133], dsts=[v160], op=np.add, xla_op='mhlo.binary', id=160, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2867", line=0, column=0, hlo_id=30))
v161 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v162 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v161)
v163 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v162)
v164a = m0.AffineAccess(tensor=v130, addrs=[])
v164 = m0.AffineLoad(src=v164a, predicates=[], id=161, parent=v163, dl=m1.DebugLocation(tensor_op_name="_broadcast.896", line=0, column=0, hlo_id=13))
v165a = m0.AffineAccess(tensor=v131, addrs=[v161, v162, v163])
v165 = m0.AffineStore(dst=v165a, src=v164, predicates=[], id=162, parent=v163, dl=m1.DebugLocation(tensor_op_name="_broadcast.896", line=0, column=0, hlo_id=13))
v166 = m0.OffloadedMemCast(srcs=[v160], dsts=[v129], dtype="uint32", id=163, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.63", line=0, column=0, hlo_id=31))
v167 = m0.OffloadedMemCpy(srcs=[v129], dsts=[v128], dtype="uint32", id=164, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.689", line=0, column=0, hlo_id=32))
v168 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v169a = m0.AffineAccess(tensor=v126, addrs=[])
v169 = m0.AffineLoad(src=v169a, predicates=[], id=165, parent=v168, dl=m1.DebugLocation(tensor_op_name="_constant.63578", line=0, column=0, hlo_id=33))
v170a = m0.AffineAccess(tensor=v127, addrs=[v168])
v170 = m0.AffineStore(dst=v170a, src=v169, predicates=[], id=166, parent=v168, dl=m1.DebugLocation(tensor_op_name="_constant.63578", line=0, column=0, hlo_id=33))
v171 = m0.OffloadedConcat(srcs=[v128, v127, ], dsts=[v125], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=167, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.11", line=0, column=0, hlo_id=34))
v173 = m0.Tensor(name="get_tuple_element.21", shape=(1,912,1024), parent=v0, id=168, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v174 = m0.Tensor(name="custom_call.29", shape=(2,), parent=v0, id=169, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v172 = m8.NeuronTensorOp(srcs=[v2, v125], dsts=[v173, v174], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=170, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call", line=0, column=0, hlo_id=362))
v175 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v176 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v175)
v177 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v176)
v178a = m0.AffineAccess(tensor=v122, addrs=[])
v178 = m0.AffineLoad(src=v178a, predicates=[], id=171, parent=v177, dl=m1.DebugLocation(tensor_op_name="_broadcast.64330", line=0, column=0, hlo_id=51))
v179a = m0.AffineAccess(tensor=v123, addrs=[v175, v176, v177])
v179 = m0.AffineStore(dst=v179a, src=v178, predicates=[], id=172, parent=v177, dl=m1.DebugLocation(tensor_op_name="_broadcast.64330", line=0, column=0, hlo_id=51))
v181 = m0.Tensor(name="select.65", shape=(1,912,1024), parent=v0, id=173, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v180 = m0.TernaryTensorOp(srcs=[v173, v131, v123], dsts=[v181], op=np.select, id=174, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4923", line=0, column=0, hlo_id=52))
v183 = m0.Tensor(name="subtract.23", shape=(1,912,1024), parent=v0, id=175, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v182 = m8.NeuronTensorOp(srcs=[v131, v181], dsts=[v183], op=np.subtract, xla_op='mhlo.binary', id=176, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.45", line=0, column=0, hlo_id=53))
v184 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v185 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v184)
v186 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v185)
v187a = m0.AffineAccess(tensor=v120, addrs=[])
v187 = m0.AffineLoad(src=v187a, predicates=[], id=177, parent=v186, dl=m1.DebugLocation(tensor_op_name="_convert.69", line=0, column=0, hlo_id=54))
v188a = m0.AffineAccess(tensor=v121, addrs=[v184, v185, v186])
v188 = m0.AffineStore(dst=v188a, src=v187, predicates=[], id=178, parent=v186, dl=m1.DebugLocation(tensor_op_name="_convert.69", line=0, column=0, hlo_id=54))
v190 = m0.Tensor(name="compare.44", shape=(1,912,1024), parent=v0, id=179, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v189 = m8.NeuronTensorOp(srcs=[v183, v121], dsts=[v190], op=np.not_equal, xla_op='mhlo.binary', id=180, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.69", line=0, column=0, hlo_id=54))
v191 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v192 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v191)
v193 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v192)
v194 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v193)
v195a = m0.AffineAccess(tensor=v118, addrs=[])
v195 = m0.AffineLoad(src=v195a, predicates=[], id=181, parent=v194, dl=m1.DebugLocation(tensor_op_name="_broadcast.911", line=0, column=0, hlo_id=58))
v196a = m0.AffineAccess(tensor=v119, addrs=[v191, v192, v193, v194])
v196 = m0.AffineStore(dst=v196a, src=v195, predicates=[], id=182, parent=v194, dl=m1.DebugLocation(tensor_op_name="_broadcast.911", line=0, column=0, hlo_id=58))
v197 = m0.OffloadedMemCast(srcs=[v156], dsts=[v117], dtype="uint32", id=183, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.70", line=0, column=0, hlo_id=59))
v198 = m0.OffloadedMemCpy(srcs=[v117], dsts=[v116], dtype="uint32", id=184, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.707", line=0, column=0, hlo_id=60))
v199 = m0.OffloadedConcat(srcs=[v116, v127, ], dsts=[v115], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=185, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.12", line=0, column=0, hlo_id=62))
v201 = m0.Tensor(name="get_tuple_element.22", shape=(1,16,912,912), parent=v0, id=186, dtype="uint8", view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v202 = m0.Tensor(name="custom_call.30", shape=(2,), parent=v0, id=187, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v200 = m8.NeuronTensorOp(srcs=[v2, v115], dsts=[v201, v202], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=188, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.1", line=0, column=0, hlo_id=365))
v203 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v204 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v203)
v205 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v204)
v206 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v205)
v207a = m0.AffineAccess(tensor=v113, addrs=[])
v207 = m0.AffineLoad(src=v207a, predicates=[], id=189, parent=v206, dl=m1.DebugLocation(tensor_op_name="_broadcast.64335", line=0, column=0, hlo_id=78))
v208a = m0.AffineAccess(tensor=v114, addrs=[v203, v204, v205, v206])
v208 = m0.AffineStore(dst=v208a, src=v207, predicates=[], id=190, parent=v206, dl=m1.DebugLocation(tensor_op_name="_broadcast.64335", line=0, column=0, hlo_id=78))
v210 = m0.Tensor(name="select.66", shape=(1,16,912,912), parent=v0, id=191, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v209 = m0.TernaryTensorOp(srcs=[v201, v119, v114], dsts=[v210], op=np.select, id=192, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4924", line=0, column=0, hlo_id=79))
v212 = m0.Tensor(name="subtract.24", shape=(1,16,912,912), parent=v0, id=193, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v211 = m8.NeuronTensorOp(srcs=[v119, v210], dsts=[v212], op=np.subtract, xla_op='mhlo.binary', id=194, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.47", line=0, column=0, hlo_id=80))
v213 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v214 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v213)
v215 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v214)
v216 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v215)
v217a = m0.AffineAccess(tensor=v111, addrs=[])
v217 = m0.AffineLoad(src=v217a, predicates=[], id=195, parent=v216, dl=m1.DebugLocation(tensor_op_name="_convert.76", line=0, column=0, hlo_id=81))
v218a = m0.AffineAccess(tensor=v112, addrs=[v213, v214, v215, v216])
v218 = m0.AffineStore(dst=v218a, src=v217, predicates=[], id=196, parent=v216, dl=m1.DebugLocation(tensor_op_name="_convert.76", line=0, column=0, hlo_id=81))
v220 = m0.Tensor(name="compare.45", shape=(1,16,912,912), parent=v0, id=197, dtype="uint8", view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v219 = m8.NeuronTensorOp(srcs=[v212, v112], dsts=[v220], op=np.not_equal, xla_op='mhlo.binary', id=198, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.76", line=0, column=0, hlo_id=81))
v221 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v222 = m0.Axis(lb=0, ub=1, stride=1, it="j", parent=v221)
v223 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v222)
v224 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v223)
v225a = m0.AffineAccess(tensor=v108, addrs=[])
v225 = m0.AffineLoad(src=v225a, predicates=[], id=199, parent=v224, dl=m1.DebugLocation(tensor_op_name="_broadcast.912", line=0, column=0, hlo_id=86))
v226a = m0.AffineAccess(tensor=v109, addrs=[v221, v222, v223, v224])
v226 = m0.AffineStore(dst=v226a, src=v225, predicates=[], id=200, parent=v224, dl=m1.DebugLocation(tensor_op_name="_broadcast.912", line=0, column=0, hlo_id=86))
v228 = m0.Tensor(name="compare.46", shape=(1,1,912,912), parent=v0, id=201, dtype="uint8", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v227 = m8.NeuronTensorOp(srcs=[v136, v109], dsts=[v228], op=np.not_equal, xla_op='mhlo.binary', id=202, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.69", line=0, column=0, hlo_id=87))
import scipy.special as m9
v230 = m0.Tensor(name="not.6", shape=(1,1,912,912), parent=v0, id=203, dtype="uint8", view=m0.TensorView(shape=(1,1,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v229 = m8.NeuronTensorOp(srcs=[v228], dsts=[v230], op=np.logical_not, xla_op='mhlo.unary', id=204, parent=v0, dl=m1.DebugLocation(tensor_op_name="_not.1", line=0, column=0, hlo_id=88))
v231 = m0.OffloadedMemCpy(srcs=[v230], dsts=[v107], dtype="uint8", id=205, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.95678", line=0, column=0, hlo_id=89))
v233 = m0.Tensor(name="broadcast_in_dim.137", shape=(1,16,912,912), parent=v0, id=206, dtype="uint8", view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v232 = m8.NeuronTensorOp(srcs=[v107], dsts=[v233], xla_op='mhlo.broadcast_in_dim', bcdims=[2, 3], id=207, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.64337", line=0, column=0, hlo_id=90))
v234 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v235 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v234)
v236 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v235)
v237 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v236)
v238a = m0.AffineAccess(tensor=v104, addrs=[])
v238 = m0.AffineLoad(src=v238a, predicates=[], id=208, parent=v237, dl=m1.DebugLocation(tensor_op_name="_broadcast.968", line=0, column=0, hlo_id=96))
v239a = m0.AffineAccess(tensor=v105, addrs=[v234, v235, v236, v237])
v239 = m0.AffineStore(dst=v239a, src=v238, predicates=[], id=209, parent=v237, dl=m1.DebugLocation(tensor_op_name="_broadcast.968", line=0, column=0, hlo_id=96))
v241 = m0.Tensor(name="broadcast_in_dim.138", shape=(1,912,1024), parent=v0, id=210, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v240 = m8.NeuronTensorOp(srcs=[v4], dsts=[v241], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=211, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.886", line=0, column=0, hlo_id=99))
v242 = m0.OffloadedMemCast(srcs=[v148], dsts=[v103], dtype="uint32", id=212, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.56", line=0, column=0, hlo_id=102))
v243 = m0.OffloadedMemCpy(srcs=[v103], dsts=[v102], dtype="uint32", id=213, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.669", line=0, column=0, hlo_id=103))
v244 = m0.OffloadedConcat(srcs=[v102, v127, ], dsts=[v101], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=214, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.10", line=0, column=0, hlo_id=105))
v246 = m0.Tensor(name="get_tuple_element.23", shape=(1,912,1024), parent=v0, id=215, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v247 = m0.Tensor(name="custom_call.31", shape=(2,), parent=v0, id=216, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v245 = m8.NeuronTensorOp(srcs=[v2, v101], dsts=[v246, v247], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=217, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.2", line=0, column=0, hlo_id=368))
v249 = m0.Tensor(name="select.67", shape=(1,912,1024), parent=v0, id=218, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v248 = m0.TernaryTensorOp(srcs=[v246, v131, v123], dsts=[v249], op=np.select, id=219, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4925", line=0, column=0, hlo_id=122))
v251 = m0.Tensor(name="subtract.25", shape=(1,912,1024), parent=v0, id=220, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v250 = m8.NeuronTensorOp(srcs=[v131, v249], dsts=[v251], op=np.subtract, xla_op='mhlo.binary', id=221, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.43", line=0, column=0, hlo_id=123))
v252 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v253 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v252)
v254 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v253)
v255a = m0.AffineAccess(tensor=v99, addrs=[])
v255 = m0.AffineLoad(src=v255a, predicates=[], id=222, parent=v254, dl=m1.DebugLocation(tensor_op_name="_convert.62", line=0, column=0, hlo_id=124))
v256a = m0.AffineAccess(tensor=v100, addrs=[v252, v253, v254])
v256 = m0.AffineStore(dst=v256a, src=v255, predicates=[], id=223, parent=v254, dl=m1.DebugLocation(tensor_op_name="_convert.62", line=0, column=0, hlo_id=124))
v258 = m0.Tensor(name="compare.47", shape=(1,912,1024), parent=v0, id=224, dtype="uint8", view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v257 = m8.NeuronTensorOp(srcs=[v251, v100], dsts=[v258], op=np.not_equal, xla_op='mhlo.binary', id=225, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.62", line=0, column=0, hlo_id=124))
v260 = m0.Tensor(name="broadcast_in_dim.139", shape=(1,912,1024), parent=v0, id=226, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v259 = m8.NeuronTensorOp(srcs=[v5], dsts=[v260], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=227, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.863", line=0, column=0, hlo_id=129))
v262 = m0.Tensor(name="broadcast_in_dim.140", shape=(1,912,1024), parent=v0, id=228, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v261 = m8.NeuronTensorOp(srcs=[v7], dsts=[v262], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=229, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.861", line=0, column=0, hlo_id=135))
v264 = m0.Tensor(name="multiply.1437", shape=(1,912,1024), parent=v0, id=230, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v263 = m8.NeuronTensorOp(srcs=[v6, v262], dsts=[v264], op=np.multiply, xla_op='mhlo.binary', id=231, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1625", line=0, column=0, hlo_id=136))
v266 = m0.Tensor(name="add.1475", shape=(1,912,1024), parent=v0, id=232, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v265 = m8.NeuronTensorOp(srcs=[v260, v264], dsts=[v266], op=np.add, xla_op='mhlo.binary', id=233, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2857", line=0, column=0, hlo_id=137))
v267 = m0.OffloadedMemCpy(srcs=[v266], dsts=[v98], dtype=m7.dtype.bfloat16, id=234, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.679", line=0, column=0, hlo_id=138))
v269 = m0.Tensor(name="transpose.82", shape=(1024,4096), parent=v0, id=235, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,4096), layout="NC", transpose=(0,1)), )
v268 = m8.NeuronTensorOp(srcs=[v8], dsts=[v269], xla_op='mhlo.transpose', src_shape=(4096,1024), permutation=(1,0), id=236, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.18", line=0, column=0, hlo_id=141))
v270 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v271 = m0.Axis(lb=0, ub=4096, stride=1, it="j", parent=v270)
v272 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v271)
v273a = m0.AffineAccess(tensor=v98, addrs=[v270, v272])
v273 = m0.AffineLoad(src=v273a, predicates=[], id=237, parent=v272, dl=m1.DebugLocation(tensor_op_name="_dot.10", line=0, column=0, hlo_id=142))
v274a = m0.AffineAccess(tensor=v269, addrs=[v272, v271])
v274 = m0.AffineLoad(src=v274a, predicates=[], id=238, parent=v272, dl=m1.DebugLocation(tensor_op_name="_dot.10", line=0, column=0, hlo_id=142))
v275 = m0.BinaryOp(lhs=v273, rhs=v274, op=np.multiply, id=239, parent=v272, dl=m1.DebugLocation(tensor_op_name="_dot.10", line=0, column=0, hlo_id=142))
v276 = m0.ReduceOp(data=v275, op=np.add, initial=0.0, reduce_axes=[v272], id=240, parent=v272, dl=m1.DebugLocation(tensor_op_name="_dot.10", line=0, column=0, hlo_id=142))
v277a = m0.AffineAccess(tensor=v97, addrs=[v270, v271])
v277 = m0.AffineStore(dst=v277a, src=v276, predicates=[], id=241, parent=v272, dl=m1.DebugLocation(tensor_op_name="_dot.10", line=0, column=0, hlo_id=142))
v278 = m0.OffloadedMemCpy(srcs=[v97], dsts=[v96], dtype=m7.dtype.bfloat16, id=242, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.680", line=0, column=0, hlo_id=143))
v280 = m0.Tensor(name="broadcast_in_dim.141", shape=(1,912,4096), parent=v0, id=243, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,4096), layout="NHC", transpose=(0,1,2)), )
v279 = m8.NeuronTensorOp(srcs=[v9], dsts=[v280], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=244, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.878", line=0, column=0, hlo_id=146))
v282 = m0.Tensor(name="add.1476", shape=(1,912,4096), parent=v0, id=245, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,4096), layout="NHC", transpose=(0,1,2)), )
v281 = m8.NeuronTensorOp(srcs=[v96, v280], dsts=[v282], op=np.add, xla_op='mhlo.binary', id=246, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2860", line=0, column=0, hlo_id=147))
v284 = m0.Tensor(name="custom_call.32", shape=(1,912,4096), parent=v0, id=247, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,4096), layout="NHC", transpose=(0,1,2)), )
v283 = m8.NeuronTensorOp(srcs=[v282], dsts=[v284], xla_op="mhlo.custom_call", target_name="AwsNeuronGelu", backend_config=None, id=248, parent=v0, dl=m1.DebugLocation(tensor_op_name="_custom-call.16501", line=0, column=0, hlo_id=148))
v285 = m0.OffloadedMemCpy(srcs=[v284], dsts=[v95], dtype=m7.dtype.bfloat16, id=249, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.683", line=0, column=0, hlo_id=149))
v287 = m0.Tensor(name="transpose.83", shape=(4096,1024), parent=v0, id=250, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(4096,1024), layout="NC", transpose=(0,1)), )
v286 = m8.NeuronTensorOp(srcs=[v10], dsts=[v287], xla_op='mhlo.transpose', src_shape=(1024,4096), permutation=(1,0), id=251, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.17", line=0, column=0, hlo_id=152))
v288 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v289 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v288)
v290 = m0.Axis(lb=0, ub=4096, stride=1, it="k", parent=v289)
v291a = m0.AffineAccess(tensor=v95, addrs=[v288, v290])
v291 = m0.AffineLoad(src=v291a, predicates=[], id=252, parent=v290, dl=m1.DebugLocation(tensor_op_name="_dot.11", line=0, column=0, hlo_id=153))
v292a = m0.AffineAccess(tensor=v287, addrs=[v290, v289])
v292 = m0.AffineLoad(src=v292a, predicates=[], id=253, parent=v290, dl=m1.DebugLocation(tensor_op_name="_dot.11", line=0, column=0, hlo_id=153))
v293 = m0.BinaryOp(lhs=v291, rhs=v292, op=np.multiply, id=254, parent=v290, dl=m1.DebugLocation(tensor_op_name="_dot.11", line=0, column=0, hlo_id=153))
v294 = m0.ReduceOp(data=v293, op=np.add, initial=0.0, reduce_axes=[v290], id=255, parent=v290, dl=m1.DebugLocation(tensor_op_name="_dot.11", line=0, column=0, hlo_id=153))
v295a = m0.AffineAccess(tensor=v94, addrs=[v288, v289])
v295 = m0.AffineStore(dst=v295a, src=v294, predicates=[], id=256, parent=v290, dl=m1.DebugLocation(tensor_op_name="_dot.11", line=0, column=0, hlo_id=153))
v296 = m0.OffloadedMemCpy(srcs=[v94], dsts=[v93], dtype=m7.dtype.bfloat16, id=257, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.684", line=0, column=0, hlo_id=154))
v298 = m0.Tensor(name="broadcast_in_dim.142", shape=(1,912,1024), parent=v0, id=258, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v297 = m8.NeuronTensorOp(srcs=[v11], dsts=[v298], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=259, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.879", line=0, column=0, hlo_id=157))
v300 = m0.Tensor(name="add.1477", shape=(1,912,1024), parent=v0, id=260, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v299 = m8.NeuronTensorOp(srcs=[v93, v298], dsts=[v300], op=np.add, xla_op='mhlo.binary', id=261, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2861", line=0, column=0, hlo_id=158))
v302 = m0.Tensor(name="select.68", shape=(1,912,1024), parent=v0, id=262, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v301 = m0.TernaryTensorOp(srcs=[v258, v123, v300], dsts=[v302], op=np.select, id=263, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.43", line=0, column=0, hlo_id=159))
v304 = m0.Tensor(name="broadcast_in_dim.143", shape=(1,912,1024), parent=v0, id=264, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v303 = m8.NeuronTensorOp(srcs=[v12], dsts=[v304], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=265, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.882", line=0, column=0, hlo_id=161))
v306 = m0.Tensor(name="multiply.1438", shape=(1,912,1024), parent=v0, id=266, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v305 = m8.NeuronTensorOp(srcs=[v302, v304], dsts=[v306], op=np.multiply, xla_op='mhlo.binary', id=267, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1633", line=0, column=0, hlo_id=162))
v308 = m0.Tensor(name="add.1478", shape=(1,912,1024), parent=v0, id=268, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v307 = m8.NeuronTensorOp(srcs=[v306, v266], dsts=[v308], op=np.add, xla_op='mhlo.binary', id=269, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2862", line=0, column=0, hlo_id=163))
v309 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v310a = m0.AffineAccess(tensor=v91, addrs=[])
v310 = m0.AffineLoad(src=v310a, predicates=[], id=270, parent=v309, dl=m1.DebugLocation(tensor_op_name="_broadcast.693", line=0, column=0, hlo_id=165))
v311a = m0.AffineAccess(tensor=v92, addrs=[v309])
v311 = m0.AffineStore(dst=v311a, src=v310, predicates=[], id=271, parent=v309, dl=m1.DebugLocation(tensor_op_name="_broadcast.693", line=0, column=0, hlo_id=165))
v312 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v313a = m0.AffineAccess(tensor=v89, addrs=[])
v313 = m0.AffineLoad(src=v313a, predicates=[], id=272, parent=v312, dl=m1.DebugLocation(tensor_op_name="_broadcast.691", line=0, column=0, hlo_id=167))
v314a = m0.AffineAccess(tensor=v90, addrs=[v312])
v314 = m0.AffineStore(dst=v314a, src=v313, predicates=[], id=273, parent=v312, dl=m1.DebugLocation(tensor_op_name="_broadcast.691", line=0, column=0, hlo_id=167))
v315 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v316 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v315)
v317 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v316)
v318a = m0.AffineAccess(tensor=v308, addrs=[v315, v316, v317])
v318 = m0.AffineLoad(src=v318a, predicates=[], id=274, parent=v317, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v319_v320 = m0.BatchNormMeanVarOp(data=v318, reduce_axes=[v315, v317], id=275, parent=v317, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v319 = m0.ExtractValue(src=v319_v320, idxes=[0], id=276, parent=v317, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v320 = m0.ExtractValue(src=v319_v320, idxes=[1], id=277, parent=v317, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v321a = m0.AffineAccess(tensor=v87, addrs=[v316, 0])
v321 = m0.AffineStore(dst=v321a, src=v319, predicates=[], id=278, parent=v317, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v322a = m0.AffineAccess(tensor=v87, addrs=[v316, 1])
v322 = m0.AffineStore(dst=v322a, src=v320, predicates=[], id=279, parent=v317, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v323 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v324 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v323)
v325 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v324)
v326a = m0.AffineAccess(tensor=v308, addrs=[v323, v324, v325])
v326 = m0.AffineLoad(src=v326a, predicates=[], id=280, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v327a = m0.AffineAccess(tensor=v92, addrs=[v324])
v327 = m0.AffineLoad(src=v327a, predicates=[], id=281, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v328a = m0.AffineAccess(tensor=v90, addrs=[v324])
v328 = m0.AffineLoad(src=v328a, predicates=[], id=282, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v329a = m0.AffineAccess(tensor=v84, addrs=[])
v329 = m0.AffineLoad(src=v329a, predicates=[], id=283, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v330a = m0.AffineAccess(tensor=v87, addrs=[v324, 0])
v330 = m0.AffineLoad(src=v330a, predicates=[], id=284, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v331a = m0.AffineAccess(tensor=v87, addrs=[v324, 1])
v331 = m0.AffineLoad(src=v331a, predicates=[], id=285, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v332 = m0.BinaryOp(lhs=v331, rhs=v329, op=np.add, id=286, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v333 = m0.UnaryOp(data=v332, op=m0.rsqrt, id=287, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v334 = m0.BinaryOp(lhs=v326, rhs=v330, op=np.subtract, id=288, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v335 = m0.BinaryOp(lhs=v327, rhs=v334, op=np.multiply, id=289, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v336 = m0.BinaryOp(lhs=v335, rhs=v333, op=np.multiply, id=290, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v337 = m0.BinaryOp(lhs=v336, rhs=v328, op=np.add, id=291, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v338a = m0.AffineAccess(tensor=v88, addrs=[v323, v324, v325])
v338 = m0.AffineStore(dst=v338a, src=v337, predicates=[], id=292, parent=v325, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v339 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v340a = m0.AffineAccess(tensor=v87, addrs=[v339, 0])
v340 = m0.AffineLoad(src=v340a, predicates=[], id=293, parent=v339, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v341a = m0.AffineAccess(tensor=v86, addrs=[v339])
v341 = m0.AffineStore(dst=v341a, src=v340, predicates=[], id=294, parent=v339, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v342 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v343a = m0.AffineAccess(tensor=v87, addrs=[v342, 1])
v343 = m0.AffineLoad(src=v343a, predicates=[], id=295, parent=v342, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v344a = m0.AffineAccess(tensor=v85, addrs=[v342])
v344 = m0.AffineStore(dst=v344a, src=v343, predicates=[], id=296, parent=v342, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.3", line=0, column=0, hlo_id=168))
v346 = m0.Tensor(name="broadcast_in_dim.144", shape=(1,912,1024), parent=v0, id=297, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v345 = m8.NeuronTensorOp(srcs=[v13], dsts=[v346], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=298, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.884", line=0, column=0, hlo_id=172))
v348 = m0.Tensor(name="multiply.1439", shape=(1,912,1024), parent=v0, id=299, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v347 = m8.NeuronTensorOp(srcs=[v88, v346], dsts=[v348], op=np.multiply, xla_op='mhlo.binary', id=300, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1635", line=0, column=0, hlo_id=173))
v350 = m0.Tensor(name="add.1479", shape=(1,912,1024), parent=v0, id=301, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v349 = m8.NeuronTensorOp(srcs=[v241, v348], dsts=[v350], op=np.add, xla_op='mhlo.binary', id=302, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2864", line=0, column=0, hlo_id=174))
v351 = m0.OffloadedMemCpy(srcs=[v350], dsts=[v83], dtype=m7.dtype.bfloat16, id=303, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.761", line=0, column=0, hlo_id=175))
v353 = m0.Tensor(name="transpose.84", shape=(1024,1024), parent=v0, id=304, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v352 = m8.NeuronTensorOp(srcs=[v14], dsts=[v353], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=305, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.31", line=0, column=0, hlo_id=178))
v354 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v355 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v354)
v356 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v355)
v357a = m0.AffineAccess(tensor=v83, addrs=[v354, v356])
v357 = m0.AffineLoad(src=v357a, predicates=[], id=306, parent=v356, dl=m1.DebugLocation(tensor_op_name="_dot.17", line=0, column=0, hlo_id=179))
v358a = m0.AffineAccess(tensor=v353, addrs=[v356, v355])
v358 = m0.AffineLoad(src=v358a, predicates=[], id=307, parent=v356, dl=m1.DebugLocation(tensor_op_name="_dot.17", line=0, column=0, hlo_id=179))
v359 = m0.BinaryOp(lhs=v357, rhs=v358, op=np.multiply, id=308, parent=v356, dl=m1.DebugLocation(tensor_op_name="_dot.17", line=0, column=0, hlo_id=179))
v360 = m0.ReduceOp(data=v359, op=np.add, initial=0.0, reduce_axes=[v356], id=309, parent=v356, dl=m1.DebugLocation(tensor_op_name="_dot.17", line=0, column=0, hlo_id=179))
v361a = m0.AffineAccess(tensor=v82, addrs=[v354, v355])
v361 = m0.AffineStore(dst=v361a, src=v360, predicates=[], id=310, parent=v356, dl=m1.DebugLocation(tensor_op_name="_dot.17", line=0, column=0, hlo_id=179))
v362 = m0.OffloadedMemCpy(srcs=[v82], dsts=[v81], dtype=m7.dtype.bfloat16, id=311, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.762", line=0, column=0, hlo_id=180))
v364 = m0.Tensor(name="broadcast_in_dim.145", shape=(1,912,1024), parent=v0, id=312, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v363 = m8.NeuronTensorOp(srcs=[v15], dsts=[v364], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=313, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.959", line=0, column=0, hlo_id=183))
v366 = m0.Tensor(name="add.1480", shape=(1,912,1024), parent=v0, id=314, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v365 = m8.NeuronTensorOp(srcs=[v81, v364], dsts=[v366], op=np.add, xla_op='mhlo.binary', id=315, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2877", line=0, column=0, hlo_id=184))
v367 = m0.OffloadedMemCpy(srcs=[v366], dsts=[v80], dtype=m7.dtype.bfloat16, id=316, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.765", line=0, column=0, hlo_id=185))
v369 = m0.Tensor(name="transpose.85", shape=(1,16,912,64), parent=v0, id=317, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v368 = m8.NeuronTensorOp(srcs=[v80], dsts=[v369], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=318, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.32", line=0, column=0, hlo_id=186))
v370 = m0.OffloadedMemCpy(srcs=[v369], dsts=[v79], dtype=m7.dtype.bfloat16, id=319, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.766", line=0, column=0, hlo_id=187))
v372 = m0.Tensor(name="transpose.86", shape=(1024,1024), parent=v0, id=320, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v371 = m8.NeuronTensorOp(srcs=[v16], dsts=[v372], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=321, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.25", line=0, column=0, hlo_id=191))
v373 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v374 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v373)
v375 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v374)
v376a = m0.AffineAccess(tensor=v83, addrs=[v373, v375])
v376 = m0.AffineLoad(src=v376a, predicates=[], id=322, parent=v375, dl=m1.DebugLocation(tensor_op_name="_dot.14", line=0, column=0, hlo_id=192))
v377a = m0.AffineAccess(tensor=v372, addrs=[v375, v374])
v377 = m0.AffineLoad(src=v377a, predicates=[], id=323, parent=v375, dl=m1.DebugLocation(tensor_op_name="_dot.14", line=0, column=0, hlo_id=192))
v378 = m0.BinaryOp(lhs=v376, rhs=v377, op=np.multiply, id=324, parent=v375, dl=m1.DebugLocation(tensor_op_name="_dot.14", line=0, column=0, hlo_id=192))
v379 = m0.ReduceOp(data=v378, op=np.add, initial=0.0, reduce_axes=[v375], id=325, parent=v375, dl=m1.DebugLocation(tensor_op_name="_dot.14", line=0, column=0, hlo_id=192))
v380a = m0.AffineAccess(tensor=v78, addrs=[v373, v374])
v380 = m0.AffineStore(dst=v380a, src=v379, predicates=[], id=326, parent=v375, dl=m1.DebugLocation(tensor_op_name="_dot.14", line=0, column=0, hlo_id=192))
v381 = m0.OffloadedMemCpy(srcs=[v78], dsts=[v77], dtype=m7.dtype.bfloat16, id=327, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.743", line=0, column=0, hlo_id=193))
v383 = m0.Tensor(name="broadcast_in_dim.146", shape=(1,912,1024), parent=v0, id=328, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v382 = m8.NeuronTensorOp(srcs=[v17], dsts=[v383], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=329, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.944", line=0, column=0, hlo_id=196))
v385 = m0.Tensor(name="add.1481", shape=(1,912,1024), parent=v0, id=330, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v384 = m8.NeuronTensorOp(srcs=[v77, v383], dsts=[v385], op=np.add, xla_op='mhlo.binary', id=331, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2874", line=0, column=0, hlo_id=197))
v387 = m0.Tensor(name="broadcast_in_dim.147", shape=(1,912,1024), parent=v0, id=332, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v386 = m8.NeuronTensorOp(srcs=[v18], dsts=[v387], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=333, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.72239", line=0, column=0, hlo_id=199))
v389 = m0.Tensor(name="divide.20", shape=(1,912,1024), parent=v0, id=334, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v388 = m8.NeuronTensorOp(srcs=[v385, v387], dsts=[v389], op=np.divide, xla_op='mhlo.binary', id=335, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.3361", line=0, column=0, hlo_id=200))
v390 = m0.OffloadedMemCpy(srcs=[v389], dsts=[v76], dtype=m7.dtype.bfloat16, id=336, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.100605", line=0, column=0, hlo_id=201))
v392 = m0.Tensor(name="transpose.87", shape=(1,16,912,64), parent=v0, id=337, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v391 = m8.NeuronTensorOp(srcs=[v76], dsts=[v392], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=338, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.9441", line=0, column=0, hlo_id=202))
v393 = m0.OffloadedMemCpy(srcs=[v392], dsts=[v75], dtype=m7.dtype.bfloat16, id=339, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.96541", line=0, column=0, hlo_id=203))
v395 = m0.Tensor(name="transpose.88", shape=(16,64,912), parent=v0, id=340, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,912), layout="NHC", transpose=(0,1,2)), )
v394 = m8.NeuronTensorOp(srcs=[v75], dsts=[v395], xla_op='mhlo.transpose', src_shape=(16,912,64), permutation=(0,2,1), id=341, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.8611", line=0, column=0, hlo_id=204))
v396 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v397 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v396)
v398 = m0.Axis(lb=0, ub=912, stride=1, it="k", parent=v397)
v399 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v398)
v400a = m0.AffineAccess(tensor=v79, addrs=[v396, v397, v399])
v400 = m0.AffineLoad(src=v400a, predicates=[], id=342, parent=v399, dl=m1.DebugLocation(tensor_op_name="_dot.19", line=0, column=0, hlo_id=205))
v401a = m0.AffineAccess(tensor=v395, addrs=[v396, v399, v398])
v401 = m0.AffineLoad(src=v401a, predicates=[], id=343, parent=v399, dl=m1.DebugLocation(tensor_op_name="_dot.19", line=0, column=0, hlo_id=205))
v402 = m0.BinaryOp(lhs=v400, rhs=v401, op=np.multiply, id=344, parent=v399, dl=m1.DebugLocation(tensor_op_name="_dot.19", line=0, column=0, hlo_id=205))
v403 = m0.ReduceOp(data=v402, op=np.add, initial=0.0, reduce_axes=[v399], id=345, parent=v399, dl=m1.DebugLocation(tensor_op_name="_dot.19", line=0, column=0, hlo_id=205))
v404a = m0.AffineAccess(tensor=v74, addrs=[v396, v397, v398])
v404 = m0.AffineStore(dst=v404a, src=v403, predicates=[], id=346, parent=v399, dl=m1.DebugLocation(tensor_op_name="_dot.19", line=0, column=0, hlo_id=205))
v405 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v406 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v405)
v407a = m0.AffineAccess(tensor=v72, addrs=[])
v407 = m0.AffineLoad(src=v407a, predicates=[], id=347, parent=v406, dl=m1.DebugLocation(tensor_op_name="_broadcast.69170", line=0, column=0, hlo_id=207))
v408a = m0.AffineAccess(tensor=v73, addrs=[v405, v406])
v408 = m0.AffineStore(dst=v408a, src=v407, predicates=[], id=348, parent=v406, dl=m1.DebugLocation(tensor_op_name="_broadcast.69170", line=0, column=0, hlo_id=207))
v410 = m0.Tensor(name="broadcast_in_dim.148", shape=(912,912), parent=v0, id=349, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v409 = m8.NeuronTensorOp(srcs=[v138], dsts=[v410], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=350, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.64675", line=0, column=0, hlo_id=210))
v412 = m0.Tensor(name="add.1482", shape=(912,912), parent=v0, id=351, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v411 = m8.NeuronTensorOp(srcs=[v137, v410], dsts=[v412], op=np.add, xla_op='mhlo.binary', id=352, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.13057", line=0, column=0, hlo_id=211))
v414 = m0.Tensor(name="broadcast_in_dim.149", shape=(912,912), parent=v0, id=353, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v413 = m8.NeuronTensorOp(srcs=[v139], dsts=[v414], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=354, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.69171", line=0, column=0, hlo_id=213))
v415 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v416 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v415)
v417a = m0.AffineAccess(tensor=v73, addrs=[v415, v416])
v417 = m0.AffineLoad(src=v417a, predicates=[], id=355, parent=v416, dl=m1.DebugLocation(tensor_op_name="_clamp.769", line=0, column=0, hlo_id=214))
v418a = m0.AffineAccess(tensor=v414, addrs=[v415, v416])
v418 = m0.AffineLoad(src=v418a, predicates=[], id=356, parent=v416, dl=m1.DebugLocation(tensor_op_name="_clamp.769", line=0, column=0, hlo_id=214))
v419a = m0.AffineAccess(tensor=v412, addrs=[v415, v416])
v419 = m0.AffineLoad(src=v419a, predicates=[], id=357, parent=v416, dl=m1.DebugLocation(tensor_op_name="_clamp.769", line=0, column=0, hlo_id=214))
v420 = m0.BinaryOp(lhs=v417, rhs=v419, op=np.maximum, id=358, parent=v416, dl=m1.DebugLocation(tensor_op_name="_clamp.769", line=0, column=0, hlo_id=214))
v421 = m0.BinaryOp(lhs=v418, rhs=v420, op=np.minimum, id=359, parent=v416, dl=m1.DebugLocation(tensor_op_name="_clamp.769", line=0, column=0, hlo_id=214))
v422a = m0.AffineAccess(tensor=v71, addrs=[v415, v416])
v422 = m0.AffineStore(dst=v422a, src=v421, predicates=[], id=360, parent=v416, dl=m1.DebugLocation(tensor_op_name="_clamp.769", line=0, column=0, hlo_id=214))
v423 = m0.OffloadedMemCast(srcs=[v71], dsts=[v70], dtype="uint32", id=361, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.14459", line=0, column=0, hlo_id=215))
v425 = m0.Tensor(name="broadcast_in_dim.150", shape=(16,912,512,912), parent=v0, id=362, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v424 = m8.NeuronTensorOp(srcs=[v70], dsts=[v425], xla_op='mhlo.broadcast_in_dim', bcdims=[1, 3], id=363, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.960", line=0, column=0, hlo_id=216))
v427 = m0.Tensor(name="iota.15", shape=(16,912,512,912), parent=v0, id=364, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v426 = m0.IotaTensorOp(srcs=[], dsts=[v427], op=m0.iota, shape=(16,912,512,912), iota_dim=2, dtype="uint32", id=365, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.35", line=0, column=0, hlo_id=217))
v429 = m0.Tensor(name="compare.48", shape=(16,912,512,912), parent=v0, id=366, dtype="uint8", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v428 = m8.NeuronTensorOp(srcs=[v425, v427], dsts=[v429], op=np.equal, xla_op='mhlo.binary', id=367, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.73", line=0, column=0, hlo_id=218))
v430 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v431 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v430)
v432a = m0.AffineAccess(tensor=v68, addrs=[])
v432 = m0.AffineLoad(src=v432a, predicates=[], id=368, parent=v431, dl=m1.DebugLocation(tensor_op_name="_broadcast.937", line=0, column=0, hlo_id=220))
v433a = m0.AffineAccess(tensor=v69, addrs=[v430, v431])
v433 = m0.AffineStore(dst=v433a, src=v432, predicates=[], id=369, parent=v431, dl=m1.DebugLocation(tensor_op_name="_broadcast.937", line=0, column=0, hlo_id=220))
v434 = m0.OffloadedMemCast(srcs=[v152], dsts=[v67], dtype="uint32", id=370, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.77", line=0, column=0, hlo_id=221))
v435 = m0.OffloadedMemCpy(srcs=[v67], dsts=[v66], dtype="uint32", id=371, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.727", line=0, column=0, hlo_id=222))
v436 = m0.OffloadedConcat(srcs=[v66, v127, ], dsts=[v65], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=372, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.13", line=0, column=0, hlo_id=224))
v438 = m0.Tensor(name="get_tuple_element.24", shape=(512,1024), parent=v0, id=373, dtype="uint8", view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v439 = m0.Tensor(name="custom_call.33", shape=(2,), parent=v0, id=374, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v437 = m8.NeuronTensorOp(srcs=[v2, v65], dsts=[v438, v439], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=375, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.3", line=0, column=0, hlo_id=371))
v440 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v441 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v440)
v442a = m0.AffineAccess(tensor=v63, addrs=[])
v442 = m0.AffineLoad(src=v442a, predicates=[], id=376, parent=v441, dl=m1.DebugLocation(tensor_op_name="_broadcast.64380", line=0, column=0, hlo_id=240))
v443a = m0.AffineAccess(tensor=v64, addrs=[v440, v441])
v443 = m0.AffineStore(dst=v443a, src=v442, predicates=[], id=377, parent=v441, dl=m1.DebugLocation(tensor_op_name="_broadcast.64380", line=0, column=0, hlo_id=240))
v445 = m0.Tensor(name="select.69", shape=(512,1024), parent=v0, id=378, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v444 = m0.TernaryTensorOp(srcs=[v438, v69, v64], dsts=[v445], op=np.select, id=379, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4930", line=0, column=0, hlo_id=241))
v447 = m0.Tensor(name="subtract.26", shape=(512,1024), parent=v0, id=380, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v446 = m8.NeuronTensorOp(srcs=[v69, v445], dsts=[v447], op=np.subtract, xla_op='mhlo.binary', id=381, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.49", line=0, column=0, hlo_id=242))
v448 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v449 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v448)
v450a = m0.AffineAccess(tensor=v61, addrs=[])
v450 = m0.AffineLoad(src=v450a, predicates=[], id=382, parent=v449, dl=m1.DebugLocation(tensor_op_name="_convert.83", line=0, column=0, hlo_id=243))
v451a = m0.AffineAccess(tensor=v62, addrs=[v448, v449])
v451 = m0.AffineStore(dst=v451a, src=v450, predicates=[], id=383, parent=v449, dl=m1.DebugLocation(tensor_op_name="_convert.83", line=0, column=0, hlo_id=243))
v453 = m0.Tensor(name="compare.49", shape=(512,1024), parent=v0, id=384, dtype="uint8", view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v452 = m8.NeuronTensorOp(srcs=[v447, v62], dsts=[v453], op=np.not_equal, xla_op='mhlo.binary', id=385, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.83", line=0, column=0, hlo_id=243))
v455 = m0.Tensor(name="select.70", shape=(512,1024), parent=v0, id=386, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v454 = m0.TernaryTensorOp(srcs=[v453, v64, v22], dsts=[v455], op=np.select, id=387, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.44", line=0, column=0, hlo_id=247))
v457 = m0.Tensor(name="broadcast_in_dim.151", shape=(512,1024), parent=v0, id=388, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v456 = m8.NeuronTensorOp(srcs=[v12], dsts=[v457], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=389, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.940", line=0, column=0, hlo_id=248))
v459 = m0.Tensor(name="multiply.1440", shape=(512,1024), parent=v0, id=390, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v458 = m8.NeuronTensorOp(srcs=[v455, v457], dsts=[v459], op=np.multiply, xla_op='mhlo.binary', id=391, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1653", line=0, column=0, hlo_id=249))
v460 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v461 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v460)
v462 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v461)
v463a = m0.AffineAccess(tensor=v459, addrs=[v460, v462])
v463 = m0.AffineLoad(src=v463a, predicates=[], id=392, parent=v462, dl=m1.DebugLocation(tensor_op_name="_dot.16", line=0, column=0, hlo_id=252))
v464a = m0.AffineAccess(tensor=v372, addrs=[v462, v461])
v464 = m0.AffineLoad(src=v464a, predicates=[], id=393, parent=v462, dl=m1.DebugLocation(tensor_op_name="_dot.16", line=0, column=0, hlo_id=252))
v465 = m0.BinaryOp(lhs=v463, rhs=v464, op=np.multiply, id=394, parent=v462, dl=m1.DebugLocation(tensor_op_name="_dot.16", line=0, column=0, hlo_id=252))
v466 = m0.ReduceOp(data=v465, op=np.add, initial=0.0, reduce_axes=[v462], id=395, parent=v462, dl=m1.DebugLocation(tensor_op_name="_dot.16", line=0, column=0, hlo_id=252))
v467a = m0.AffineAccess(tensor=v60, addrs=[v460, v461])
v467 = m0.AffineStore(dst=v467a, src=v466, predicates=[], id=396, parent=v462, dl=m1.DebugLocation(tensor_op_name="_dot.16", line=0, column=0, hlo_id=252))
v468 = m0.OffloadedMemCpy(srcs=[v60], dsts=[v59], dtype=m7.dtype.bfloat16, id=397, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.754", line=0, column=0, hlo_id=253))
v470 = m0.Tensor(name="broadcast_in_dim.152", shape=(1,512,1024), parent=v0, id=398, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v469 = m8.NeuronTensorOp(srcs=[v17], dsts=[v470], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=399, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.956", line=0, column=0, hlo_id=255))
v472 = m0.Tensor(name="add.1483", shape=(1,512,1024), parent=v0, id=400, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v471 = m8.NeuronTensorOp(srcs=[v59, v470], dsts=[v472], op=np.add, xla_op='mhlo.binary', id=401, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2876", line=0, column=0, hlo_id=256))
v473 = m0.OffloadedMemCpy(srcs=[v472], dsts=[v58], dtype=m7.dtype.bfloat16, id=402, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.757", line=0, column=0, hlo_id=257))
v475 = m0.Tensor(name="transpose.89", shape=(1,16,512,64), parent=v0, id=403, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,512,64), layout="NHWC", transpose=(0,1,2,3)), )
v474 = m8.NeuronTensorOp(srcs=[v58], dsts=[v475], xla_op='mhlo.transpose', src_shape=(1,512,16,64), permutation=(0,2,1,3), id=404, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.29", line=0, column=0, hlo_id=258))
v476 = m0.OffloadedMemCpy(srcs=[v475], dsts=[v57], dtype=m7.dtype.bfloat16, id=405, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.758", line=0, column=0, hlo_id=259))
v478 = m0.Tensor(name="transpose.90", shape=(16,64,512), parent=v0, id=406, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,512), layout="NHC", transpose=(0,1,2)), )
v477 = m8.NeuronTensorOp(srcs=[v57], dsts=[v478], xla_op='mhlo.transpose', src_shape=(16,512,64), permutation=(0,2,1), id=407, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.30", line=0, column=0, hlo_id=260))
v479 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v480 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v479)
v481 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v480)
v482 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v481)
v483a = m0.AffineAccess(tensor=v79, addrs=[v479, v480, v482])
v483 = m0.AffineLoad(src=v483a, predicates=[], id=408, parent=v482, dl=m1.DebugLocation(tensor_op_name="_dot.18", line=0, column=0, hlo_id=261))
v484a = m0.AffineAccess(tensor=v478, addrs=[v479, v482, v481])
v484 = m0.AffineLoad(src=v484a, predicates=[], id=409, parent=v482, dl=m1.DebugLocation(tensor_op_name="_dot.18", line=0, column=0, hlo_id=261))
v485 = m0.BinaryOp(lhs=v483, rhs=v484, op=np.multiply, id=410, parent=v482, dl=m1.DebugLocation(tensor_op_name="_dot.18", line=0, column=0, hlo_id=261))
v486 = m0.ReduceOp(data=v485, op=np.add, initial=0.0, reduce_axes=[v482], id=411, parent=v482, dl=m1.DebugLocation(tensor_op_name="_dot.18", line=0, column=0, hlo_id=261))
v487a = m0.AffineAccess(tensor=v56, addrs=[v479, v480, v481])
v487 = m0.AffineStore(dst=v487a, src=v486, predicates=[], id=412, parent=v482, dl=m1.DebugLocation(tensor_op_name="_dot.18", line=0, column=0, hlo_id=261))
v489 = m0.Tensor(name="broadcast_in_dim.153", shape=(16,912,512,912), parent=v0, id=413, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v488 = m8.NeuronTensorOp(srcs=[v56], dsts=[v489], xla_op='mhlo.broadcast_in_dim', bcdims=[0, 1, 2], id=414, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.962", line=0, column=0, hlo_id=262))
v490 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v491 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v490)
v492 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v491)
v493 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v492)
v494a = m0.AffineAccess(tensor=v54, addrs=[])
v494 = m0.AffineLoad(src=v494a, predicates=[], id=415, parent=v493, dl=m1.DebugLocation(tensor_op_name="_broadcast.961", line=0, column=0, hlo_id=264))
v495a = m0.AffineAccess(tensor=v55, addrs=[v490, v491, v492, v493])
v495 = m0.AffineStore(dst=v495a, src=v494, predicates=[], id=416, parent=v493, dl=m1.DebugLocation(tensor_op_name="_broadcast.961", line=0, column=0, hlo_id=264))
v497 = m0.Tensor(name="select.71", shape=(16,912,512,912), parent=v0, id=417, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v496 = m0.TernaryTensorOp(srcs=[v429, v489, v55], dsts=[v497], op=np.select, id=418, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.46", line=0, column=0, hlo_id=265))
v499 = m0.Tensor(name="reduce.11", shape=(16,912,912), parent=v0, id=419, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v498 = m0.ReduceTensorOp(srcs=[v497], dsts=[v499], op=np.add, init_value=0.0, reduce_dims=[2,], id=420, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reduce.101", line=0, column=0, hlo_id=267))
v501 = m0.Tensor(name="broadcast_in_dim.154", shape=(16,912,912), parent=v0, id=421, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v500 = m8.NeuronTensorOp(srcs=[v18], dsts=[v501], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=422, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.963", line=0, column=0, hlo_id=268))
v503 = m0.Tensor(name="divide.21", shape=(16,912,912), parent=v0, id=423, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v502 = m8.NeuronTensorOp(srcs=[v499, v501], dsts=[v503], op=np.divide, xla_op='mhlo.binary', id=424, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.39", line=0, column=0, hlo_id=269))
v505 = m0.Tensor(name="negate.6", shape=(912,912), parent=v0, id=425, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v504 = m8.NeuronTensorOp(srcs=[v137], dsts=[v505], op=np.negative, xla_op='mhlo.unary', id=426, parent=v0, dl=m1.DebugLocation(tensor_op_name="_negate.481", line=0, column=0, hlo_id=272))
v507 = m0.Tensor(name="add.1484", shape=(912,912), parent=v0, id=427, dtype="int32", view=m0.TensorView(shape=(912,912), layout="NC", transpose=(0,1)), )
v506 = m8.NeuronTensorOp(srcs=[v505, v410], dsts=[v507], op=np.add, xla_op='mhlo.binary', id=428, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.13441", line=0, column=0, hlo_id=274))
v508 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v509 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v508)
v510a = m0.AffineAccess(tensor=v73, addrs=[v508, v509])
v510 = m0.AffineLoad(src=v510a, predicates=[], id=429, parent=v509, dl=m1.DebugLocation(tensor_op_name="_clamp.1153", line=0, column=0, hlo_id=276))
v511a = m0.AffineAccess(tensor=v414, addrs=[v508, v509])
v511 = m0.AffineLoad(src=v511a, predicates=[], id=430, parent=v509, dl=m1.DebugLocation(tensor_op_name="_clamp.1153", line=0, column=0, hlo_id=276))
v512a = m0.AffineAccess(tensor=v507, addrs=[v508, v509])
v512 = m0.AffineLoad(src=v512a, predicates=[], id=431, parent=v509, dl=m1.DebugLocation(tensor_op_name="_clamp.1153", line=0, column=0, hlo_id=276))
v513 = m0.BinaryOp(lhs=v510, rhs=v512, op=np.maximum, id=432, parent=v509, dl=m1.DebugLocation(tensor_op_name="_clamp.1153", line=0, column=0, hlo_id=276))
v514 = m0.BinaryOp(lhs=v511, rhs=v513, op=np.minimum, id=433, parent=v509, dl=m1.DebugLocation(tensor_op_name="_clamp.1153", line=0, column=0, hlo_id=276))
v515a = m0.AffineAccess(tensor=v53, addrs=[v508, v509])
v515 = m0.AffineStore(dst=v515a, src=v514, predicates=[], id=434, parent=v509, dl=m1.DebugLocation(tensor_op_name="_clamp.1153", line=0, column=0, hlo_id=276))
v516 = m0.OffloadedMemCast(srcs=[v53], dsts=[v52], dtype="uint32", id=435, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.14811", line=0, column=0, hlo_id=277))
v518 = m0.Tensor(name="broadcast_in_dim.155", shape=(16,912,512,912), parent=v0, id=436, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v517 = m8.NeuronTensorOp(srcs=[v52], dsts=[v518], xla_op='mhlo.broadcast_in_dim', bcdims=[1, 3], id=437, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.945", line=0, column=0, hlo_id=278))
v520 = m0.Tensor(name="iota.16", shape=(16,912,512,912), parent=v0, id=438, dtype="uint32", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v519 = m0.IotaTensorOp(srcs=[], dsts=[v520], op=m0.iota, shape=(16,912,512,912), iota_dim=2, dtype="uint32", id=439, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.34", line=0, column=0, hlo_id=279))
v522 = m0.Tensor(name="compare.50", shape=(16,912,512,912), parent=v0, id=440, dtype="uint8", view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v521 = m8.NeuronTensorOp(srcs=[v518, v520], dsts=[v522], op=np.equal, xla_op='mhlo.binary', id=441, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.72", line=0, column=0, hlo_id=280))
v523 = m0.OffloadedMemCpy(srcs=[v385], dsts=[v51], dtype=m7.dtype.bfloat16, id=442, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.746", line=0, column=0, hlo_id=281))
v525 = m0.Tensor(name="transpose.91", shape=(1,16,912,64), parent=v0, id=443, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v524 = m8.NeuronTensorOp(srcs=[v51], dsts=[v525], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=444, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.26", line=0, column=0, hlo_id=282))
v526 = m0.OffloadedMemCpy(srcs=[v525], dsts=[v50], dtype=m7.dtype.bfloat16, id=445, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.747", line=0, column=0, hlo_id=283))
v527 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v528 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v527)
v529 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v528)
v530a = m0.AffineAccess(tensor=v459, addrs=[v527, v529])
v530 = m0.AffineLoad(src=v530a, predicates=[], id=446, parent=v529, dl=m1.DebugLocation(tensor_op_name="_dot.13", line=0, column=0, hlo_id=286))
v531a = m0.AffineAccess(tensor=v353, addrs=[v529, v528])
v531 = m0.AffineLoad(src=v531a, predicates=[], id=447, parent=v529, dl=m1.DebugLocation(tensor_op_name="_dot.13", line=0, column=0, hlo_id=286))
v532 = m0.BinaryOp(lhs=v530, rhs=v531, op=np.multiply, id=448, parent=v529, dl=m1.DebugLocation(tensor_op_name="_dot.13", line=0, column=0, hlo_id=286))
v533 = m0.ReduceOp(data=v532, op=np.add, initial=0.0, reduce_axes=[v529], id=449, parent=v529, dl=m1.DebugLocation(tensor_op_name="_dot.13", line=0, column=0, hlo_id=286))
v534a = m0.AffineAccess(tensor=v49, addrs=[v527, v528])
v534 = m0.AffineStore(dst=v534a, src=v533, predicates=[], id=450, parent=v529, dl=m1.DebugLocation(tensor_op_name="_dot.13", line=0, column=0, hlo_id=286))
v535 = m0.OffloadedMemCpy(srcs=[v49], dsts=[v48], dtype=m7.dtype.bfloat16, id=451, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.735", line=0, column=0, hlo_id=287))
v537 = m0.Tensor(name="broadcast_in_dim.156", shape=(1,512,1024), parent=v0, id=452, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v536 = m8.NeuronTensorOp(srcs=[v15], dsts=[v537], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=453, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.941", line=0, column=0, hlo_id=289))
v539 = m0.Tensor(name="add.1485", shape=(1,512,1024), parent=v0, id=454, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v538 = m8.NeuronTensorOp(srcs=[v48, v537], dsts=[v539], op=np.add, xla_op='mhlo.binary', id=455, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2873", line=0, column=0, hlo_id=290))
v540 = m0.OffloadedMemCpy(srcs=[v539], dsts=[v47], dtype=m7.dtype.bfloat16, id=456, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.738", line=0, column=0, hlo_id=291))
v542 = m0.Tensor(name="transpose.92", shape=(1,16,512,64), parent=v0, id=457, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,512,64), layout="NHWC", transpose=(0,1,2,3)), )
v541 = m8.NeuronTensorOp(srcs=[v47], dsts=[v542], xla_op='mhlo.transpose', src_shape=(1,512,16,64), permutation=(0,2,1,3), id=458, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.23", line=0, column=0, hlo_id=292))
v543 = m0.OffloadedMemCpy(srcs=[v542], dsts=[v46], dtype=m7.dtype.bfloat16, id=459, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.739", line=0, column=0, hlo_id=293))
v545 = m0.Tensor(name="transpose.93", shape=(16,64,512), parent=v0, id=460, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,512), layout="NHC", transpose=(0,1,2)), )
v544 = m8.NeuronTensorOp(srcs=[v46], dsts=[v545], xla_op='mhlo.transpose', src_shape=(16,512,64), permutation=(0,2,1), id=461, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.24", line=0, column=0, hlo_id=294))
v546 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v547 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v546)
v548 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v547)
v549 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v548)
v550a = m0.AffineAccess(tensor=v50, addrs=[v546, v547, v549])
v550 = m0.AffineLoad(src=v550a, predicates=[], id=462, parent=v549, dl=m1.DebugLocation(tensor_op_name="_dot.15", line=0, column=0, hlo_id=295))
v551a = m0.AffineAccess(tensor=v545, addrs=[v546, v549, v548])
v551 = m0.AffineLoad(src=v551a, predicates=[], id=463, parent=v549, dl=m1.DebugLocation(tensor_op_name="_dot.15", line=0, column=0, hlo_id=295))
v552 = m0.BinaryOp(lhs=v550, rhs=v551, op=np.multiply, id=464, parent=v549, dl=m1.DebugLocation(tensor_op_name="_dot.15", line=0, column=0, hlo_id=295))
v553 = m0.ReduceOp(data=v552, op=np.add, initial=0.0, reduce_axes=[v549], id=465, parent=v549, dl=m1.DebugLocation(tensor_op_name="_dot.15", line=0, column=0, hlo_id=295))
v554a = m0.AffineAccess(tensor=v45, addrs=[v546, v547, v548])
v554 = m0.AffineStore(dst=v554a, src=v553, predicates=[], id=466, parent=v549, dl=m1.DebugLocation(tensor_op_name="_dot.15", line=0, column=0, hlo_id=295))
v556 = m0.Tensor(name="broadcast_in_dim.157", shape=(16,912,512,912), parent=v0, id=467, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v555 = m8.NeuronTensorOp(srcs=[v45], dsts=[v556], xla_op='mhlo.broadcast_in_dim', bcdims=[0, 1, 2], id=468, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.947", line=0, column=0, hlo_id=296))
v558 = m0.Tensor(name="select.72", shape=(16,912,512,912), parent=v0, id=469, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,512,912), layout="NHWC", transpose=(0,1,2,3)), )
v557 = m0.TernaryTensorOp(srcs=[v522, v556, v55], dsts=[v558], op=np.select, id=470, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.45", line=0, column=0, hlo_id=299))
v560 = m0.Tensor(name="reduce.12", shape=(16,912,912), parent=v0, id=471, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v559 = m0.ReduceTensorOp(srcs=[v558], dsts=[v560], op=np.add, init_value=0.0, reduce_dims=[2,], id=472, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reduce.100", line=0, column=0, hlo_id=301))
v562 = m0.Tensor(name="divide.22", shape=(16,912,912), parent=v0, id=473, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v561 = m8.NeuronTensorOp(srcs=[v560, v501], dsts=[v562], op=np.divide, xla_op='mhlo.binary', id=474, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.1812", line=0, column=0, hlo_id=303))
v564 = m0.Tensor(name="transpose.94", shape=(16,912,912), parent=v0, id=475, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v563 = m8.NeuronTensorOp(srcs=[v562], dsts=[v564], xla_op='mhlo.transpose', src_shape=(16,912,912), permutation=(0,2,1), id=476, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.8610", line=0, column=0, hlo_id=304))
v566 = m0.Tensor(name="add.1486", shape=(16,912,912), parent=v0, id=477, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v565 = m8.NeuronTensorOp(srcs=[v503, v564], dsts=[v566], op=np.add, xla_op='mhlo.binary', id=478, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2879", line=0, column=0, hlo_id=305))
v568 = m0.Tensor(name="add.1487", shape=(16,912,912), parent=v0, id=479, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,912,912), layout="NHC", transpose=(0,1,2)), )
v567 = m8.NeuronTensorOp(srcs=[v74, v566], dsts=[v568], op=np.add, xla_op='mhlo.binary', id=480, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2880", line=0, column=0, hlo_id=306))
v569 = m0.OffloadedMemCpy(srcs=[v568], dsts=[v44], dtype=m7.dtype.bfloat16, id=481, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.87935", line=0, column=0, hlo_id=307))
v571 = m0.Tensor(name="select.73", shape=(1,16,912,912), parent=v0, id=482, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v570 = m0.TernaryTensorOp(srcs=[v233, v105, v44], dsts=[v571], op=np.select, id=483, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.47", line=0, column=0, hlo_id=308))
v573 = m0.Tensor(name="custom_call.34", shape=(1,16,912,912), parent=v0, id=484, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v572 = m8.NeuronTensorOp(srcs=[v571], dsts=[v573], xla_op="mhlo.custom_call", target_name="AwsNeuronSoftmax", backend_config=3, id=485, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.41", line=0, column=0, hlo_id=319))
v575 = m0.Tensor(name="select.74", shape=(1,16,912,912), parent=v0, id=486, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v574 = m0.TernaryTensorOp(srcs=[v233, v114, v573], dsts=[v575], op=np.select, id=487, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.48", line=0, column=0, hlo_id=320))
v577 = m0.Tensor(name="select.75", shape=(1,16,912,912), parent=v0, id=488, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v576 = m0.TernaryTensorOp(srcs=[v220, v114, v575], dsts=[v577], op=np.select, id=489, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.49", line=0, column=0, hlo_id=321))
v579 = m0.Tensor(name="broadcast_in_dim.158", shape=(1,16,912,912), parent=v0, id=490, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v578 = m8.NeuronTensorOp(srcs=[v12], dsts=[v579], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=491, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.975", line=0, column=0, hlo_id=322))
v581 = m0.Tensor(name="multiply.1441", shape=(1,16,912,912), parent=v0, id=492, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,912), layout="NHWC", transpose=(0,1,2,3)), )
v580 = m8.NeuronTensorOp(srcs=[v577, v579], dsts=[v581], op=np.multiply, xla_op='mhlo.binary', id=493, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1661", line=0, column=0, hlo_id=323))
v582 = m0.OffloadedMemCpy(srcs=[v581], dsts=[v43], dtype=m7.dtype.bfloat16, id=494, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.771", line=0, column=0, hlo_id=324))
v584 = m0.Tensor(name="transpose.95", shape=(1024,1024), parent=v0, id=495, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v583 = m8.NeuronTensorOp(srcs=[v23], dsts=[v584], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=496, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.20", line=0, column=0, hlo_id=328))
v585 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v586 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v585)
v587 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v586)
v588a = m0.AffineAccess(tensor=v83, addrs=[v585, v587])
v588 = m0.AffineLoad(src=v588a, predicates=[], id=497, parent=v587, dl=m1.DebugLocation(tensor_op_name="_dot.12", line=0, column=0, hlo_id=329))
v589a = m0.AffineAccess(tensor=v584, addrs=[v587, v586])
v589 = m0.AffineLoad(src=v589a, predicates=[], id=498, parent=v587, dl=m1.DebugLocation(tensor_op_name="_dot.12", line=0, column=0, hlo_id=329))
v590 = m0.BinaryOp(lhs=v588, rhs=v589, op=np.multiply, id=499, parent=v587, dl=m1.DebugLocation(tensor_op_name="_dot.12", line=0, column=0, hlo_id=329))
v591 = m0.ReduceOp(data=v590, op=np.add, initial=0.0, reduce_axes=[v587], id=500, parent=v587, dl=m1.DebugLocation(tensor_op_name="_dot.12", line=0, column=0, hlo_id=329))
v592a = m0.AffineAccess(tensor=v42, addrs=[v585, v586])
v592 = m0.AffineStore(dst=v592a, src=v591, predicates=[], id=501, parent=v587, dl=m1.DebugLocation(tensor_op_name="_dot.12", line=0, column=0, hlo_id=329))
v593 = m0.OffloadedMemCpy(srcs=[v42], dsts=[v41], dtype=m7.dtype.bfloat16, id=502, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.700", line=0, column=0, hlo_id=330))
v595 = m0.Tensor(name="broadcast_in_dim.159", shape=(1,912,1024), parent=v0, id=503, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v594 = m8.NeuronTensorOp(srcs=[v24], dsts=[v595], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=504, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.901", line=0, column=0, hlo_id=333))
v597 = m0.Tensor(name="add.1488", shape=(1,912,1024), parent=v0, id=505, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v596 = m8.NeuronTensorOp(srcs=[v41, v595], dsts=[v597], op=np.add, xla_op='mhlo.binary', id=506, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2869", line=0, column=0, hlo_id=334))
v598 = m0.OffloadedMemCpy(srcs=[v597], dsts=[v40], dtype=m7.dtype.bfloat16, id=507, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.703", line=0, column=0, hlo_id=335))
v600 = m0.Tensor(name="transpose.96", shape=(1,16,912,64), parent=v0, id=508, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,912,64), layout="NHWC", transpose=(0,1,2,3)), )
v599 = m8.NeuronTensorOp(srcs=[v40], dsts=[v600], xla_op='mhlo.transpose', src_shape=(1,912,16,64), permutation=(0,2,1,3), id=509, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.21", line=0, column=0, hlo_id=336))
v601 = m0.OffloadedMemCpy(srcs=[v600], dsts=[v39], dtype=m7.dtype.bfloat16, id=510, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.704", line=0, column=0, hlo_id=337))
v602 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v603 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v602)
v604 = m0.Axis(lb=0, ub=64, stride=1, it="k", parent=v603)
v605 = m0.Axis(lb=0, ub=912, stride=1, it="m", parent=v604)
v606a = m0.AffineAccess(tensor=v43, addrs=[v602, v603, v605])
v606 = m0.AffineLoad(src=v606a, predicates=[], id=511, parent=v605, dl=m1.DebugLocation(tensor_op_name="_dot.20", line=0, column=0, hlo_id=338))
v607a = m0.AffineAccess(tensor=v39, addrs=[v602, v605, v604])
v607 = m0.AffineLoad(src=v607a, predicates=[], id=512, parent=v605, dl=m1.DebugLocation(tensor_op_name="_dot.20", line=0, column=0, hlo_id=338))
v608 = m0.BinaryOp(lhs=v606, rhs=v607, op=np.multiply, id=513, parent=v605, dl=m1.DebugLocation(tensor_op_name="_dot.20", line=0, column=0, hlo_id=338))
v609 = m0.ReduceOp(data=v608, op=np.add, initial=0.0, reduce_axes=[v605], id=514, parent=v605, dl=m1.DebugLocation(tensor_op_name="_dot.20", line=0, column=0, hlo_id=338))
v610a = m0.AffineAccess(tensor=v38, addrs=[v602, v603, v604])
v610 = m0.AffineStore(dst=v610a, src=v609, predicates=[], id=515, parent=v605, dl=m1.DebugLocation(tensor_op_name="_dot.20", line=0, column=0, hlo_id=338))
v611 = m0.OffloadedMemCpy(srcs=[v38], dsts=[v37], dtype=m7.dtype.bfloat16, id=516, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.772", line=0, column=0, hlo_id=339))
v613 = m0.Tensor(name="transpose.97", shape=(1,912,16,64), parent=v0, id=517, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,16,64), layout="NHWC", transpose=(0,1,2,3)), )
v612 = m8.NeuronTensorOp(srcs=[v37], dsts=[v613], xla_op='mhlo.transpose', src_shape=(1,16,912,64), permutation=(0,2,1,3), id=518, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.35", line=0, column=0, hlo_id=340))
v614 = m0.OffloadedMemCpy(srcs=[v613], dsts=[v36], dtype=m7.dtype.bfloat16, id=519, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.774", line=0, column=0, hlo_id=341))
v616 = m0.Tensor(name="transpose.98", shape=(1024,1024), parent=v0, id=520, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v615 = m8.NeuronTensorOp(srcs=[v25], dsts=[v616], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=521, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.19", line=0, column=0, hlo_id=344))
v617 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v618 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v617)
v619 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v618)
v620a = m0.AffineAccess(tensor=v36, addrs=[v617, v619])
v620 = m0.AffineLoad(src=v620a, predicates=[], id=522, parent=v619, dl=m1.DebugLocation(tensor_op_name="_dot.21", line=0, column=0, hlo_id=345))
v621a = m0.AffineAccess(tensor=v616, addrs=[v619, v618])
v621 = m0.AffineLoad(src=v621a, predicates=[], id=523, parent=v619, dl=m1.DebugLocation(tensor_op_name="_dot.21", line=0, column=0, hlo_id=345))
v622 = m0.BinaryOp(lhs=v620, rhs=v621, op=np.multiply, id=524, parent=v619, dl=m1.DebugLocation(tensor_op_name="_dot.21", line=0, column=0, hlo_id=345))
v623 = m0.ReduceOp(data=v622, op=np.add, initial=0.0, reduce_axes=[v619], id=525, parent=v619, dl=m1.DebugLocation(tensor_op_name="_dot.21", line=0, column=0, hlo_id=345))
v624a = m0.AffineAccess(tensor=v35, addrs=[v617, v618])
v624 = m0.AffineStore(dst=v624a, src=v623, predicates=[], id=526, parent=v619, dl=m1.DebugLocation(tensor_op_name="_dot.21", line=0, column=0, hlo_id=345))
v625 = m0.OffloadedMemCpy(srcs=[v35], dsts=[v34], dtype=m7.dtype.bfloat16, id=527, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.775", line=0, column=0, hlo_id=346))
v627 = m0.Tensor(name="broadcast_in_dim.160", shape=(1,912,1024), parent=v0, id=528, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v626 = m8.NeuronTensorOp(srcs=[v26], dsts=[v627], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=529, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.976", line=0, column=0, hlo_id=349))
v629 = m0.Tensor(name="add.1489", shape=(1,912,1024), parent=v0, id=530, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v628 = m8.NeuronTensorOp(srcs=[v34, v627], dsts=[v629], op=np.add, xla_op='mhlo.binary', id=531, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2881", line=0, column=0, hlo_id=350))
v631 = m0.Tensor(name="select.76", shape=(1,912,1024), parent=v0, id=532, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v630 = m0.TernaryTensorOp(srcs=[v190, v123, v629], dsts=[v631], op=np.select, id=533, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.50", line=0, column=0, hlo_id=351))
v633 = m0.Tensor(name="multiply.1442", shape=(1,912,1024), parent=v0, id=534, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v632 = m8.NeuronTensorOp(srcs=[v631, v304], dsts=[v633], op=np.multiply, xla_op='mhlo.binary', id=535, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1662", line=0, column=0, hlo_id=353))
v635 = m0.Tensor(name="add.1490", shape=(1,912,1024), parent=v0, id=536, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,912,1024), layout="NHC", transpose=(0,1,2)), )
v634 = m8.NeuronTensorOp(srcs=[v633, v350], dsts=[v635], op=np.add, xla_op='mhlo.binary', id=537, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2882", line=0, column=0, hlo_id=354))
v636 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v637 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v636)
v638 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v637)
v639a = m0.AffineAccess(tensor=v635, addrs=[v636, v637, v638])
v639 = m0.AffineLoad(src=v639a, predicates=[], id=538, parent=v638, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v640_v641 = m0.BatchNormMeanVarOp(data=v639, reduce_axes=[v636, v638], id=539, parent=v638, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v640 = m0.ExtractValue(src=v640_v641, idxes=[0], id=540, parent=v638, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v641 = m0.ExtractValue(src=v640_v641, idxes=[1], id=541, parent=v638, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v642a = m0.AffineAccess(tensor=v32, addrs=[v637, 0])
v642 = m0.AffineStore(dst=v642a, src=v640, predicates=[], id=542, parent=v638, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v643a = m0.AffineAccess(tensor=v32, addrs=[v637, 1])
v643 = m0.AffineStore(dst=v643a, src=v641, predicates=[], id=543, parent=v638, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v644 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v645 = m0.Axis(lb=0, ub=912, stride=1, it="j", parent=v644)
v646 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v645)
v647a = m0.AffineAccess(tensor=v635, addrs=[v644, v645, v646])
v647 = m0.AffineLoad(src=v647a, predicates=[], id=544, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v648a = m0.AffineAccess(tensor=v92, addrs=[v645])
v648 = m0.AffineLoad(src=v648a, predicates=[], id=545, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v649a = m0.AffineAccess(tensor=v90, addrs=[v645])
v649 = m0.AffineLoad(src=v649a, predicates=[], id=546, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v650a = m0.AffineAccess(tensor=v29, addrs=[])
v650 = m0.AffineLoad(src=v650a, predicates=[], id=547, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v651a = m0.AffineAccess(tensor=v32, addrs=[v645, 0])
v651 = m0.AffineLoad(src=v651a, predicates=[], id=548, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v652a = m0.AffineAccess(tensor=v32, addrs=[v645, 1])
v652 = m0.AffineLoad(src=v652a, predicates=[], id=549, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v653 = m0.BinaryOp(lhs=v652, rhs=v650, op=np.add, id=550, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v654 = m0.UnaryOp(data=v653, op=m0.rsqrt, id=551, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v655 = m0.BinaryOp(lhs=v647, rhs=v651, op=np.subtract, id=552, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v656 = m0.BinaryOp(lhs=v648, rhs=v655, op=np.multiply, id=553, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v657 = m0.BinaryOp(lhs=v656, rhs=v654, op=np.multiply, id=554, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v658 = m0.BinaryOp(lhs=v657, rhs=v649, op=np.add, id=555, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v659a = m0.AffineAccess(tensor=v33, addrs=[v644, v645, v646])
v659 = m0.AffineStore(dst=v659a, src=v658, predicates=[], id=556, parent=v646, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v660 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v661a = m0.AffineAccess(tensor=v32, addrs=[v660, 0])
v661 = m0.AffineLoad(src=v661a, predicates=[], id=557, parent=v660, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v662a = m0.AffineAccess(tensor=v31, addrs=[v660])
v662 = m0.AffineStore(dst=v662a, src=v661, predicates=[], id=558, parent=v660, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v663 = m0.Axis(lb=0, ub=912, stride=1, it="i", parent=v0)
v664a = m0.AffineAccess(tensor=v32, addrs=[v663, 1])
v664 = m0.AffineLoad(src=v664a, predicates=[], id=559, parent=v663, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v665a = m0.AffineAccess(tensor=v30, addrs=[v663])
v665 = m0.AffineStore(dst=v665a, src=v664, predicates=[], id=560, parent=v663, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.4", line=0, column=0, hlo_id=360))
v666 = m0.OffloadedMemCast(srcs=[v160], dsts=[v28], dtype="int64", id=561, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple.1", line=0, column=0, hlo_id=361))
v667 = m0.OffloadedMemCpy(srcs=[v28], dsts=[v27], dtype="int64", id=562, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=26))
v0.markOutput(v27)
v0.markOutput(v33)
v0.id=563
ir=v0
