import neuroncc.starfish.penguin.ir.ir as m0
import neuroncc.starfish.penguin.ir.DebugInfo as m1
import neuroncc.starfish.penguin.targets.tonga.APIndex as m2
import neuroncc.starfish.penguin.targets.tonga.TongaInst as m3
import neuroncc.starfish.penguin.targets.tonga.TongaISAInst as m4
import neuroncc.starfish.penguin.targets.tonga.TongaTensor as m5
import numpy as np
v0 = m0.Function(id_=0, batch_ids=[], attrs=("model-type=compute-bound","mac-count=13560709120",))
def weight_load(p):
  t = np.load(p)
  return t
import neuroncc.starfish.support as m7
v1 = m0.Tensor(name="intermediate1417", shape=(), parent=v0, id=1, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v1)
v2 = m0.Tensor(name="input44", shape=(), parent=v0, id=2, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v2)
v3 = m0.Tensor(name="intermediate1373", shape=(1,1,816,816), parent=v0, id=3, dtype="int64", view=m0.TensorView(shape=(1,1,816,816), layout="NHWC", transpose=(0,1,2,3)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v3)
v4 = m0.Tensor(name="input374", shape=(1024,), parent=v0, id=4, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v4, is_parameter_tensor=True)
v5 = m0.Tensor(name="input367", shape=(1024,), parent=v0, id=5, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v5, is_parameter_tensor=True)
v6 = m0.Tensor(name="intermediate1418", shape=(1,816,1024), parent=v0, id=6, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v6)
v7 = m0.Tensor(name="input366", shape=(1024,), parent=v0, id=7, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v7, is_parameter_tensor=True)
v8 = m0.Tensor(name="input364", shape=(4096,1024), parent=v0, id=8, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(4096,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v8, is_parameter_tensor=True)
v9 = m0.Tensor(name="input365", shape=(4096,), parent=v0, id=9, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(4096,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v9, is_parameter_tensor=True)
v10 = m0.Tensor(name="input368", shape=(1024,4096), parent=v0, id=10, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,4096), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v10, is_parameter_tensor=True)
v11 = m0.Tensor(name="input369", shape=(1024,), parent=v0, id=11, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v11, is_parameter_tensor=True)
v12 = m0.Tensor(name="input42", shape=(), parent=v0, id=12, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v12)
v13 = m0.Tensor(name="input370", shape=(1024,), parent=v0, id=13, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v13, is_parameter_tensor=True)
v14 = m0.Tensor(name="input371", shape=(1024,1024), parent=v0, id=14, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v14, is_parameter_tensor=True)
v15 = m0.Tensor(name="input375", shape=(1024,), parent=v0, id=15, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v15, is_parameter_tensor=True)
v16 = m0.Tensor(name="input373", shape=(1024,1024), parent=v0, id=16, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v16, is_parameter_tensor=True)
v17 = m0.Tensor(name="input372", shape=(1024,), parent=v0, id=17, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v17, is_parameter_tensor=True)
v18 = m0.Tensor(name="input54", shape=(), parent=v0, id=18, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v18)
v19 = m0.Tensor(name="intermediate1374", shape=(816,816), parent=v0, id=19, dtype="int64", view=m0.TensorView(shape=(816,816), layout="NC", transpose=(0,1)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v19)
v20 = m0.Tensor(name="input56", shape=(), parent=v0, id=20, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v20)
v21 = m0.Tensor(name="input55", shape=(), parent=v0, id=21, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'CrossPassTensor': ""})
v0.markInput(v21)
v22 = m0.Tensor(name="intermediate1375", shape=(512,1024), parent=v0, id=22, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), attrs={'IntermediateTensor':  "" , 'CrossPassTensor': ""})
v0.markInput(v22)
v23 = m0.Tensor(name="input377", shape=(1024,1024), parent=v0, id=23, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v23, is_parameter_tensor=True)
v24 = m0.Tensor(name="input376", shape=(1024,), parent=v0, id=24, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v24, is_parameter_tensor=True)
v25 = m0.Tensor(name="input378", shape=(1024,1024), parent=v0, id=25, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), attrs={'CrossPassTensor': ""})
v0.markInput(v25, is_parameter_tensor=True)
v26 = m0.Tensor(name="input379", shape=(1024,), parent=v0, id=26, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,), layout="N", transpose=(0,)), attrs={'CrossPassTensor': ""})
v0.markInput(v26, is_parameter_tensor=True)
v27 = m0.Tensor(name="intermediate1433", shape=(16,512,64,), parent=v0, id=27, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), attrs={'IntermediateTensor':  "" })
v28 = m0.Tensor(name="intermediate1432", shape=(816,816,), parent=v0, id=28, dtype="int64", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), attrs={'IntermediateTensor':  "" })
v29 = m0.Tensor(name="intermediate1431", shape=(16,512,64,), parent=v0, id=29, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), attrs={'IntermediateTensor':  "" })
v30 = m0.Tensor(name="intermediate1430", shape=(816,816,), parent=v0, id=30, dtype="int64", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), attrs={'IntermediateTensor':  "" })
v31 = m0.Tensor(name="intermediate1429", shape=(16,816,64,), parent=v0, id=31, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,64,), layout="NHC", transpose=(0,1,2,)), attrs={'IntermediateTensor':  "" })
v32 = m0.Tensor(name="intermediate1419", shape=(), parent=v0, id=32, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), attrs={'IntermediateTensor':  "" })
v33 = m0.Tensor(name="_tuple_2_hlo_id_389__mhlo.convert_1702", shape=(816,816,), parent=v0, id=33, dtype="int64", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v34 = m0.Tensor(name="_tuple_2_hlo_id_389__mhlo.convert_1701", shape=(816,816,), parent=v0, id=34, dtype="int64", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v35 = m0.Tensor(name="_tuple_2_hlo_id_389__mhlo.convert_1700", shape=(), parent=v0, id=35, dtype="int64", view=m0.TensorView(shape=(), layout="", transpose=()), )
v36 = m0.Tensor(name="eps__batch_norm_training_96_hlo_id_364__mhlo.batch_norm_training_1699", shape=(), parent=v0, id=36, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_eps__batch_norm_training_96_hlo_id_364__mhlo.batch_norm_training_1699.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v37 = m0.Tensor(name="intermediate1440", shape=(816,), parent=v0, id=37, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,), layout="N", transpose=(0,)), attrs={'IntermediateTensor':  "" })
v38 = m0.Tensor(name="intermediate1439", shape=(816,), parent=v0, id=38, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,), layout="N", transpose=(0,)), attrs={'IntermediateTensor':  "" })
v39 = m0.Tensor(name="mean_var__batch_norm_training_96_hlo_id_364__mhlo.batch_norm_training_1696", shape=(816,2,), parent=v0, id=39, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,2,), layout="NC", transpose=(0,1,)), )
v40 = m0.Tensor(name="intermediate1438", shape=(1,816,1024,), parent=v0, id=40, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), attrs={'IntermediateTensor':  "" })
v41 = m0.Tensor(name="_reshape_6466_hlo_id_348__mhlo.reshape_1694", shape=(1,816,1024,), parent=v0, id=41, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v42 = m0.Tensor(name="_dot_589_hlo_id_347__39", shape=(816,1024,), parent=v0, id=42, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v43 = m0.Tensor(name="_reshape_6465_hlo_id_343__mhlo.reshape_1693", shape=(816,1024,), parent=v0, id=43, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v44 = m0.Tensor(name="_reshape_6463_hlo_id_341__mhlo.reshape_1692", shape=(1,16,816,64,), parent=v0, id=44, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v45 = m0.Tensor(name="_dot_588_hlo_id_340__38", shape=(16,816,64,), parent=v0, id=45, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,64,), layout="NHC", transpose=(0,1,2,)), )
v46 = m0.Tensor(name="_reshape_6461_hlo_id_339__mhlo.reshape_1691", shape=(16,816,64,), parent=v0, id=46, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,64,), layout="NHC", transpose=(0,1,2,)), )
v47 = m0.Tensor(name="_reshape_6460_hlo_id_337__mhlo.reshape_1690", shape=(1,816,16,64,), parent=v0, id=47, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v48 = m0.Tensor(name="_reshape_6462_hlo_id_326__mhlo.reshape_1689", shape=(16,816,816,), parent=v0, id=48, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816,), layout="NHC", transpose=(0,1,2,)), )
v49 = m0.Tensor(name="_reshape_6434_hlo_id_332__mhlo.reshape_1688", shape=(1,816,1024,), parent=v0, id=49, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v50 = m0.Tensor(name="_dot_587_hlo_id_331__37", shape=(816,1024,), parent=v0, id=50, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v51 = m0.Tensor(name="_reshape_86876_hlo_id_309__mhlo.reshape_1687", shape=(1,16,816,816,), parent=v0, id=51, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v52 = m0.Tensor(name="_dot_582_hlo_id_297__36", shape=(16,816,512,), parent=v0, id=52, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,512,), layout="NHC", transpose=(0,1,2,)), )
v53 = m0.Tensor(name="_reshape_6402_hlo_id_285__mhlo.reshape_1686", shape=(16,816,64,), parent=v0, id=53, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,64,), layout="NHC", transpose=(0,1,2,)), )
v54 = m0.Tensor(name="_reshape_6401_hlo_id_283__mhlo.reshape_1685", shape=(1,816,16,64,), parent=v0, id=54, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v55 = m0.Tensor(name="_convert_12621_hlo_id_279__mhlo.convert_1684", shape=(816,816,), parent=v0, id=55, dtype="uint32", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v56 = m0.Tensor(name="in__broadcast_7022_hlo_id_266__mhlo.constant_1683", shape=(), parent=v0, id=56, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_7022_hlo_id_266__mhlo.constant_1683.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v57 = m0.Tensor(name="_broadcast_7022_hlo_id_266__mhlo.constant_1682", shape=(16,816,512,816,), parent=v0, id=57, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,512,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v58 = m0.Tensor(name="_dot_585_hlo_id_263__35", shape=(16,816,512,), parent=v0, id=58, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,512,), layout="NHC", transpose=(0,1,2,)), )
v59 = m0.Tensor(name="_convert_12620_hlo_id_217__mhlo.convert_1681", shape=(816,816,), parent=v0, id=59, dtype="uint32", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v60 = m0.Tensor(name="_dot_586_hlo_id_207__34", shape=(16,816,816,), parent=v0, id=60, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816,), layout="NHC", transpose=(0,1,2,)), )
v61 = m0.Tensor(name="_reshape_6421_hlo_id_189__mhlo.reshape_1680", shape=(16,816,64,), parent=v0, id=61, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,64,), layout="NHC", transpose=(0,1,2,)), )
v62 = m0.Tensor(name="_reshape_6420_hlo_id_187__mhlo.reshape_1679", shape=(1,816,16,64,), parent=v0, id=62, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v63 = m0.Tensor(name="in__broadcast_7028_hlo_id_96__mhlo.constant_1678", shape=(), parent=v0, id=63, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_7028_hlo_id_96__mhlo.constant_1678.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v64 = m0.Tensor(name="_broadcast_7028_hlo_id_96__mhlo.constant_1677", shape=(1,16,816,816,), parent=v0, id=64, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v65 = m0.Tensor(name="_constant_6948_hlo_id_95__mhlo.constant_1676", shape=(), parent=v0, id=65, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_6948_hlo_id_95__mhlo.constant_1676.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v66 = m0.Tensor(name="_reshape_95487_hlo_id_89__mhlo.reshape_1675", shape=(816,816,), parent=v0, id=66, dtype="uint8", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v67 = m0.Tensor(name="in__broadcast_6976_hlo_id_86__mhlo.constant_1672", shape=(), parent=v0, id=67, dtype="int32", value=weight_load("./constant_in__broadcast_6976_hlo_id_86__mhlo.constant_1672.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v68 = m0.Tensor(name="_broadcast_6976_hlo_id_86__mhlo.constant_1671", shape=(1,1,816,816,), parent=v0, id=68, dtype="int32", view=m0.TensorView(shape=(1,1,816,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v69 = m0.Tensor(name="_reshape_6399_hlo_id_295__mhlo.reshape_1670", shape=(16,512,64,), parent=v0, id=69, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), )
v70 = m0.Tensor(name="_reshape_6398_hlo_id_293__mhlo.reshape_1669", shape=(1,512,16,64,), parent=v0, id=70, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v71 = m0.Tensor(name="_reshape_6395_hlo_id_289__mhlo.reshape_1668", shape=(1,512,1024,), parent=v0, id=71, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v72 = m0.Tensor(name="_dot_581_hlo_id_288__33", shape=(512,1024,), parent=v0, id=72, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v73 = m0.Tensor(name="mhlo_clamp_32", shape=(816,816,), parent=v0, id=73, dtype="int32", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v74 = m0.Tensor(name="_reshape_6413_hlo_id_261__mhlo.reshape_1667", shape=(16,512,64,), parent=v0, id=74, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,512,64,), layout="NHC", transpose=(0,1,2,)), )
v75 = m0.Tensor(name="_reshape_6412_hlo_id_259__mhlo.reshape_1666", shape=(1,512,16,64,), parent=v0, id=75, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v76 = m0.Tensor(name="_reshape_6409_hlo_id_255__mhlo.reshape_1665", shape=(1,512,1024,), parent=v0, id=76, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024,), layout="NHC", transpose=(0,1,2,)), )
v77 = m0.Tensor(name="_dot_583_hlo_id_254__31", shape=(512,1024,), parent=v0, id=77, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v78 = m0.Tensor(name="in__convert_1442_hlo_id_245__mhlo.constant_1664", shape=(), parent=v0, id=78, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_1442_hlo_id_245__mhlo.constant_1664.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v79 = m0.Tensor(name="_convert_1442_hlo_id_245__mhlo.constant_1663", shape=(512,1024,), parent=v0, id=79, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v80 = m0.Tensor(name="in__broadcast_63874_hlo_id_242__mhlo.constant_1662", shape=(), parent=v0, id=80, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_63874_hlo_id_242__mhlo.constant_1662.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v81 = m0.Tensor(name="_broadcast_63874_hlo_id_242__mhlo.constant_1661", shape=(512,1024,), parent=v0, id=81, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v82 = m0.Tensor(name="_concatenate_463_hlo_id_226__mhlo.concatenate_1660", shape=(2,), parent=v0, id=82, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v83 = m0.Tensor(name="_reshape_6387_hlo_id_224__mhlo.reshape_1659", shape=(1,), parent=v0, id=83, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v84 = m0.Tensor(name="_convert_1436_hlo_id_223__mhlo.convert_1658", shape=(), parent=v0, id=84, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v85 = m0.Tensor(name="in__broadcast_7001_hlo_id_222__mhlo.constant_1657", shape=(), parent=v0, id=85, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_7001_hlo_id_222__mhlo.constant_1657.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v86 = m0.Tensor(name="_broadcast_7001_hlo_id_222__mhlo.constant_1656", shape=(512,1024,), parent=v0, id=86, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024,), layout="NC", transpose=(0,1,)), )
v87 = m0.Tensor(name="mhlo_clamp_30", shape=(816,816,), parent=v0, id=87, dtype="int32", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v88 = m0.Tensor(name="in__broadcast_69305_hlo_id_209__mhlo.constant_1655", shape=(), parent=v0, id=88, dtype="int32", value=weight_load("./constant_in__broadcast_69305_hlo_id_209__mhlo.constant_1655.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v89 = m0.Tensor(name="_broadcast_69305_hlo_id_209__mhlo.constant_1654", shape=(816,816,), parent=v0, id=89, dtype="int32", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v90 = m0.Tensor(name="_constant_6922_hlo_id_85__mhlo.constant_1653", shape=(), parent=v0, id=90, dtype="int32", value=weight_load("./constant__constant_6922_hlo_id_85__mhlo.constant_1653.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v91 = m0.Tensor(name="_reshape_96586_hlo_id_205__mhlo.reshape_1652", shape=(16,816,64,), parent=v0, id=91, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,64,), layout="NHC", transpose=(0,1,2,)), )
v92 = m0.Tensor(name="_reshape_100650_hlo_id_203__mhlo.reshape_1651", shape=(1,816,16,64,), parent=v0, id=92, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,16,64,), layout="NHWC", transpose=(0,1,2,3,)), )
v93 = m0.Tensor(name="_reshape_6368_hlo_id_195__mhlo.reshape_1650", shape=(1,816,1024,), parent=v0, id=93, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v94 = m0.Tensor(name="_dot_580_hlo_id_194__29", shape=(816,1024,), parent=v0, id=94, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v95 = m0.Tensor(name="_reshape_6417_hlo_id_182__mhlo.reshape_1649", shape=(1,816,1024,), parent=v0, id=95, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v96 = m0.Tensor(name="_dot_584_hlo_id_181__28", shape=(816,1024,), parent=v0, id=96, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v97 = m0.Tensor(name="_reshape_6416_hlo_id_177__mhlo.reshape_1648", shape=(816,1024,), parent=v0, id=97, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v98 = m0.Tensor(name="eps__batch_norm_training_95_hlo_id_170__mhlo.batch_norm_training_1647", shape=(), parent=v0, id=98, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_eps__batch_norm_training_95_hlo_id_170__mhlo.batch_norm_training_1647.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v99 = m0.Tensor(name="intermediate1427", shape=(816,), parent=v0, id=99, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,), layout="N", transpose=(0,)), attrs={'IntermediateTensor':  "" })
v100 = m0.Tensor(name="intermediate1426", shape=(816,), parent=v0, id=100, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,), layout="N", transpose=(0,)), attrs={'IntermediateTensor':  "" })
v101 = m0.Tensor(name="mean_var__batch_norm_training_95_hlo_id_170__mhlo.batch_norm_training_1644", shape=(816,2,), parent=v0, id=101, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,2,), layout="NC", transpose=(0,1,)), )
v102 = m0.Tensor(name="_batch_norm_training_95_hlo_id_170__mhlo.batch_norm_training_1643", shape=(1,816,1024,), parent=v0, id=102, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v103 = m0.Tensor(name="in__broadcast_6949_hlo_id_167__mhlo.constant_1642", shape=(), parent=v0, id=103, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_6949_hlo_id_167__mhlo.constant_1642.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v104 = m0.Tensor(name="_broadcast_6949_hlo_id_167__mhlo.constant_1641", shape=(816,), parent=v0, id=104, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,), layout="N", transpose=(0,)), )
v105 = m0.Tensor(name="in__broadcast_6951_hlo_id_165__mhlo.constant_1640", shape=(), parent=v0, id=105, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_6951_hlo_id_165__mhlo.constant_1640.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v106 = m0.Tensor(name="_broadcast_6951_hlo_id_165__mhlo.constant_1639", shape=(816,), parent=v0, id=106, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,), layout="N", transpose=(0,)), )
v107 = m0.Tensor(name="_reshape_6354_hlo_id_154__mhlo.reshape_1638", shape=(1,816,1024,), parent=v0, id=107, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v108 = m0.Tensor(name="_dot_579_hlo_id_153__27", shape=(816,1024,), parent=v0, id=108, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v109 = m0.Tensor(name="_reshape_6353_hlo_id_149__mhlo.reshape_1637", shape=(816,4096,), parent=v0, id=109, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,4096,), layout="NC", transpose=(0,1,)), )
v110 = m0.Tensor(name="_reshape_6330_hlo_id_143__mhlo.reshape_1636", shape=(1,816,4096,), parent=v0, id=110, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,4096,), layout="NHC", transpose=(0,1,2,)), )
v111 = m0.Tensor(name="_dot_578_hlo_id_142__26", shape=(816,4096,), parent=v0, id=111, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,4096,), layout="NC", transpose=(0,1,)), )
v112 = m0.Tensor(name="_reshape_6329_hlo_id_138__mhlo.reshape_1635", shape=(816,1024,), parent=v0, id=112, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(816,1024,), layout="NC", transpose=(0,1,)), )
v113 = m0.Tensor(name="in__convert_1435_hlo_id_124__mhlo.constant_1634", shape=(), parent=v0, id=113, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_1435_hlo_id_124__mhlo.constant_1634.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v114 = m0.Tensor(name="_convert_1435_hlo_id_124__mhlo.constant_1633", shape=(1,816,1024,), parent=v0, id=114, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v115 = m0.Tensor(name="_concatenate_462_hlo_id_105__mhlo.concatenate_1632", shape=(2,), parent=v0, id=115, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v116 = m0.Tensor(name="_reshape_6335_hlo_id_103__mhlo.reshape_1631", shape=(1,), parent=v0, id=116, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v117 = m0.Tensor(name="_convert_1429_hlo_id_102__mhlo.convert_1630", shape=(), parent=v0, id=117, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v118 = m0.Tensor(name="in__convert_1451_hlo_id_81__mhlo.constant_1629", shape=(), parent=v0, id=118, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_1451_hlo_id_81__mhlo.constant_1629.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v119 = m0.Tensor(name="_convert_1451_hlo_id_81__mhlo.constant_1628", shape=(1,16,816,816,), parent=v0, id=119, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v120 = m0.Tensor(name="in__broadcast_63866_hlo_id_78__mhlo.constant_1627", shape=(), parent=v0, id=120, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_63866_hlo_id_78__mhlo.constant_1627.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v121 = m0.Tensor(name="_broadcast_63866_hlo_id_78__mhlo.constant_1626", shape=(1,16,816,816,), parent=v0, id=121, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v122 = m0.Tensor(name="_concatenate_470_hlo_id_62__mhlo.concatenate_1625", shape=(2,), parent=v0, id=122, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v123 = m0.Tensor(name="_reshape_6425_hlo_id_60__mhlo.reshape_1624", shape=(1,), parent=v0, id=123, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v124 = m0.Tensor(name="_convert_1445_hlo_id_59__mhlo.convert_1623", shape=(), parent=v0, id=124, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v125 = m0.Tensor(name="in__broadcast_7042_hlo_id_58__mhlo.constant_1622", shape=(), parent=v0, id=125, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_7042_hlo_id_58__mhlo.constant_1622.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v126 = m0.Tensor(name="_broadcast_7042_hlo_id_58__mhlo.constant_1621", shape=(1,16,816,816,), parent=v0, id=126, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v127 = m0.Tensor(name="in__convert_1458_hlo_id_54__mhlo.constant_1620", shape=(), parent=v0, id=127, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__convert_1458_hlo_id_54__mhlo.constant_1620.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v128 = m0.Tensor(name="_convert_1458_hlo_id_54__mhlo.constant_1619", shape=(1,816,1024,), parent=v0, id=128, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v129 = m0.Tensor(name="in__broadcast_63861_hlo_id_51__mhlo.constant_1618", shape=(), parent=v0, id=129, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_63861_hlo_id_51__mhlo.constant_1618.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v130 = m0.Tensor(name="_broadcast_63861_hlo_id_51__mhlo.constant_1617", shape=(1,816,1024,), parent=v0, id=130, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v131 = m0.Tensor(name="_constant_20956_hlo_id_50__mhlo.constant_1616", shape=(), parent=v0, id=131, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_20956_hlo_id_50__mhlo.constant_1616.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v132 = m0.Tensor(name="_concatenate_471_hlo_id_34__mhlo.concatenate_1615", shape=(2,), parent=v0, id=132, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v133 = m0.Tensor(name="in__constant_62678_hlo_id_33__mhlo.constant_1614", shape=(), parent=v0, id=133, dtype="uint32", value=weight_load("./constant_in__constant_62678_hlo_id_33__mhlo.constant_1614.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v134 = m0.Tensor(name="_constant_62678_hlo_id_33__mhlo.constant_1613", shape=(1,), parent=v0, id=134, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v135 = m0.Tensor(name="_reshape_6441_hlo_id_32__mhlo.reshape_1612", shape=(1,), parent=v0, id=135, dtype="uint32", view=m0.TensorView(shape=(1,), layout="N", transpose=(0,)), )
v136 = m0.Tensor(name="_convert_1452_hlo_id_31__mhlo.convert_1611", shape=(), parent=v0, id=136, dtype="uint32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v137 = m0.Tensor(name="in__broadcast_7055_hlo_id_13__mhlo.constant_1610", shape=(), parent=v0, id=137, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant_in__broadcast_7055_hlo_id_13__mhlo.constant_1610.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v138 = m0.Tensor(name="_broadcast_7055_hlo_id_13__mhlo.constant_1609", shape=(1,816,1024,), parent=v0, id=138, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024,), layout="NHC", transpose=(0,1,2,)), )
v139 = m0.Tensor(name="_constant_62677_hlo_id_12__mhlo.constant_1608", shape=(), parent=v0, id=139, dtype=m7.dtype.bfloat16, value=m7.dtype.static_cast(weight_load("./constant__constant_62677_hlo_id_12__mhlo.constant_1608.lit.npy"), dtype=np.float32), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v140 = m0.Tensor(name="_constant_3292_hlo_id_20__mhlo.constant_1607", shape=(), parent=v0, id=140, dtype="int32", value=weight_load("./constant__constant_3292_hlo_id_20__mhlo.constant_1607.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v141 = m0.Tensor(name="_constant_3297_hlo_id_14__mhlo.constant_1606", shape=(), parent=v0, id=141, dtype="int32", value=weight_load("./constant__constant_3297_hlo_id_14__mhlo.constant_1606.lit.npy"), init_value=None, view=m0.TensorView(shape=(), layout="", transpose=()), )
v142 = m0.Tensor(name="mlir_function_hlo_id_365__mhlo.convert_1605", shape=(), parent=v0, id=142, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v143 = m0.Tensor(name="mlir_function_hlo_id_365__mhlo.convert_1604", shape=(1,1,816,816,), parent=v0, id=143, dtype="int32", view=m0.TensorView(shape=(1,1,816,816,), layout="NHWC", transpose=(0,1,2,3,)), )
v144 = m0.Tensor(name="mlir_function_hlo_id_365__mhlo.convert_1603", shape=(816,816,), parent=v0, id=144, dtype="int32", view=m0.TensorView(shape=(816,816,), layout="NC", transpose=(0,1,)), )
v145 = m0.Tensor(name="mlir_function_hlo_id_365__mhlo.convert_1602", shape=(), parent=v0, id=145, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v146 = m0.Tensor(name="mlir_function_hlo_id_365__mhlo.convert_1601", shape=(), parent=v0, id=146, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v147 = m0.OffloadedMemCast(srcs=[v21], dsts=[v146], dtype="int32", id=147, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=365))
v148 = m0.OffloadedMemCast(srcs=[v20], dsts=[v145], dtype="int32", id=148, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=365))
v149 = m0.OffloadedMemCast(srcs=[v19], dsts=[v144], dtype="int32", id=149, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=365))
v150 = m0.OffloadedMemCast(srcs=[v3], dsts=[v143], dtype="int32", id=150, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=365))
v151 = m0.OffloadedMemCast(srcs=[v1], dsts=[v142], dtype="int32", id=151, parent=v0, dl=m1.DebugLocation(tensor_op_name="mlir.function", line=0, column=0, hlo_id=365))
v153 = m0.Tensor(name="multiply.1397", shape=(), parent=v0, id=152, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
import neuroncc.starfish.penguin.frontends.XlaFE as m8
v152 = m8.NeuronTensorOp(srcs=[v141, v142], dsts=[v153], op=np.multiply, xla_op='mhlo.binary', id=153, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1572", line=0, column=0, hlo_id=19))
v155 = m0.Tensor(name="add.1411", shape=(), parent=v0, id=154, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v154 = m8.NeuronTensorOp(srcs=[v153, v140], dsts=[v155], op=np.add, xla_op='mhlo.binary', id=155, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2821", line=0, column=0, hlo_id=21))
v157 = m0.Tensor(name="multiply.1398", shape=(), parent=v0, id=156, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v156 = m8.NeuronTensorOp(srcs=[v141, v155], dsts=[v157], op=np.multiply, xla_op='mhlo.binary', id=157, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1573", line=0, column=0, hlo_id=22))
v159 = m0.Tensor(name="add.1412", shape=(), parent=v0, id=158, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v158 = m8.NeuronTensorOp(srcs=[v157, v140], dsts=[v159], op=np.add, xla_op='mhlo.binary', id=159, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2822", line=0, column=0, hlo_id=24))
v161 = m0.Tensor(name="multiply.1399", shape=(), parent=v0, id=160, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v160 = m8.NeuronTensorOp(srcs=[v141, v159], dsts=[v161], op=np.multiply, xla_op='mhlo.binary', id=161, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1574", line=0, column=0, hlo_id=25))
v163 = m0.Tensor(name="add.1413", shape=(), parent=v0, id=162, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v162 = m8.NeuronTensorOp(srcs=[v161, v140], dsts=[v163], op=np.add, xla_op='mhlo.binary', id=163, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2823", line=0, column=0, hlo_id=27))
v165 = m0.Tensor(name="multiply.1400", shape=(), parent=v0, id=164, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v164 = m8.NeuronTensorOp(srcs=[v141, v163], dsts=[v165], op=np.multiply, xla_op='mhlo.binary', id=165, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.1575", line=0, column=0, hlo_id=28))
v167 = m0.Tensor(name="add.1414", shape=(), parent=v0, id=166, dtype="int32", view=m0.TensorView(shape=(), layout="", transpose=()), )
v166 = m8.NeuronTensorOp(srcs=[v165, v140], dsts=[v167], op=np.add, xla_op='mhlo.binary', id=167, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.2824", line=0, column=0, hlo_id=30))
v168 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v169 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v168)
v170 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v169)
v171a = m0.AffineAccess(tensor=v137, addrs=[])
v171 = m0.AffineLoad(src=v171a, predicates=[], id=168, parent=v170, dl=m1.DebugLocation(tensor_op_name="_broadcast.7055", line=0, column=0, hlo_id=13))
v172a = m0.AffineAccess(tensor=v138, addrs=[v168, v169, v170])
v172 = m0.AffineStore(dst=v172a, src=v171, predicates=[], id=169, parent=v170, dl=m1.DebugLocation(tensor_op_name="_broadcast.7055", line=0, column=0, hlo_id=13))
v173 = m0.OffloadedMemCast(srcs=[v167], dsts=[v136], dtype="uint32", id=170, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1452", line=0, column=0, hlo_id=31))
v174 = m0.OffloadedMemCpy(srcs=[v136], dsts=[v135], dtype="uint32", id=171, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6441", line=0, column=0, hlo_id=32))
v175 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v176a = m0.AffineAccess(tensor=v133, addrs=[])
v176 = m0.AffineLoad(src=v176a, predicates=[], id=172, parent=v175, dl=m1.DebugLocation(tensor_op_name="_constant.62678", line=0, column=0, hlo_id=33))
v177a = m0.AffineAccess(tensor=v134, addrs=[v175])
v177 = m0.AffineStore(dst=v177a, src=v176, predicates=[], id=173, parent=v175, dl=m1.DebugLocation(tensor_op_name="_constant.62678", line=0, column=0, hlo_id=33))
v178 = m0.OffloadedConcat(srcs=[v135, v134, ], dsts=[v132], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=174, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.471", line=0, column=0, hlo_id=34))
v180 = m0.Tensor(name="get_tuple_element.9", shape=(1,816,1024), parent=v0, id=175, dtype="uint8", view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v181 = m0.Tensor(name="custom_call.12", shape=(2,), parent=v0, id=176, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v179 = m8.NeuronTensorOp(srcs=[v2, v132], dsts=[v180, v181], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=177, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call", line=0, column=0, hlo_id=390))
v182 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v183 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v182)
v184 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v183)
v185a = m0.AffineAccess(tensor=v129, addrs=[])
v185 = m0.AffineLoad(src=v185a, predicates=[], id=178, parent=v184, dl=m1.DebugLocation(tensor_op_name="_broadcast.63861", line=0, column=0, hlo_id=51))
v186a = m0.AffineAccess(tensor=v130, addrs=[v182, v183, v184])
v186 = m0.AffineStore(dst=v186a, src=v185, predicates=[], id=179, parent=v184, dl=m1.DebugLocation(tensor_op_name="_broadcast.63861", line=0, column=0, hlo_id=51))
v188 = m0.Tensor(name="select.27", shape=(1,816,1024), parent=v0, id=180, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v187 = m0.TernaryTensorOp(srcs=[v180, v138, v130], dsts=[v188], op=np.select, id=181, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4853", line=0, column=0, hlo_id=52))
v190 = m0.Tensor(name="subtract.10", shape=(1,816,1024), parent=v0, id=182, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v189 = m8.NeuronTensorOp(srcs=[v138, v188], dsts=[v190], op=np.subtract, xla_op='mhlo.binary', id=183, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.466", line=0, column=0, hlo_id=53))
v191 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v192 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v191)
v193 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v192)
v194a = m0.AffineAccess(tensor=v127, addrs=[])
v194 = m0.AffineLoad(src=v194a, predicates=[], id=184, parent=v193, dl=m1.DebugLocation(tensor_op_name="_convert.1458", line=0, column=0, hlo_id=54))
v195a = m0.AffineAccess(tensor=v128, addrs=[v191, v192, v193])
v195 = m0.AffineStore(dst=v195a, src=v194, predicates=[], id=185, parent=v193, dl=m1.DebugLocation(tensor_op_name="_convert.1458", line=0, column=0, hlo_id=54))
v197 = m0.Tensor(name="compare.19", shape=(1,816,1024), parent=v0, id=186, dtype="uint8", view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v196 = m8.NeuronTensorOp(srcs=[v190, v128], dsts=[v197], op=np.not_equal, xla_op='mhlo.binary', id=187, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1458", line=0, column=0, hlo_id=54))
v198 = m0.Tensor(name="intermediate1420", shape=(1,816,1024), parent=v0, id=188, dtype="uint8", view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v199 = m0.OffloadedMemCpy(srcs=[v197], dsts=[v198], dtype="uint8", id=189, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v200 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v201 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v200)
v202 = m0.Axis(lb=0, ub=816, stride=1, it="k", parent=v201)
v203 = m0.Axis(lb=0, ub=816, stride=1, it="m", parent=v202)
v204a = m0.AffineAccess(tensor=v125, addrs=[])
v204 = m0.AffineLoad(src=v204a, predicates=[], id=190, parent=v203, dl=m1.DebugLocation(tensor_op_name="_broadcast.7042", line=0, column=0, hlo_id=58))
v205a = m0.AffineAccess(tensor=v126, addrs=[v200, v201, v202, v203])
v205 = m0.AffineStore(dst=v205a, src=v204, predicates=[], id=191, parent=v203, dl=m1.DebugLocation(tensor_op_name="_broadcast.7042", line=0, column=0, hlo_id=58))
v206 = m0.OffloadedMemCast(srcs=[v163], dsts=[v124], dtype="uint32", id=192, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1445", line=0, column=0, hlo_id=59))
v207 = m0.OffloadedMemCpy(srcs=[v124], dsts=[v123], dtype="uint32", id=193, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6425", line=0, column=0, hlo_id=60))
v208 = m0.OffloadedConcat(srcs=[v123, v134, ], dsts=[v122], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=194, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.470", line=0, column=0, hlo_id=62))
v210 = m0.Tensor(name="get_tuple_element.10", shape=(1,16,816,816), parent=v0, id=195, dtype="uint8", view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v211 = m0.Tensor(name="custom_call.13", shape=(2,), parent=v0, id=196, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v209 = m8.NeuronTensorOp(srcs=[v2, v122], dsts=[v210, v211], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=197, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.1", line=0, column=0, hlo_id=393))
v212 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v213 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v212)
v214 = m0.Axis(lb=0, ub=816, stride=1, it="k", parent=v213)
v215 = m0.Axis(lb=0, ub=816, stride=1, it="m", parent=v214)
v216a = m0.AffineAccess(tensor=v120, addrs=[])
v216 = m0.AffineLoad(src=v216a, predicates=[], id=198, parent=v215, dl=m1.DebugLocation(tensor_op_name="_broadcast.63866", line=0, column=0, hlo_id=78))
v217a = m0.AffineAccess(tensor=v121, addrs=[v212, v213, v214, v215])
v217 = m0.AffineStore(dst=v217a, src=v216, predicates=[], id=199, parent=v215, dl=m1.DebugLocation(tensor_op_name="_broadcast.63866", line=0, column=0, hlo_id=78))
v219 = m0.Tensor(name="select.28", shape=(1,16,816,816), parent=v0, id=200, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v218 = m0.TernaryTensorOp(srcs=[v210, v126, v121], dsts=[v219], op=np.select, id=201, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4854", line=0, column=0, hlo_id=79))
v221 = m0.Tensor(name="subtract.11", shape=(1,16,816,816), parent=v0, id=202, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v220 = m8.NeuronTensorOp(srcs=[v126, v219], dsts=[v221], op=np.subtract, xla_op='mhlo.binary', id=203, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.464", line=0, column=0, hlo_id=80))
v222 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v223 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v222)
v224 = m0.Axis(lb=0, ub=816, stride=1, it="k", parent=v223)
v225 = m0.Axis(lb=0, ub=816, stride=1, it="m", parent=v224)
v226a = m0.AffineAccess(tensor=v118, addrs=[])
v226 = m0.AffineLoad(src=v226a, predicates=[], id=204, parent=v225, dl=m1.DebugLocation(tensor_op_name="_convert.1451", line=0, column=0, hlo_id=81))
v227a = m0.AffineAccess(tensor=v119, addrs=[v222, v223, v224, v225])
v227 = m0.AffineStore(dst=v227a, src=v226, predicates=[], id=205, parent=v225, dl=m1.DebugLocation(tensor_op_name="_convert.1451", line=0, column=0, hlo_id=81))
v229 = m0.Tensor(name="compare.20", shape=(1,16,816,816), parent=v0, id=206, dtype="uint8", view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v228 = m8.NeuronTensorOp(srcs=[v221, v119], dsts=[v229], op=np.not_equal, xla_op='mhlo.binary', id=207, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1451", line=0, column=0, hlo_id=81))
v230 = m0.Tensor(name="intermediate1421", shape=(1,16,816,816), parent=v0, id=208, dtype="uint8", view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), attrs={'IntermediateTensor':  "" })
v231 = m0.OffloadedMemCpy(srcs=[v229], dsts=[v230], dtype="uint8", id=209, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v232 = m0.OffloadedMemCast(srcs=[v155], dsts=[v117], dtype="uint32", id=210, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1429", line=0, column=0, hlo_id=102))
v233 = m0.OffloadedMemCpy(srcs=[v117], dsts=[v116], dtype="uint32", id=211, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6335", line=0, column=0, hlo_id=103))
v234 = m0.OffloadedConcat(srcs=[v116, v134, ], dsts=[v115], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=212, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.462", line=0, column=0, hlo_id=105))
v236 = m0.Tensor(name="get_tuple_element.11", shape=(1,816,1024), parent=v0, id=213, dtype="uint8", view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v237 = m0.Tensor(name="custom_call.14", shape=(2,), parent=v0, id=214, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v235 = m8.NeuronTensorOp(srcs=[v2, v115], dsts=[v236, v237], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=215, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.2", line=0, column=0, hlo_id=396))
v239 = m0.Tensor(name="select.29", shape=(1,816,1024), parent=v0, id=216, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v238 = m0.TernaryTensorOp(srcs=[v236, v138, v130], dsts=[v239], op=np.select, id=217, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4764", line=0, column=0, hlo_id=122))
v241 = m0.Tensor(name="subtract.12", shape=(1,816,1024), parent=v0, id=218, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v240 = m8.NeuronTensorOp(srcs=[v138, v239], dsts=[v241], op=np.subtract, xla_op='mhlo.binary', id=219, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.459", line=0, column=0, hlo_id=123))
v242 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v243 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v242)
v244 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v243)
v245a = m0.AffineAccess(tensor=v113, addrs=[])
v245 = m0.AffineLoad(src=v245a, predicates=[], id=220, parent=v244, dl=m1.DebugLocation(tensor_op_name="_convert.1435", line=0, column=0, hlo_id=124))
v246a = m0.AffineAccess(tensor=v114, addrs=[v242, v243, v244])
v246 = m0.AffineStore(dst=v246a, src=v245, predicates=[], id=221, parent=v244, dl=m1.DebugLocation(tensor_op_name="_convert.1435", line=0, column=0, hlo_id=124))
v248 = m0.Tensor(name="compare.21", shape=(1,816,1024), parent=v0, id=222, dtype="uint8", view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v247 = m8.NeuronTensorOp(srcs=[v241, v114], dsts=[v248], op=np.not_equal, xla_op='mhlo.binary', id=223, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1435", line=0, column=0, hlo_id=124))
v249 = m0.Tensor(name="intermediate1422", shape=(1,816,1024), parent=v0, id=224, dtype="uint8", view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v250 = m0.OffloadedMemCpy(srcs=[v248], dsts=[v249], dtype="uint8", id=225, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v252 = m0.Tensor(name="broadcast_in_dim.57", shape=(1,816,1024), parent=v0, id=226, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v251 = m8.NeuronTensorOp(srcs=[v5], dsts=[v252], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=227, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6932", line=0, column=0, hlo_id=129))
v254 = m0.Tensor(name="broadcast_in_dim.58", shape=(1,816,1024), parent=v0, id=228, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v253 = m8.NeuronTensorOp(srcs=[v7], dsts=[v254], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=229, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6930", line=0, column=0, hlo_id=135))
v256 = m0.Tensor(name="multiply.1401", shape=(1,816,1024), parent=v0, id=230, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v255 = m8.NeuronTensorOp(srcs=[v6, v254], dsts=[v256], op=np.multiply, xla_op='mhlo.binary', id=231, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.3357", line=0, column=0, hlo_id=136))
v258 = m0.Tensor(name="add.1415", shape=(1,816,1024), parent=v0, id=232, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v257 = m8.NeuronTensorOp(srcs=[v252, v256], dsts=[v258], op=np.add, xla_op='mhlo.binary', id=233, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4011", line=0, column=0, hlo_id=137))
v259 = m0.OffloadedMemCpy(srcs=[v258], dsts=[v112], dtype=m7.dtype.bfloat16, id=234, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6329", line=0, column=0, hlo_id=138))
v261 = m0.Tensor(name="transpose.33", shape=(1024,4096), parent=v0, id=235, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,4096), layout="NC", transpose=(0,1)), )
v260 = m8.NeuronTensorOp(srcs=[v8], dsts=[v261], xla_op='mhlo.transpose', src_shape=(4096,1024), permutation=(1,0), id=236, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.937", line=0, column=0, hlo_id=141))
v262 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v263 = m0.Axis(lb=0, ub=4096, stride=1, it="j", parent=v262)
v264 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v263)
v265a = m0.AffineAccess(tensor=v112, addrs=[v262, v264])
v265 = m0.AffineLoad(src=v265a, predicates=[], id=237, parent=v264, dl=m1.DebugLocation(tensor_op_name="_dot.578", line=0, column=0, hlo_id=142))
v266a = m0.AffineAccess(tensor=v261, addrs=[v264, v263])
v266 = m0.AffineLoad(src=v266a, predicates=[], id=238, parent=v264, dl=m1.DebugLocation(tensor_op_name="_dot.578", line=0, column=0, hlo_id=142))
v267 = m0.BinaryOp(lhs=v265, rhs=v266, op=np.multiply, id=239, parent=v264, dl=m1.DebugLocation(tensor_op_name="_dot.578", line=0, column=0, hlo_id=142))
v268 = m0.ReduceOp(data=v267, op=np.add, initial=0.0, reduce_axes=[v264], id=240, parent=v264, dl=m1.DebugLocation(tensor_op_name="_dot.578", line=0, column=0, hlo_id=142))
v269a = m0.AffineAccess(tensor=v111, addrs=[v262, v263])
v269 = m0.AffineStore(dst=v269a, src=v268, predicates=[], id=241, parent=v264, dl=m1.DebugLocation(tensor_op_name="_dot.578", line=0, column=0, hlo_id=142))
v270 = m0.OffloadedMemCpy(srcs=[v111], dsts=[v110], dtype=m7.dtype.bfloat16, id=242, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6330", line=0, column=0, hlo_id=143))
v272 = m0.Tensor(name="broadcast_in_dim.59", shape=(1,816,4096), parent=v0, id=243, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,4096), layout="NHC", transpose=(0,1,2)), )
v271 = m8.NeuronTensorOp(srcs=[v9], dsts=[v272], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=244, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6933", line=0, column=0, hlo_id=146))
v274 = m0.Tensor(name="add.1416", shape=(1,816,4096), parent=v0, id=245, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,4096), layout="NHC", transpose=(0,1,2)), )
v273 = m8.NeuronTensorOp(srcs=[v110, v272], dsts=[v274], op=np.add, xla_op='mhlo.binary', id=246, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4012", line=0, column=0, hlo_id=147))
v275 = m0.Tensor(name="intermediate1424", shape=(1,816,4096), parent=v0, id=247, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,4096), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v276 = m0.OffloadedMemCpy(srcs=[v274], dsts=[v275], dtype=m7.dtype.bfloat16, id=248, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v278 = m0.Tensor(name="custom_call.15", shape=(1,816,4096), parent=v0, id=249, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,4096), layout="NHC", transpose=(0,1,2)), )
v277 = m8.NeuronTensorOp(srcs=[v274], dsts=[v278], xla_op="mhlo.custom_call", target_name="AwsNeuronGelu", backend_config=None, id=250, parent=v0, dl=m1.DebugLocation(tensor_op_name="_custom-call.17460", line=0, column=0, hlo_id=148))
v279 = m0.OffloadedMemCpy(srcs=[v278], dsts=[v109], dtype=m7.dtype.bfloat16, id=251, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6353", line=0, column=0, hlo_id=149))
v281 = m0.Tensor(name="transpose.34", shape=(4096,1024), parent=v0, id=252, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(4096,1024), layout="NC", transpose=(0,1)), )
v280 = m8.NeuronTensorOp(srcs=[v10], dsts=[v281], xla_op='mhlo.transpose', src_shape=(1024,4096), permutation=(1,0), id=253, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.940", line=0, column=0, hlo_id=152))
v282 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v283 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v282)
v284 = m0.Axis(lb=0, ub=4096, stride=1, it="k", parent=v283)
v285a = m0.AffineAccess(tensor=v109, addrs=[v282, v284])
v285 = m0.AffineLoad(src=v285a, predicates=[], id=254, parent=v284, dl=m1.DebugLocation(tensor_op_name="_dot.579", line=0, column=0, hlo_id=153))
v286a = m0.AffineAccess(tensor=v281, addrs=[v284, v283])
v286 = m0.AffineLoad(src=v286a, predicates=[], id=255, parent=v284, dl=m1.DebugLocation(tensor_op_name="_dot.579", line=0, column=0, hlo_id=153))
v287 = m0.BinaryOp(lhs=v285, rhs=v286, op=np.multiply, id=256, parent=v284, dl=m1.DebugLocation(tensor_op_name="_dot.579", line=0, column=0, hlo_id=153))
v288 = m0.ReduceOp(data=v287, op=np.add, initial=0.0, reduce_axes=[v284], id=257, parent=v284, dl=m1.DebugLocation(tensor_op_name="_dot.579", line=0, column=0, hlo_id=153))
v289a = m0.AffineAccess(tensor=v108, addrs=[v282, v283])
v289 = m0.AffineStore(dst=v289a, src=v288, predicates=[], id=258, parent=v284, dl=m1.DebugLocation(tensor_op_name="_dot.579", line=0, column=0, hlo_id=153))
v290 = m0.OffloadedMemCpy(srcs=[v108], dsts=[v107], dtype=m7.dtype.bfloat16, id=259, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6354", line=0, column=0, hlo_id=154))
v292 = m0.Tensor(name="broadcast_in_dim.60", shape=(1,816,1024), parent=v0, id=260, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v291 = m8.NeuronTensorOp(srcs=[v11], dsts=[v292], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=261, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6956", line=0, column=0, hlo_id=157))
v294 = m0.Tensor(name="add.1417", shape=(1,816,1024), parent=v0, id=262, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v293 = m8.NeuronTensorOp(srcs=[v107, v292], dsts=[v294], op=np.add, xla_op='mhlo.binary', id=263, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4014", line=0, column=0, hlo_id=158))
v296 = m0.Tensor(name="select.30", shape=(1,816,1024), parent=v0, id=264, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v295 = m0.TernaryTensorOp(srcs=[v248, v130, v294], dsts=[v296], op=np.select, id=265, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.422", line=0, column=0, hlo_id=159))
v298 = m0.Tensor(name="broadcast_in_dim.61", shape=(1,816,1024), parent=v0, id=266, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v297 = m8.NeuronTensorOp(srcs=[v12], dsts=[v298], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=267, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6959", line=0, column=0, hlo_id=161))
v300 = m0.Tensor(name="multiply.1402", shape=(1,816,1024), parent=v0, id=268, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v299 = m8.NeuronTensorOp(srcs=[v296, v298], dsts=[v300], op=np.multiply, xla_op='mhlo.binary', id=269, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.3363", line=0, column=0, hlo_id=162))
v302 = m0.Tensor(name="add.1418", shape=(1,816,1024), parent=v0, id=270, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v301 = m8.NeuronTensorOp(srcs=[v300, v258], dsts=[v302], op=np.add, xla_op='mhlo.binary', id=271, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4015", line=0, column=0, hlo_id=163))
v303 = m0.Tensor(name="intermediate1425", shape=(1,816,1024), parent=v0, id=272, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v304 = m0.OffloadedMemCpy(srcs=[v302], dsts=[v303], dtype=m7.dtype.bfloat16, id=273, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v305 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v306a = m0.AffineAccess(tensor=v105, addrs=[])
v306 = m0.AffineLoad(src=v306a, predicates=[], id=274, parent=v305, dl=m1.DebugLocation(tensor_op_name="_broadcast.6951", line=0, column=0, hlo_id=165))
v307a = m0.AffineAccess(tensor=v106, addrs=[v305])
v307 = m0.AffineStore(dst=v307a, src=v306, predicates=[], id=275, parent=v305, dl=m1.DebugLocation(tensor_op_name="_broadcast.6951", line=0, column=0, hlo_id=165))
v308 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v309a = m0.AffineAccess(tensor=v103, addrs=[])
v309 = m0.AffineLoad(src=v309a, predicates=[], id=276, parent=v308, dl=m1.DebugLocation(tensor_op_name="_broadcast.6949", line=0, column=0, hlo_id=167))
v310a = m0.AffineAccess(tensor=v104, addrs=[v308])
v310 = m0.AffineStore(dst=v310a, src=v309, predicates=[], id=277, parent=v308, dl=m1.DebugLocation(tensor_op_name="_broadcast.6949", line=0, column=0, hlo_id=167))
v311 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v312 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v311)
v313 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v312)
v314a = m0.AffineAccess(tensor=v302, addrs=[v311, v312, v313])
v314 = m0.AffineLoad(src=v314a, predicates=[], id=278, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v315_v316 = m0.BatchNormMeanVarOp(data=v314, reduce_axes=[v311, v313], id=279, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v315 = m0.ExtractValue(src=v315_v316, idxes=[0], id=280, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v316 = m0.ExtractValue(src=v315_v316, idxes=[1], id=281, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v317a = m0.AffineAccess(tensor=v101, addrs=[v312, 0])
v317 = m0.AffineStore(dst=v317a, src=v315, predicates=[], id=282, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v318a = m0.AffineAccess(tensor=v101, addrs=[v312, 1])
v318 = m0.AffineStore(dst=v318a, src=v316, predicates=[], id=283, parent=v313, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v319 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v320 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v319)
v321 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v320)
v322a = m0.AffineAccess(tensor=v302, addrs=[v319, v320, v321])
v322 = m0.AffineLoad(src=v322a, predicates=[], id=284, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v323a = m0.AffineAccess(tensor=v106, addrs=[v320])
v323 = m0.AffineLoad(src=v323a, predicates=[], id=285, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v324a = m0.AffineAccess(tensor=v104, addrs=[v320])
v324 = m0.AffineLoad(src=v324a, predicates=[], id=286, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v325a = m0.AffineAccess(tensor=v98, addrs=[])
v325 = m0.AffineLoad(src=v325a, predicates=[], id=287, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v326a = m0.AffineAccess(tensor=v101, addrs=[v320, 0])
v326 = m0.AffineLoad(src=v326a, predicates=[], id=288, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v327a = m0.AffineAccess(tensor=v101, addrs=[v320, 1])
v327 = m0.AffineLoad(src=v327a, predicates=[], id=289, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v328 = m0.BinaryOp(lhs=v327, rhs=v325, op=np.add, id=290, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
import scipy.special as m9
v329 = m0.UnaryOp(data=v328, op=m0.rsqrt, id=291, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v330 = m0.BinaryOp(lhs=v322, rhs=v326, op=np.subtract, id=292, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v331 = m0.BinaryOp(lhs=v323, rhs=v330, op=np.multiply, id=293, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v332 = m0.BinaryOp(lhs=v331, rhs=v329, op=np.multiply, id=294, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v333 = m0.BinaryOp(lhs=v332, rhs=v324, op=np.add, id=295, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v334a = m0.AffineAccess(tensor=v102, addrs=[v319, v320, v321])
v334 = m0.AffineStore(dst=v334a, src=v333, predicates=[], id=296, parent=v321, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v335 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v336a = m0.AffineAccess(tensor=v101, addrs=[v335, 0])
v336 = m0.AffineLoad(src=v336a, predicates=[], id=297, parent=v335, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v337a = m0.AffineAccess(tensor=v100, addrs=[v335])
v337 = m0.AffineStore(dst=v337a, src=v336, predicates=[], id=298, parent=v335, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v338 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v339a = m0.AffineAccess(tensor=v101, addrs=[v338, 1])
v339 = m0.AffineLoad(src=v339a, predicates=[], id=299, parent=v338, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v340a = m0.AffineAccess(tensor=v99, addrs=[v338])
v340 = m0.AffineStore(dst=v340a, src=v339, predicates=[], id=300, parent=v338, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.95", line=0, column=0, hlo_id=170))
v342 = m0.Tensor(name="broadcast_in_dim.62", shape=(1,816,1024), parent=v0, id=301, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v341 = m8.NeuronTensorOp(srcs=[v4], dsts=[v342], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=302, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6973", line=0, column=0, hlo_id=99))
v344 = m0.Tensor(name="broadcast_in_dim.63", shape=(1,816,1024), parent=v0, id=303, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v343 = m8.NeuronTensorOp(srcs=[v13], dsts=[v344], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=304, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6971", line=0, column=0, hlo_id=174))
v346 = m0.Tensor(name="multiply.1403", shape=(1,816,1024), parent=v0, id=305, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v345 = m8.NeuronTensorOp(srcs=[v102, v344], dsts=[v346], op=np.multiply, xla_op='mhlo.binary', id=306, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.3367", line=0, column=0, hlo_id=175))
v348 = m0.Tensor(name="add.1419", shape=(1,816,1024), parent=v0, id=307, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v347 = m8.NeuronTensorOp(srcs=[v342, v346], dsts=[v348], op=np.add, xla_op='mhlo.binary', id=308, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4017", line=0, column=0, hlo_id=176))
v349 = m0.OffloadedMemCpy(srcs=[v348], dsts=[v97], dtype=m7.dtype.bfloat16, id=309, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6416", line=0, column=0, hlo_id=177))
v351 = m0.Tensor(name="transpose.35", shape=(1024,1024), parent=v0, id=310, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v350 = m8.NeuronTensorOp(srcs=[v14], dsts=[v351], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=311, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.955", line=0, column=0, hlo_id=180))
v352 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v353 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v352)
v354 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v353)
v355a = m0.AffineAccess(tensor=v97, addrs=[v352, v354])
v355 = m0.AffineLoad(src=v355a, predicates=[], id=312, parent=v354, dl=m1.DebugLocation(tensor_op_name="_dot.584", line=0, column=0, hlo_id=181))
v356a = m0.AffineAccess(tensor=v351, addrs=[v354, v353])
v356 = m0.AffineLoad(src=v356a, predicates=[], id=313, parent=v354, dl=m1.DebugLocation(tensor_op_name="_dot.584", line=0, column=0, hlo_id=181))
v357 = m0.BinaryOp(lhs=v355, rhs=v356, op=np.multiply, id=314, parent=v354, dl=m1.DebugLocation(tensor_op_name="_dot.584", line=0, column=0, hlo_id=181))
v358 = m0.ReduceOp(data=v357, op=np.add, initial=0.0, reduce_axes=[v354], id=315, parent=v354, dl=m1.DebugLocation(tensor_op_name="_dot.584", line=0, column=0, hlo_id=181))
v359a = m0.AffineAccess(tensor=v96, addrs=[v352, v353])
v359 = m0.AffineStore(dst=v359a, src=v358, predicates=[], id=316, parent=v354, dl=m1.DebugLocation(tensor_op_name="_dot.584", line=0, column=0, hlo_id=181))
v360 = m0.OffloadedMemCpy(srcs=[v96], dsts=[v95], dtype=m7.dtype.bfloat16, id=317, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6417", line=0, column=0, hlo_id=182))
v362 = m0.Tensor(name="broadcast_in_dim.64", shape=(1,816,1024), parent=v0, id=318, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v361 = m8.NeuronTensorOp(srcs=[v15], dsts=[v362], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=319, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7020", line=0, column=0, hlo_id=185))
v364 = m0.Tensor(name="add.1420", shape=(1,816,1024), parent=v0, id=320, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v363 = m8.NeuronTensorOp(srcs=[v95, v362], dsts=[v364], op=np.add, xla_op='mhlo.binary', id=321, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4024", line=0, column=0, hlo_id=186))
v365 = m0.Tensor(name="intermediate1428", shape=(1,816,1024), parent=v0, id=322, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v366 = m0.OffloadedMemCpy(srcs=[v364], dsts=[v365], dtype=m7.dtype.bfloat16, id=323, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v368 = m0.Tensor(name="transpose.36", shape=(1024,1024), parent=v0, id=324, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v367 = m8.NeuronTensorOp(srcs=[v16], dsts=[v368], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=325, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.943", line=0, column=0, hlo_id=193))
v369 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v370 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v369)
v371 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v370)
v372a = m0.AffineAccess(tensor=v97, addrs=[v369, v371])
v372 = m0.AffineLoad(src=v372a, predicates=[], id=326, parent=v371, dl=m1.DebugLocation(tensor_op_name="_dot.580", line=0, column=0, hlo_id=194))
v373a = m0.AffineAccess(tensor=v368, addrs=[v371, v370])
v373 = m0.AffineLoad(src=v373a, predicates=[], id=327, parent=v371, dl=m1.DebugLocation(tensor_op_name="_dot.580", line=0, column=0, hlo_id=194))
v374 = m0.BinaryOp(lhs=v372, rhs=v373, op=np.multiply, id=328, parent=v371, dl=m1.DebugLocation(tensor_op_name="_dot.580", line=0, column=0, hlo_id=194))
v375 = m0.ReduceOp(data=v374, op=np.add, initial=0.0, reduce_axes=[v371], id=329, parent=v371, dl=m1.DebugLocation(tensor_op_name="_dot.580", line=0, column=0, hlo_id=194))
v376a = m0.AffineAccess(tensor=v94, addrs=[v369, v370])
v376 = m0.AffineStore(dst=v376a, src=v375, predicates=[], id=330, parent=v371, dl=m1.DebugLocation(tensor_op_name="_dot.580", line=0, column=0, hlo_id=194))
v377 = m0.OffloadedMemCpy(srcs=[v94], dsts=[v93], dtype=m7.dtype.bfloat16, id=331, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6368", line=0, column=0, hlo_id=195))
v379 = m0.Tensor(name="broadcast_in_dim.65", shape=(1,816,1024), parent=v0, id=332, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v378 = m8.NeuronTensorOp(srcs=[v17], dsts=[v379], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=333, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.6974", line=0, column=0, hlo_id=198))
v381 = m0.Tensor(name="add.1421", shape=(1,816,1024), parent=v0, id=334, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v380 = m8.NeuronTensorOp(srcs=[v93, v379], dsts=[v381], op=np.add, xla_op='mhlo.binary', id=335, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4018", line=0, column=0, hlo_id=199))
v383 = m0.Tensor(name="broadcast_in_dim.66", shape=(1,816,1024), parent=v0, id=336, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v382 = m8.NeuronTensorOp(srcs=[v18], dsts=[v383], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=337, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.72284", line=0, column=0, hlo_id=201))
v385 = m0.Tensor(name="divide.9", shape=(1,816,1024), parent=v0, id=338, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v384 = m8.NeuronTensorOp(srcs=[v381, v383], dsts=[v385], op=np.divide, xla_op='mhlo.binary', id=339, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.3406", line=0, column=0, hlo_id=202))
v386 = m0.OffloadedMemCpy(srcs=[v385], dsts=[v92], dtype=m7.dtype.bfloat16, id=340, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.100650", line=0, column=0, hlo_id=203))
v388 = m0.Tensor(name="transpose.37", shape=(1,16,816,64), parent=v0, id=341, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,64), layout="NHWC", transpose=(0,1,2,3)), )
v387 = m8.NeuronTensorOp(srcs=[v92], dsts=[v388], xla_op='mhlo.transpose', src_shape=(1,816,16,64), permutation=(0,2,1,3), id=342, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.9486", line=0, column=0, hlo_id=204))
v389 = m0.OffloadedMemCpy(srcs=[v388], dsts=[v91], dtype=m7.dtype.bfloat16, id=343, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.96586", line=0, column=0, hlo_id=205))
v390 = m0.OffloadedMemCpy(srcs=[v91], dsts=[v31], dtype=m7.dtype.bfloat16, id=344, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v391 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v392 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v391)
v393a = m0.AffineAccess(tensor=v88, addrs=[])
v393 = m0.AffineLoad(src=v393a, predicates=[], id=345, parent=v392, dl=m1.DebugLocation(tensor_op_name="_broadcast.69305", line=0, column=0, hlo_id=209))
v394a = m0.AffineAccess(tensor=v89, addrs=[v391, v392])
v394 = m0.AffineStore(dst=v394a, src=v393, predicates=[], id=346, parent=v392, dl=m1.DebugLocation(tensor_op_name="_broadcast.69305", line=0, column=0, hlo_id=209))
v396 = m0.Tensor(name="broadcast_in_dim.67", shape=(816,816), parent=v0, id=347, dtype="int32", view=m0.TensorView(shape=(816,816), layout="NC", transpose=(0,1)), )
v395 = m8.NeuronTensorOp(srcs=[v145], dsts=[v396], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=348, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.64823", line=0, column=0, hlo_id=212))
v398 = m0.Tensor(name="add.1422", shape=(816,816), parent=v0, id=349, dtype="int32", view=m0.TensorView(shape=(816,816), layout="NC", transpose=(0,1)), )
v397 = m8.NeuronTensorOp(srcs=[v144, v396], dsts=[v398], op=np.add, xla_op='mhlo.binary', id=350, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.13102", line=0, column=0, hlo_id=213))
v400 = m0.Tensor(name="broadcast_in_dim.68", shape=(816,816), parent=v0, id=351, dtype="int32", view=m0.TensorView(shape=(816,816), layout="NC", transpose=(0,1)), )
v399 = m8.NeuronTensorOp(srcs=[v146], dsts=[v400], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=352, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.69306", line=0, column=0, hlo_id=215))
v401 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v402 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v401)
v403a = m0.AffineAccess(tensor=v89, addrs=[v401, v402])
v403 = m0.AffineLoad(src=v403a, predicates=[], id=353, parent=v402, dl=m1.DebugLocation(tensor_op_name="_clamp.814", line=0, column=0, hlo_id=216))
v404a = m0.AffineAccess(tensor=v400, addrs=[v401, v402])
v404 = m0.AffineLoad(src=v404a, predicates=[], id=354, parent=v402, dl=m1.DebugLocation(tensor_op_name="_clamp.814", line=0, column=0, hlo_id=216))
v405a = m0.AffineAccess(tensor=v398, addrs=[v401, v402])
v405 = m0.AffineLoad(src=v405a, predicates=[], id=355, parent=v402, dl=m1.DebugLocation(tensor_op_name="_clamp.814", line=0, column=0, hlo_id=216))
v406 = m0.BinaryOp(lhs=v403, rhs=v405, op=np.maximum, id=356, parent=v402, dl=m1.DebugLocation(tensor_op_name="_clamp.814", line=0, column=0, hlo_id=216))
v407 = m0.BinaryOp(lhs=v404, rhs=v406, op=np.minimum, id=357, parent=v402, dl=m1.DebugLocation(tensor_op_name="_clamp.814", line=0, column=0, hlo_id=216))
v408a = m0.AffineAccess(tensor=v87, addrs=[v401, v402])
v408 = m0.AffineStore(dst=v408a, src=v407, predicates=[], id=358, parent=v402, dl=m1.DebugLocation(tensor_op_name="_clamp.814", line=0, column=0, hlo_id=216))
v409 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v410 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v409)
v411a = m0.AffineAccess(tensor=v85, addrs=[])
v411 = m0.AffineLoad(src=v411a, predicates=[], id=359, parent=v410, dl=m1.DebugLocation(tensor_op_name="_broadcast.7001", line=0, column=0, hlo_id=222))
v412a = m0.AffineAccess(tensor=v86, addrs=[v409, v410])
v412 = m0.AffineStore(dst=v412a, src=v411, predicates=[], id=360, parent=v410, dl=m1.DebugLocation(tensor_op_name="_broadcast.7001", line=0, column=0, hlo_id=222))
v413 = m0.OffloadedMemCast(srcs=[v159], dsts=[v84], dtype="uint32", id=361, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1436", line=0, column=0, hlo_id=223))
v414 = m0.OffloadedMemCpy(srcs=[v84], dsts=[v83], dtype="uint32", id=362, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6387", line=0, column=0, hlo_id=224))
v415 = m0.OffloadedConcat(srcs=[v83, v134, ], dsts=[v82], concat_dim=0, src_shapes=[[1,], [1,], ], dtype="uint32", id=363, parent=v0, dl=m1.DebugLocation(tensor_op_name="_concatenate.463", line=0, column=0, hlo_id=226))
v417 = m0.Tensor(name="get_tuple_element.12", shape=(512,1024), parent=v0, id=364, dtype="uint8", view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v418 = m0.Tensor(name="custom_call.16", shape=(2,), parent=v0, id=365, dtype="uint32", view=m0.TensorView(shape=(2,), layout="N", transpose=(0,)), )
v416 = m8.NeuronTensorOp(srcs=[v2, v82], dsts=[v417, v418], xla_op='mhlo.dropout', dtype="uint8", predicates=[], id=366, parent=v0, dl=m1.DebugLocation(tensor_op_name="custom-call.3", line=0, column=0, hlo_id=399))
v419 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v420 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v419)
v421a = m0.AffineAccess(tensor=v80, addrs=[])
v421 = m0.AffineLoad(src=v421a, predicates=[], id=367, parent=v420, dl=m1.DebugLocation(tensor_op_name="_broadcast.63874", line=0, column=0, hlo_id=242))
v422a = m0.AffineAccess(tensor=v81, addrs=[v419, v420])
v422 = m0.AffineStore(dst=v422a, src=v421, predicates=[], id=368, parent=v420, dl=m1.DebugLocation(tensor_op_name="_broadcast.63874", line=0, column=0, hlo_id=242))
v424 = m0.Tensor(name="select.31", shape=(512,1024), parent=v0, id=369, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v423 = m0.TernaryTensorOp(srcs=[v417, v86, v81], dsts=[v424], op=np.select, id=370, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.4855", line=0, column=0, hlo_id=243))
v426 = m0.Tensor(name="subtract.13", shape=(512,1024), parent=v0, id=371, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v425 = m8.NeuronTensorOp(srcs=[v86, v424], dsts=[v426], op=np.subtract, xla_op='mhlo.binary', id=372, parent=v0, dl=m1.DebugLocation(tensor_op_name="_subtract.461", line=0, column=0, hlo_id=244))
v427 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v428 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v427)
v429a = m0.AffineAccess(tensor=v78, addrs=[])
v429 = m0.AffineLoad(src=v429a, predicates=[], id=373, parent=v428, dl=m1.DebugLocation(tensor_op_name="_convert.1442", line=0, column=0, hlo_id=245))
v430a = m0.AffineAccess(tensor=v79, addrs=[v427, v428])
v430 = m0.AffineStore(dst=v430a, src=v429, predicates=[], id=374, parent=v428, dl=m1.DebugLocation(tensor_op_name="_convert.1442", line=0, column=0, hlo_id=245))
v432 = m0.Tensor(name="compare.22", shape=(512,1024), parent=v0, id=375, dtype="uint8", view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v431 = m8.NeuronTensorOp(srcs=[v426, v79], dsts=[v432], op=np.not_equal, xla_op='mhlo.binary', id=376, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.1442", line=0, column=0, hlo_id=245))
v434 = m0.Tensor(name="select.32", shape=(512,1024), parent=v0, id=377, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v433 = m0.TernaryTensorOp(srcs=[v432, v81, v22], dsts=[v434], op=np.select, id=378, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.423", line=0, column=0, hlo_id=249))
v436 = m0.Tensor(name="broadcast_in_dim.69", shape=(512,1024), parent=v0, id=379, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v435 = m8.NeuronTensorOp(srcs=[v12], dsts=[v436], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=380, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7004", line=0, column=0, hlo_id=250))
v438 = m0.Tensor(name="multiply.1404", shape=(512,1024), parent=v0, id=381, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(512,1024), layout="NC", transpose=(0,1)), )
v437 = m8.NeuronTensorOp(srcs=[v434, v436], dsts=[v438], op=np.multiply, xla_op='mhlo.binary', id=382, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.3373", line=0, column=0, hlo_id=251))
v439 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v440 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v439)
v441 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v440)
v442a = m0.AffineAccess(tensor=v438, addrs=[v439, v441])
v442 = m0.AffineLoad(src=v442a, predicates=[], id=383, parent=v441, dl=m1.DebugLocation(tensor_op_name="_dot.583", line=0, column=0, hlo_id=254))
v443a = m0.AffineAccess(tensor=v368, addrs=[v441, v440])
v443 = m0.AffineLoad(src=v443a, predicates=[], id=384, parent=v441, dl=m1.DebugLocation(tensor_op_name="_dot.583", line=0, column=0, hlo_id=254))
v444 = m0.BinaryOp(lhs=v442, rhs=v443, op=np.multiply, id=385, parent=v441, dl=m1.DebugLocation(tensor_op_name="_dot.583", line=0, column=0, hlo_id=254))
v445 = m0.ReduceOp(data=v444, op=np.add, initial=0.0, reduce_axes=[v441], id=386, parent=v441, dl=m1.DebugLocation(tensor_op_name="_dot.583", line=0, column=0, hlo_id=254))
v446a = m0.AffineAccess(tensor=v77, addrs=[v439, v440])
v446 = m0.AffineStore(dst=v446a, src=v445, predicates=[], id=387, parent=v441, dl=m1.DebugLocation(tensor_op_name="_dot.583", line=0, column=0, hlo_id=254))
v447 = m0.OffloadedMemCpy(srcs=[v77], dsts=[v76], dtype=m7.dtype.bfloat16, id=388, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6409", line=0, column=0, hlo_id=255))
v449 = m0.Tensor(name="broadcast_in_dim.70", shape=(1,512,1024), parent=v0, id=389, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v448 = m8.NeuronTensorOp(srcs=[v17], dsts=[v449], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=390, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7017", line=0, column=0, hlo_id=257))
v451 = m0.Tensor(name="add.1423", shape=(1,512,1024), parent=v0, id=391, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v450 = m8.NeuronTensorOp(srcs=[v76, v449], dsts=[v451], op=np.add, xla_op='mhlo.binary', id=392, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4023", line=0, column=0, hlo_id=258))
v452 = m0.OffloadedMemCpy(srcs=[v451], dsts=[v75], dtype=m7.dtype.bfloat16, id=393, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6412", line=0, column=0, hlo_id=259))
v454 = m0.Tensor(name="transpose.38", shape=(1,16,512,64), parent=v0, id=394, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,512,64), layout="NHWC", transpose=(0,1,2,3)), )
v453 = m8.NeuronTensorOp(srcs=[v75], dsts=[v454], xla_op='mhlo.transpose', src_shape=(1,512,16,64), permutation=(0,2,1,3), id=395, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.953", line=0, column=0, hlo_id=260))
v455 = m0.OffloadedMemCpy(srcs=[v454], dsts=[v74], dtype=m7.dtype.bfloat16, id=396, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6413", line=0, column=0, hlo_id=261))
v456 = m0.OffloadedMemCpy(srcs=[v74], dsts=[v29], dtype=m7.dtype.bfloat16, id=397, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v458 = m0.Tensor(name="negate.3", shape=(816,816), parent=v0, id=398, dtype="int32", view=m0.TensorView(shape=(816,816), layout="NC", transpose=(0,1)), )
v457 = m8.NeuronTensorOp(srcs=[v144], dsts=[v458], op=np.negative, xla_op='mhlo.unary', id=399, parent=v0, dl=m1.DebugLocation(tensor_op_name="_negate.526", line=0, column=0, hlo_id=274))
v460 = m0.Tensor(name="add.1424", shape=(816,816), parent=v0, id=400, dtype="int32", view=m0.TensorView(shape=(816,816), layout="NC", transpose=(0,1)), )
v459 = m8.NeuronTensorOp(srcs=[v458, v396], dsts=[v460], op=np.add, xla_op='mhlo.binary', id=401, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.13486", line=0, column=0, hlo_id=276))
v461 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v462 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v461)
v463a = m0.AffineAccess(tensor=v89, addrs=[v461, v462])
v463 = m0.AffineLoad(src=v463a, predicates=[], id=402, parent=v462, dl=m1.DebugLocation(tensor_op_name="_clamp.1198", line=0, column=0, hlo_id=278))
v464a = m0.AffineAccess(tensor=v400, addrs=[v461, v462])
v464 = m0.AffineLoad(src=v464a, predicates=[], id=403, parent=v462, dl=m1.DebugLocation(tensor_op_name="_clamp.1198", line=0, column=0, hlo_id=278))
v465a = m0.AffineAccess(tensor=v460, addrs=[v461, v462])
v465 = m0.AffineLoad(src=v465a, predicates=[], id=404, parent=v462, dl=m1.DebugLocation(tensor_op_name="_clamp.1198", line=0, column=0, hlo_id=278))
v466 = m0.BinaryOp(lhs=v463, rhs=v465, op=np.maximum, id=405, parent=v462, dl=m1.DebugLocation(tensor_op_name="_clamp.1198", line=0, column=0, hlo_id=278))
v467 = m0.BinaryOp(lhs=v464, rhs=v466, op=np.minimum, id=406, parent=v462, dl=m1.DebugLocation(tensor_op_name="_clamp.1198", line=0, column=0, hlo_id=278))
v468a = m0.AffineAccess(tensor=v73, addrs=[v461, v462])
v468 = m0.AffineStore(dst=v468a, src=v467, predicates=[], id=407, parent=v462, dl=m1.DebugLocation(tensor_op_name="_clamp.1198", line=0, column=0, hlo_id=278))
v469 = m0.Axis(lb=0, ub=512, stride=1, it="i", parent=v0)
v470 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v469)
v471 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v470)
v472a = m0.AffineAccess(tensor=v438, addrs=[v469, v471])
v472 = m0.AffineLoad(src=v472a, predicates=[], id=408, parent=v471, dl=m1.DebugLocation(tensor_op_name="_dot.581", line=0, column=0, hlo_id=288))
v473a = m0.AffineAccess(tensor=v351, addrs=[v471, v470])
v473 = m0.AffineLoad(src=v473a, predicates=[], id=409, parent=v471, dl=m1.DebugLocation(tensor_op_name="_dot.581", line=0, column=0, hlo_id=288))
v474 = m0.BinaryOp(lhs=v472, rhs=v473, op=np.multiply, id=410, parent=v471, dl=m1.DebugLocation(tensor_op_name="_dot.581", line=0, column=0, hlo_id=288))
v475 = m0.ReduceOp(data=v474, op=np.add, initial=0.0, reduce_axes=[v471], id=411, parent=v471, dl=m1.DebugLocation(tensor_op_name="_dot.581", line=0, column=0, hlo_id=288))
v476a = m0.AffineAccess(tensor=v72, addrs=[v469, v470])
v476 = m0.AffineStore(dst=v476a, src=v475, predicates=[], id=412, parent=v471, dl=m1.DebugLocation(tensor_op_name="_dot.581", line=0, column=0, hlo_id=288))
v477 = m0.OffloadedMemCpy(srcs=[v72], dsts=[v71], dtype=m7.dtype.bfloat16, id=413, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6395", line=0, column=0, hlo_id=289))
v479 = m0.Tensor(name="broadcast_in_dim.71", shape=(1,512,1024), parent=v0, id=414, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v478 = m8.NeuronTensorOp(srcs=[v15], dsts=[v479], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=415, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7005", line=0, column=0, hlo_id=291))
v481 = m0.Tensor(name="add.1425", shape=(1,512,1024), parent=v0, id=416, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,512,1024), layout="NHC", transpose=(0,1,2)), )
v480 = m8.NeuronTensorOp(srcs=[v71, v479], dsts=[v481], op=np.add, xla_op='mhlo.binary', id=417, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4021", line=0, column=0, hlo_id=292))
v482 = m0.OffloadedMemCpy(srcs=[v481], dsts=[v70], dtype=m7.dtype.bfloat16, id=418, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6398", line=0, column=0, hlo_id=293))
v484 = m0.Tensor(name="transpose.39", shape=(1,16,512,64), parent=v0, id=419, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,512,64), layout="NHWC", transpose=(0,1,2,3)), )
v483 = m8.NeuronTensorOp(srcs=[v70], dsts=[v484], xla_op='mhlo.transpose', src_shape=(1,512,16,64), permutation=(0,2,1,3), id=420, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.948", line=0, column=0, hlo_id=294))
v485 = m0.OffloadedMemCpy(srcs=[v484], dsts=[v69], dtype=m7.dtype.bfloat16, id=421, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6399", line=0, column=0, hlo_id=295))
v486 = m0.OffloadedMemCpy(srcs=[v69], dsts=[v27], dtype=m7.dtype.bfloat16, id=422, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v487 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v488 = m0.Axis(lb=0, ub=1, stride=1, it="j", parent=v487)
v489 = m0.Axis(lb=0, ub=816, stride=1, it="k", parent=v488)
v490 = m0.Axis(lb=0, ub=816, stride=1, it="m", parent=v489)
v491a = m0.AffineAccess(tensor=v67, addrs=[])
v491 = m0.AffineLoad(src=v491a, predicates=[], id=423, parent=v490, dl=m1.DebugLocation(tensor_op_name="_broadcast.6976", line=0, column=0, hlo_id=86))
v492a = m0.AffineAccess(tensor=v68, addrs=[v487, v488, v489, v490])
v492 = m0.AffineStore(dst=v492a, src=v491, predicates=[], id=424, parent=v490, dl=m1.DebugLocation(tensor_op_name="_broadcast.6976", line=0, column=0, hlo_id=86))
v494 = m0.Tensor(name="compare.23", shape=(1,1,816,816), parent=v0, id=425, dtype="uint8", view=m0.TensorView(shape=(1,1,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v493 = m8.NeuronTensorOp(srcs=[v143, v68], dsts=[v494], op=np.not_equal, xla_op='mhlo.binary', id=426, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.670", line=0, column=0, hlo_id=87))
v496 = m0.Tensor(name="not.3", shape=(1,1,816,816), parent=v0, id=427, dtype="uint8", view=m0.TensorView(shape=(1,1,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v495 = m8.NeuronTensorOp(srcs=[v494], dsts=[v496], op=np.logical_not, xla_op='mhlo.unary', id=428, parent=v0, dl=m1.DebugLocation(tensor_op_name="_not.46", line=0, column=0, hlo_id=88))
v497 = m0.OffloadedMemCpy(srcs=[v496], dsts=[v66], dtype="uint8", id=429, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.95487", line=0, column=0, hlo_id=89))
v499 = m0.Tensor(name="broadcast_in_dim.72", shape=(1,16,816,816), parent=v0, id=430, dtype="uint8", view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v498 = m8.NeuronTensorOp(srcs=[v66], dsts=[v499], xla_op='mhlo.broadcast_in_dim', bcdims=[2, 3], id=431, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.63868", line=0, column=0, hlo_id=90))
v500 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v501 = m0.Axis(lb=0, ub=16, stride=1, it="j", parent=v500)
v502 = m0.Axis(lb=0, ub=816, stride=1, it="k", parent=v501)
v503 = m0.Axis(lb=0, ub=816, stride=1, it="m", parent=v502)
v504a = m0.AffineAccess(tensor=v63, addrs=[])
v504 = m0.AffineLoad(src=v504a, predicates=[], id=432, parent=v503, dl=m1.DebugLocation(tensor_op_name="_broadcast.7028", line=0, column=0, hlo_id=96))
v505a = m0.AffineAccess(tensor=v64, addrs=[v500, v501, v502, v503])
v505 = m0.AffineStore(dst=v505a, src=v504, predicates=[], id=433, parent=v503, dl=m1.DebugLocation(tensor_op_name="_broadcast.7028", line=0, column=0, hlo_id=96))
v506 = m0.OffloadedMemCpy(srcs=[v364], dsts=[v62], dtype=m7.dtype.bfloat16, id=434, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6420", line=0, column=0, hlo_id=187))
v508 = m0.Tensor(name="transpose.40", shape=(1,16,816,64), parent=v0, id=435, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,64), layout="NHWC", transpose=(0,1,2,3)), )
v507 = m8.NeuronTensorOp(srcs=[v62], dsts=[v508], xla_op='mhlo.transpose', src_shape=(1,816,16,64), permutation=(0,2,1,3), id=436, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.956", line=0, column=0, hlo_id=188))
v509 = m0.OffloadedMemCpy(srcs=[v508], dsts=[v61], dtype=m7.dtype.bfloat16, id=437, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6421", line=0, column=0, hlo_id=189))
v511 = m0.Tensor(name="transpose.41", shape=(16,64,816), parent=v0, id=438, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,816), layout="NHC", transpose=(0,1,2)), )
v510 = m8.NeuronTensorOp(srcs=[v91], dsts=[v511], xla_op='mhlo.transpose', src_shape=(16,816,64), permutation=(0,2,1), id=439, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.8702", line=0, column=0, hlo_id=206))
v512 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v513 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v512)
v514 = m0.Axis(lb=0, ub=816, stride=1, it="k", parent=v513)
v515 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v514)
v516a = m0.AffineAccess(tensor=v61, addrs=[v512, v513, v515])
v516 = m0.AffineLoad(src=v516a, predicates=[], id=440, parent=v515, dl=m1.DebugLocation(tensor_op_name="_dot.586", line=0, column=0, hlo_id=207))
v517a = m0.AffineAccess(tensor=v511, addrs=[v512, v515, v514])
v517 = m0.AffineLoad(src=v517a, predicates=[], id=441, parent=v515, dl=m1.DebugLocation(tensor_op_name="_dot.586", line=0, column=0, hlo_id=207))
v518 = m0.BinaryOp(lhs=v516, rhs=v517, op=np.multiply, id=442, parent=v515, dl=m1.DebugLocation(tensor_op_name="_dot.586", line=0, column=0, hlo_id=207))
v519 = m0.ReduceOp(data=v518, op=np.add, initial=0.0, reduce_axes=[v515], id=443, parent=v515, dl=m1.DebugLocation(tensor_op_name="_dot.586", line=0, column=0, hlo_id=207))
v520a = m0.AffineAccess(tensor=v60, addrs=[v512, v513, v514])
v520 = m0.AffineStore(dst=v520a, src=v519, predicates=[], id=444, parent=v515, dl=m1.DebugLocation(tensor_op_name="_dot.586", line=0, column=0, hlo_id=207))
v521 = m0.OffloadedMemCast(srcs=[v87], dsts=[v59], dtype="uint32", id=445, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.12620", line=0, column=0, hlo_id=217))
v523 = m0.Tensor(name="broadcast_in_dim.73", shape=(16,816,512,816), parent=v0, id=446, dtype="uint32", view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v522 = m8.NeuronTensorOp(srcs=[v59], dsts=[v523], xla_op='mhlo.broadcast_in_dim', bcdims=[1, 3], id=447, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7021", line=0, column=0, hlo_id=218))
v525 = m0.Tensor(name="iota.7", shape=(16,816,512,816), parent=v0, id=448, dtype="uint32", view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v524 = m0.IotaTensorOp(srcs=[], dsts=[v525], op=m0.iota, shape=(16,816,512,816), iota_dim=2, dtype="uint32", id=449, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.129", line=0, column=0, hlo_id=219))
v527 = m0.Tensor(name="compare.24", shape=(16,816,512,816), parent=v0, id=450, dtype="uint8", view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v526 = m8.NeuronTensorOp(srcs=[v523, v525], dsts=[v527], op=np.equal, xla_op='mhlo.binary', id=451, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.674", line=0, column=0, hlo_id=220))
v529 = m0.Tensor(name="transpose.42", shape=(16,64,512), parent=v0, id=452, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,512), layout="NHC", transpose=(0,1,2)), )
v528 = m8.NeuronTensorOp(srcs=[v74], dsts=[v529], xla_op='mhlo.transpose', src_shape=(16,512,64), permutation=(0,2,1), id=453, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.954", line=0, column=0, hlo_id=262))
v530 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v531 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v530)
v532 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v531)
v533 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v532)
v534a = m0.AffineAccess(tensor=v61, addrs=[v530, v531, v533])
v534 = m0.AffineLoad(src=v534a, predicates=[], id=454, parent=v533, dl=m1.DebugLocation(tensor_op_name="_dot.585", line=0, column=0, hlo_id=263))
v535a = m0.AffineAccess(tensor=v529, addrs=[v530, v533, v532])
v535 = m0.AffineLoad(src=v535a, predicates=[], id=455, parent=v533, dl=m1.DebugLocation(tensor_op_name="_dot.585", line=0, column=0, hlo_id=263))
v536 = m0.BinaryOp(lhs=v534, rhs=v535, op=np.multiply, id=456, parent=v533, dl=m1.DebugLocation(tensor_op_name="_dot.585", line=0, column=0, hlo_id=263))
v537 = m0.ReduceOp(data=v536, op=np.add, initial=0.0, reduce_axes=[v533], id=457, parent=v533, dl=m1.DebugLocation(tensor_op_name="_dot.585", line=0, column=0, hlo_id=263))
v538a = m0.AffineAccess(tensor=v58, addrs=[v530, v531, v532])
v538 = m0.AffineStore(dst=v538a, src=v537, predicates=[], id=458, parent=v533, dl=m1.DebugLocation(tensor_op_name="_dot.585", line=0, column=0, hlo_id=263))
v540 = m0.Tensor(name="broadcast_in_dim.74", shape=(16,816,512,816), parent=v0, id=459, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v539 = m8.NeuronTensorOp(srcs=[v58], dsts=[v540], xla_op='mhlo.broadcast_in_dim', bcdims=[0, 1, 2], id=460, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7023", line=0, column=0, hlo_id=264))
v541 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v542 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v541)
v543 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v542)
v544 = m0.Axis(lb=0, ub=816, stride=1, it="m", parent=v543)
v545a = m0.AffineAccess(tensor=v56, addrs=[])
v545 = m0.AffineLoad(src=v545a, predicates=[], id=461, parent=v544, dl=m1.DebugLocation(tensor_op_name="_broadcast.7022", line=0, column=0, hlo_id=266))
v546a = m0.AffineAccess(tensor=v57, addrs=[v541, v542, v543, v544])
v546 = m0.AffineStore(dst=v546a, src=v545, predicates=[], id=462, parent=v544, dl=m1.DebugLocation(tensor_op_name="_broadcast.7022", line=0, column=0, hlo_id=266))
v548 = m0.Tensor(name="select.33", shape=(16,816,512,816), parent=v0, id=463, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v547 = m0.TernaryTensorOp(srcs=[v527, v540, v57], dsts=[v548], op=np.select, id=464, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.425", line=0, column=0, hlo_id=267))
v550 = m0.Tensor(name="reduce.5", shape=(16,816,816), parent=v0, id=465, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v549 = m0.ReduceTensorOp(srcs=[v548], dsts=[v550], op=np.add, init_value=0.0, reduce_dims=[2,], id=466, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reduce.292", line=0, column=0, hlo_id=269))
v552 = m0.Tensor(name="broadcast_in_dim.75", shape=(16,816,816), parent=v0, id=467, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v551 = m8.NeuronTensorOp(srcs=[v18], dsts=[v552], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=468, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7024", line=0, column=0, hlo_id=270))
v554 = m0.Tensor(name="divide.10", shape=(16,816,816), parent=v0, id=469, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v553 = m8.NeuronTensorOp(srcs=[v550, v552], dsts=[v554], op=np.divide, xla_op='mhlo.binary', id=470, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.235", line=0, column=0, hlo_id=271))
v555 = m0.OffloadedMemCast(srcs=[v73], dsts=[v55], dtype="uint32", id=471, parent=v0, dl=m1.DebugLocation(tensor_op_name="_convert.12621", line=0, column=0, hlo_id=279))
v557 = m0.Tensor(name="broadcast_in_dim.76", shape=(16,816,512,816), parent=v0, id=472, dtype="uint32", view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v556 = m8.NeuronTensorOp(srcs=[v55], dsts=[v557], xla_op='mhlo.broadcast_in_dim', bcdims=[1, 3], id=473, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7006", line=0, column=0, hlo_id=280))
v559 = m0.Tensor(name="iota.8", shape=(16,816,512,816), parent=v0, id=474, dtype="uint32", view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v558 = m0.IotaTensorOp(srcs=[], dsts=[v559], op=m0.iota, shape=(16,816,512,816), iota_dim=2, dtype="uint32", id=475, parent=v0, dl=m1.DebugLocation(tensor_op_name="_iota.128", line=0, column=0, hlo_id=281))
v561 = m0.Tensor(name="compare.25", shape=(16,816,512,816), parent=v0, id=476, dtype="uint8", view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v560 = m8.NeuronTensorOp(srcs=[v557, v559], dsts=[v561], op=np.equal, xla_op='mhlo.binary', id=477, parent=v0, dl=m1.DebugLocation(tensor_op_name="_compare.673", line=0, column=0, hlo_id=282))
v562 = m0.OffloadedMemCpy(srcs=[v381], dsts=[v54], dtype=m7.dtype.bfloat16, id=478, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6401", line=0, column=0, hlo_id=283))
v564 = m0.Tensor(name="transpose.43", shape=(1,16,816,64), parent=v0, id=479, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,64), layout="NHWC", transpose=(0,1,2,3)), )
v563 = m8.NeuronTensorOp(srcs=[v54], dsts=[v564], xla_op='mhlo.transpose', src_shape=(1,816,16,64), permutation=(0,2,1,3), id=480, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.950", line=0, column=0, hlo_id=284))
v565 = m0.OffloadedMemCpy(srcs=[v564], dsts=[v53], dtype=m7.dtype.bfloat16, id=481, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6402", line=0, column=0, hlo_id=285))
v567 = m0.Tensor(name="transpose.44", shape=(16,64,512), parent=v0, id=482, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,64,512), layout="NHC", transpose=(0,1,2)), )
v566 = m8.NeuronTensorOp(srcs=[v69], dsts=[v567], xla_op='mhlo.transpose', src_shape=(16,512,64), permutation=(0,2,1), id=483, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.949", line=0, column=0, hlo_id=296))
v568 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v569 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v568)
v570 = m0.Axis(lb=0, ub=512, stride=1, it="k", parent=v569)
v571 = m0.Axis(lb=0, ub=64, stride=1, it="m", parent=v570)
v572a = m0.AffineAccess(tensor=v53, addrs=[v568, v569, v571])
v572 = m0.AffineLoad(src=v572a, predicates=[], id=484, parent=v571, dl=m1.DebugLocation(tensor_op_name="_dot.582", line=0, column=0, hlo_id=297))
v573a = m0.AffineAccess(tensor=v567, addrs=[v568, v571, v570])
v573 = m0.AffineLoad(src=v573a, predicates=[], id=485, parent=v571, dl=m1.DebugLocation(tensor_op_name="_dot.582", line=0, column=0, hlo_id=297))
v574 = m0.BinaryOp(lhs=v572, rhs=v573, op=np.multiply, id=486, parent=v571, dl=m1.DebugLocation(tensor_op_name="_dot.582", line=0, column=0, hlo_id=297))
v575 = m0.ReduceOp(data=v574, op=np.add, initial=0.0, reduce_axes=[v571], id=487, parent=v571, dl=m1.DebugLocation(tensor_op_name="_dot.582", line=0, column=0, hlo_id=297))
v576a = m0.AffineAccess(tensor=v52, addrs=[v568, v569, v570])
v576 = m0.AffineStore(dst=v576a, src=v575, predicates=[], id=488, parent=v571, dl=m1.DebugLocation(tensor_op_name="_dot.582", line=0, column=0, hlo_id=297))
v578 = m0.Tensor(name="broadcast_in_dim.77", shape=(16,816,512,816), parent=v0, id=489, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v577 = m8.NeuronTensorOp(srcs=[v52], dsts=[v578], xla_op='mhlo.broadcast_in_dim', bcdims=[0, 1, 2], id=490, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7008", line=0, column=0, hlo_id=298))
v580 = m0.Tensor(name="select.34", shape=(16,816,512,816), parent=v0, id=491, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,512,816), layout="NHWC", transpose=(0,1,2,3)), )
v579 = m0.TernaryTensorOp(srcs=[v561, v578, v57], dsts=[v580], op=np.select, id=492, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.424", line=0, column=0, hlo_id=301))
v582 = m0.Tensor(name="reduce.6", shape=(16,816,816), parent=v0, id=493, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v581 = m0.ReduceTensorOp(srcs=[v580], dsts=[v582], op=np.add, init_value=0.0, reduce_dims=[2,], id=494, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reduce.291", line=0, column=0, hlo_id=303))
v584 = m0.Tensor(name="divide.11", shape=(16,816,816), parent=v0, id=495, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v583 = m8.NeuronTensorOp(srcs=[v582, v552], dsts=[v584], op=np.divide, xla_op='mhlo.binary', id=496, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.1917", line=0, column=0, hlo_id=305))
v586 = m0.Tensor(name="transpose.45", shape=(16,816,816), parent=v0, id=497, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v585 = m8.NeuronTensorOp(srcs=[v584], dsts=[v586], xla_op='mhlo.transpose', src_shape=(16,816,816), permutation=(0,2,1), id=498, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.8703", line=0, column=0, hlo_id=306))
v588 = m0.Tensor(name="add.1426", shape=(16,816,816), parent=v0, id=499, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v587 = m8.NeuronTensorOp(srcs=[v554, v586], dsts=[v588], op=np.add, xla_op='mhlo.binary', id=500, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4026", line=0, column=0, hlo_id=307))
v590 = m0.Tensor(name="add.1427", shape=(16,816,816), parent=v0, id=501, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(16,816,816), layout="NHC", transpose=(0,1,2)), )
v589 = m8.NeuronTensorOp(srcs=[v60, v588], dsts=[v590], op=np.add, xla_op='mhlo.binary', id=502, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4027", line=0, column=0, hlo_id=308))
v591 = m0.OffloadedMemCpy(srcs=[v590], dsts=[v51], dtype=m7.dtype.bfloat16, id=503, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.86876", line=0, column=0, hlo_id=309))
v593 = m0.Tensor(name="select.35", shape=(1,16,816,816), parent=v0, id=504, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v592 = m0.TernaryTensorOp(srcs=[v499, v64, v51], dsts=[v593], op=np.select, id=505, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.426", line=0, column=0, hlo_id=310))
v595 = m0.Tensor(name="custom_call.17", shape=(1,16,816,816), parent=v0, id=506, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v594 = m8.NeuronTensorOp(srcs=[v593], dsts=[v595], xla_op="mhlo.custom_call", target_name="AwsNeuronSoftmax", backend_config=3, id=507, parent=v0, dl=m1.DebugLocation(tensor_op_name="_divide.236", line=0, column=0, hlo_id=321))
v597 = m0.Tensor(name="select.36", shape=(1,16,816,816), parent=v0, id=508, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v596 = m0.TernaryTensorOp(srcs=[v499, v121, v595], dsts=[v597], op=np.select, id=509, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.427", line=0, column=0, hlo_id=322))
v598 = m0.Tensor(name="intermediate1434", shape=(1,16,816,816), parent=v0, id=510, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), attrs={'IntermediateTensor':  "" })
v599 = m0.OffloadedMemCpy(srcs=[v597], dsts=[v598], dtype=m7.dtype.bfloat16, id=511, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v601 = m0.Tensor(name="select.37", shape=(1,16,816,816), parent=v0, id=512, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v600 = m0.TernaryTensorOp(srcs=[v229, v121, v597], dsts=[v601], op=np.select, id=513, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.428", line=0, column=0, hlo_id=323))
v603 = m0.Tensor(name="broadcast_in_dim.78", shape=(1,16,816,816), parent=v0, id=514, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v602 = m8.NeuronTensorOp(srcs=[v12], dsts=[v603], xla_op='mhlo.broadcast_in_dim', bcdims=[], id=515, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7070", line=0, column=0, hlo_id=324))
v605 = m0.Tensor(name="multiply.1405", shape=(1,16,816,816), parent=v0, id=516, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), )
v604 = m8.NeuronTensorOp(srcs=[v601, v603], dsts=[v605], op=np.multiply, xla_op='mhlo.binary', id=517, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.3389", line=0, column=0, hlo_id=325))
v606 = m0.Tensor(name="intermediate1435", shape=(1,16,816,816), parent=v0, id=518, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,816), layout="NHWC", transpose=(0,1,2,3)), attrs={'IntermediateTensor':  "" })
v607 = m0.OffloadedMemCpy(srcs=[v605], dsts=[v606], dtype=m7.dtype.bfloat16, id=519, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v609 = m0.Tensor(name="transpose.46", shape=(1024,1024), parent=v0, id=520, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v608 = m8.NeuronTensorOp(srcs=[v23], dsts=[v609], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=521, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.957", line=0, column=0, hlo_id=330))
v610 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v611 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v610)
v612 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v611)
v613a = m0.AffineAccess(tensor=v97, addrs=[v610, v612])
v613 = m0.AffineLoad(src=v613a, predicates=[], id=522, parent=v612, dl=m1.DebugLocation(tensor_op_name="_dot.587", line=0, column=0, hlo_id=331))
v614a = m0.AffineAccess(tensor=v609, addrs=[v612, v611])
v614 = m0.AffineLoad(src=v614a, predicates=[], id=523, parent=v612, dl=m1.DebugLocation(tensor_op_name="_dot.587", line=0, column=0, hlo_id=331))
v615 = m0.BinaryOp(lhs=v613, rhs=v614, op=np.multiply, id=524, parent=v612, dl=m1.DebugLocation(tensor_op_name="_dot.587", line=0, column=0, hlo_id=331))
v616 = m0.ReduceOp(data=v615, op=np.add, initial=0.0, reduce_axes=[v612], id=525, parent=v612, dl=m1.DebugLocation(tensor_op_name="_dot.587", line=0, column=0, hlo_id=331))
v617a = m0.AffineAccess(tensor=v50, addrs=[v610, v611])
v617 = m0.AffineStore(dst=v617a, src=v616, predicates=[], id=526, parent=v612, dl=m1.DebugLocation(tensor_op_name="_dot.587", line=0, column=0, hlo_id=331))
v618 = m0.OffloadedMemCpy(srcs=[v50], dsts=[v49], dtype=m7.dtype.bfloat16, id=527, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6434", line=0, column=0, hlo_id=332))
v620 = m0.Tensor(name="broadcast_in_dim.79", shape=(1,816,1024), parent=v0, id=528, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v619 = m8.NeuronTensorOp(srcs=[v24], dsts=[v620], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=529, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7045", line=0, column=0, hlo_id=335))
v622 = m0.Tensor(name="add.1428", shape=(1,816,1024), parent=v0, id=530, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v621 = m8.NeuronTensorOp(srcs=[v49, v620], dsts=[v622], op=np.add, xla_op='mhlo.binary', id=531, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4029", line=0, column=0, hlo_id=336))
v623 = m0.Tensor(name="intermediate1436", shape=(1,816,1024), parent=v0, id=532, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v624 = m0.OffloadedMemCpy(srcs=[v622], dsts=[v623], dtype=m7.dtype.bfloat16, id=533, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v625 = m0.OffloadedMemCpy(srcs=[v605], dsts=[v48], dtype=m7.dtype.bfloat16, id=534, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6462", line=0, column=0, hlo_id=326))
v626 = m0.OffloadedMemCpy(srcs=[v622], dsts=[v47], dtype=m7.dtype.bfloat16, id=535, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6460", line=0, column=0, hlo_id=337))
v628 = m0.Tensor(name="transpose.47", shape=(1,16,816,64), parent=v0, id=536, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,16,816,64), layout="NHWC", transpose=(0,1,2,3)), )
v627 = m8.NeuronTensorOp(srcs=[v47], dsts=[v628], xla_op='mhlo.transpose', src_shape=(1,816,16,64), permutation=(0,2,1,3), id=537, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.963", line=0, column=0, hlo_id=338))
v629 = m0.OffloadedMemCpy(srcs=[v628], dsts=[v46], dtype=m7.dtype.bfloat16, id=538, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6461", line=0, column=0, hlo_id=339))
v630 = m0.Axis(lb=0, ub=16, stride=1, it="i", parent=v0)
v631 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v630)
v632 = m0.Axis(lb=0, ub=64, stride=1, it="k", parent=v631)
v633 = m0.Axis(lb=0, ub=816, stride=1, it="m", parent=v632)
v634a = m0.AffineAccess(tensor=v48, addrs=[v630, v631, v633])
v634 = m0.AffineLoad(src=v634a, predicates=[], id=539, parent=v633, dl=m1.DebugLocation(tensor_op_name="_dot.588", line=0, column=0, hlo_id=340))
v635a = m0.AffineAccess(tensor=v46, addrs=[v630, v633, v632])
v635 = m0.AffineLoad(src=v635a, predicates=[], id=540, parent=v633, dl=m1.DebugLocation(tensor_op_name="_dot.588", line=0, column=0, hlo_id=340))
v636 = m0.BinaryOp(lhs=v634, rhs=v635, op=np.multiply, id=541, parent=v633, dl=m1.DebugLocation(tensor_op_name="_dot.588", line=0, column=0, hlo_id=340))
v637 = m0.ReduceOp(data=v636, op=np.add, initial=0.0, reduce_axes=[v633], id=542, parent=v633, dl=m1.DebugLocation(tensor_op_name="_dot.588", line=0, column=0, hlo_id=340))
v638a = m0.AffineAccess(tensor=v45, addrs=[v630, v631, v632])
v638 = m0.AffineStore(dst=v638a, src=v637, predicates=[], id=543, parent=v633, dl=m1.DebugLocation(tensor_op_name="_dot.588", line=0, column=0, hlo_id=340))
v639 = m0.OffloadedMemCpy(srcs=[v45], dsts=[v44], dtype=m7.dtype.bfloat16, id=544, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6463", line=0, column=0, hlo_id=341))
v641 = m0.Tensor(name="transpose.48", shape=(1,816,16,64), parent=v0, id=545, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,16,64), layout="NHWC", transpose=(0,1,2,3)), )
v640 = m8.NeuronTensorOp(srcs=[v44], dsts=[v641], xla_op='mhlo.transpose', src_shape=(1,16,816,64), permutation=(0,2,1,3), id=546, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.964", line=0, column=0, hlo_id=342))
v642 = m0.OffloadedMemCpy(srcs=[v641], dsts=[v43], dtype=m7.dtype.bfloat16, id=547, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6465", line=0, column=0, hlo_id=343))
v644 = m0.Tensor(name="transpose.49", shape=(1024,1024), parent=v0, id=548, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1024,1024), layout="NC", transpose=(0,1)), )
v643 = m8.NeuronTensorOp(srcs=[v25], dsts=[v644], xla_op='mhlo.transpose', src_shape=(1024,1024), permutation=(1,0), id=549, parent=v0, dl=m1.DebugLocation(tensor_op_name="_transpose.962", line=0, column=0, hlo_id=346))
v645 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v646 = m0.Axis(lb=0, ub=1024, stride=1, it="j", parent=v645)
v647 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v646)
v648a = m0.AffineAccess(tensor=v43, addrs=[v645, v647])
v648 = m0.AffineLoad(src=v648a, predicates=[], id=550, parent=v647, dl=m1.DebugLocation(tensor_op_name="_dot.589", line=0, column=0, hlo_id=347))
v649a = m0.AffineAccess(tensor=v644, addrs=[v647, v646])
v649 = m0.AffineLoad(src=v649a, predicates=[], id=551, parent=v647, dl=m1.DebugLocation(tensor_op_name="_dot.589", line=0, column=0, hlo_id=347))
v650 = m0.BinaryOp(lhs=v648, rhs=v649, op=np.multiply, id=552, parent=v647, dl=m1.DebugLocation(tensor_op_name="_dot.589", line=0, column=0, hlo_id=347))
v651 = m0.ReduceOp(data=v650, op=np.add, initial=0.0, reduce_axes=[v647], id=553, parent=v647, dl=m1.DebugLocation(tensor_op_name="_dot.589", line=0, column=0, hlo_id=347))
v652a = m0.AffineAccess(tensor=v42, addrs=[v645, v646])
v652 = m0.AffineStore(dst=v652a, src=v651, predicates=[], id=554, parent=v647, dl=m1.DebugLocation(tensor_op_name="_dot.589", line=0, column=0, hlo_id=347))
v653 = m0.OffloadedMemCpy(srcs=[v42], dsts=[v41], dtype=m7.dtype.bfloat16, id=555, parent=v0, dl=m1.DebugLocation(tensor_op_name="_reshape.6466", line=0, column=0, hlo_id=348))
v655 = m0.Tensor(name="broadcast_in_dim.80", shape=(1,816,1024), parent=v0, id=556, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v654 = m8.NeuronTensorOp(srcs=[v26], dsts=[v655], xla_op='mhlo.broadcast_in_dim', bcdims=[2], id=557, parent=v0, dl=m1.DebugLocation(tensor_op_name="_broadcast.7071", line=0, column=0, hlo_id=351))
v657 = m0.Tensor(name="add.1429", shape=(1,816,1024), parent=v0, id=558, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v656 = m8.NeuronTensorOp(srcs=[v41, v655], dsts=[v657], op=np.add, xla_op='mhlo.binary', id=559, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4031", line=0, column=0, hlo_id=352))
v659 = m0.Tensor(name="select.38", shape=(1,816,1024), parent=v0, id=560, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v658 = m0.TernaryTensorOp(srcs=[v197, v130, v657], dsts=[v659], op=np.select, id=561, parent=v0, dl=m1.DebugLocation(tensor_op_name="_select.429", line=0, column=0, hlo_id=353))
v661 = m0.Tensor(name="multiply.1406", shape=(1,816,1024), parent=v0, id=562, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v660 = m8.NeuronTensorOp(srcs=[v659, v298], dsts=[v661], op=np.multiply, xla_op='mhlo.binary', id=563, parent=v0, dl=m1.DebugLocation(tensor_op_name="_multiply.3390", line=0, column=0, hlo_id=355))
v663 = m0.Tensor(name="add.1430", shape=(1,816,1024), parent=v0, id=564, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), )
v662 = m8.NeuronTensorOp(srcs=[v661, v348], dsts=[v663], op=np.add, xla_op='mhlo.binary', id=565, parent=v0, dl=m1.DebugLocation(tensor_op_name="_add.4032", line=0, column=0, hlo_id=356))
v664 = m0.Tensor(name="intermediate1437", shape=(1,816,1024), parent=v0, id=566, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v665 = m0.OffloadedMemCpy(srcs=[v663], dsts=[v664], dtype=m7.dtype.bfloat16, id=567, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v666 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v667 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v666)
v668 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v667)
v669a = m0.AffineAccess(tensor=v663, addrs=[v666, v667, v668])
v669 = m0.AffineLoad(src=v669a, predicates=[], id=568, parent=v668, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v670_v671 = m0.BatchNormMeanVarOp(data=v669, reduce_axes=[v666, v668], id=569, parent=v668, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v670 = m0.ExtractValue(src=v670_v671, idxes=[0], id=570, parent=v668, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v671 = m0.ExtractValue(src=v670_v671, idxes=[1], id=571, parent=v668, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v672a = m0.AffineAccess(tensor=v39, addrs=[v667, 0])
v672 = m0.AffineStore(dst=v672a, src=v670, predicates=[], id=572, parent=v668, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v673a = m0.AffineAccess(tensor=v39, addrs=[v667, 1])
v673 = m0.AffineStore(dst=v673a, src=v671, predicates=[], id=573, parent=v668, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v674 = m0.Axis(lb=0, ub=1, stride=1, it="i", parent=v0)
v675 = m0.Axis(lb=0, ub=816, stride=1, it="j", parent=v674)
v676 = m0.Axis(lb=0, ub=1024, stride=1, it="k", parent=v675)
v677a = m0.AffineAccess(tensor=v663, addrs=[v674, v675, v676])
v677 = m0.AffineLoad(src=v677a, predicates=[], id=574, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v678a = m0.AffineAccess(tensor=v106, addrs=[v675])
v678 = m0.AffineLoad(src=v678a, predicates=[], id=575, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v679a = m0.AffineAccess(tensor=v104, addrs=[v675])
v679 = m0.AffineLoad(src=v679a, predicates=[], id=576, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v680a = m0.AffineAccess(tensor=v36, addrs=[])
v680 = m0.AffineLoad(src=v680a, predicates=[], id=577, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v681a = m0.AffineAccess(tensor=v39, addrs=[v675, 0])
v681 = m0.AffineLoad(src=v681a, predicates=[], id=578, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v682a = m0.AffineAccess(tensor=v39, addrs=[v675, 1])
v682 = m0.AffineLoad(src=v682a, predicates=[], id=579, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v683 = m0.BinaryOp(lhs=v682, rhs=v680, op=np.add, id=580, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v684 = m0.UnaryOp(data=v683, op=m0.rsqrt, id=581, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v685 = m0.BinaryOp(lhs=v677, rhs=v681, op=np.subtract, id=582, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v686 = m0.BinaryOp(lhs=v678, rhs=v685, op=np.multiply, id=583, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v687 = m0.BinaryOp(lhs=v686, rhs=v684, op=np.multiply, id=584, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v688 = m0.BinaryOp(lhs=v687, rhs=v679, op=np.add, id=585, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v689a = m0.AffineAccess(tensor=v40, addrs=[v674, v675, v676])
v689 = m0.AffineStore(dst=v689a, src=v688, predicates=[], id=586, parent=v676, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v690 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v691a = m0.AffineAccess(tensor=v39, addrs=[v690, 0])
v691 = m0.AffineLoad(src=v691a, predicates=[], id=587, parent=v690, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v692a = m0.AffineAccess(tensor=v38, addrs=[v690])
v692 = m0.AffineStore(dst=v692a, src=v691, predicates=[], id=588, parent=v690, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v693 = m0.Axis(lb=0, ub=816, stride=1, it="i", parent=v0)
v694a = m0.AffineAccess(tensor=v39, addrs=[v693, 1])
v694 = m0.AffineLoad(src=v694a, predicates=[], id=589, parent=v693, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v695a = m0.AffineAccess(tensor=v37, addrs=[v693])
v695 = m0.AffineStore(dst=v695a, src=v694, predicates=[], id=590, parent=v693, dl=m1.DebugLocation(tensor_op_name="_batch-norm-training.96", line=0, column=0, hlo_id=364))
v696 = m0.OffloadedMemCast(srcs=[v167], dsts=[v35], dtype="int64", id=591, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple.2", line=0, column=0, hlo_id=389))
v697 = m0.OffloadedMemCpy(srcs=[v35], dsts=[v32], dtype="int64", id=592, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v698 = m0.OffloadedMemCast(srcs=[v87], dsts=[v34], dtype="int64", id=593, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple.2", line=0, column=0, hlo_id=389))
v699 = m0.OffloadedMemCpy(srcs=[v34], dsts=[v30], dtype="int64", id=594, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v700 = m0.OffloadedMemCast(srcs=[v73], dsts=[v33], dtype="int64", id=595, parent=v0, dl=m1.DebugLocation(tensor_op_name="_tuple.2", line=0, column=0, hlo_id=389))
v701 = m0.OffloadedMemCpy(srcs=[v33], dsts=[v28], dtype="int64", id=596, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v702 = m0.Tensor(name="intermediate1423", shape=(1,816,1024), parent=v0, id=597, dtype=m7.dtype.bfloat16, view=m0.TensorView(shape=(1,816,1024), layout="NHC", transpose=(0,1,2)), attrs={'IntermediateTensor':  "" })
v703 = m0.OffloadedMemCpy(srcs=[v6], dsts=[v702], dtype=m7.dtype.bfloat16, id=598, parent=v0, dl=m1.DebugLocation(tensor_op_name="UnnamedModule", line=0, column=0, hlo_id=23))
v0.markOutput(v32)
v0.markOutput(v198)
v0.markOutput(v230)
v0.markOutput(v249)
v0.markOutput(v702)
v0.markOutput(v275)
v0.markOutput(v303)
v0.markOutput(v100)
v0.markOutput(v99)
v0.markOutput(v365)
v0.markOutput(v31)
v0.markOutput(v30)
v0.markOutput(v29)
v0.markOutput(v28)
v0.markOutput(v27)
v0.markOutput(v598)
v0.markOutput(v606)
v0.markOutput(v623)
v0.markOutput(v664)
v0.markOutput(v40)
v0.markOutput(v38)
v0.markOutput(v37)
v0.id=599
ir=v0
